<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Modelling Individual Growth and Using Stochastic Slicing to Convert Length-based Data Into Age-based Data | Fish stock assessment with R</title>
  <meta name="description" content="How to do stock assessment in R using the a4a framework" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Modelling Individual Growth and Using Stochastic Slicing to Convert Length-based Data Into Age-based Data | Fish stock assessment with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="How to do stock assessment in R using the a4a framework" />
  <meta name="github-repo" content="ejardim/a4abook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Modelling Individual Growth and Using Stochastic Slicing to Convert Length-based Data Into Age-based Data | Fish stock assessment with R" />
  
  <meta name="twitter:description" content="How to do stock assessment in R using the a4a framework" />
  

<meta name="author" content="Ernesto Jardim, Colin Millar, Danai Mantopoulou Palouka and Iago Mosqueira" />


<meta name="date" content="2025-05-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="modelling-natural-mortality.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stock assessment framework</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Before starting</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installing-and-loading-libraries"><i class="fa fa-check"></i><b>1.1</b> Installing and loading libraries</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-read-this-document"><i class="fa fa-check"></i><b>1.2</b> How to read this document</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#how-to-get-help"><i class="fa fa-check"></i><b>1.3</b> How to get help</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#notation"><i class="fa fa-check"></i><b>1.4</b> Notation</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.5</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.6</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#the-assessment-for-all-initiative-a4a"><i class="fa fa-check"></i><b>2.1</b> The “Assessment for All” Initiative (a4a)</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#multi-stage-modelling-approach"><i class="fa fa-check"></i><b>2.2</b> Multi-stage modelling approach</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#stock-assessment-process"><i class="fa fa-check"></i><b>2.3</b> Stock Assessment Process</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#stock-assessment-as-a-linear-model"><i class="fa fa-check"></i><b>2.4</b> Stock assessment as a linear model</a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#data-used-in-the-book"><i class="fa fa-check"></i><b>2.5</b> Data used in the book</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction.html"><a href="introduction.html#plaice-in-area-fao-27-ices-area-iv"><i class="fa fa-check"></i><b>2.5.1</b> Plaice in area FAO 27, ICES area IV</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction.html"><a href="introduction.html#european-hake-in-fao-37-gsas-1567"><i class="fa fa-check"></i><b>2.5.2</b> European hake in FAO 37, GSAs 1,5,6,7</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction.html"><a href="introduction.html#red-mullet-in-fao-27-gsa-1"><i class="fa fa-check"></i><b>2.5.3</b> Red mullet in FAO 27, GSA 1</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction.html"><a href="introduction.html#redfish-simulated-length-data"><i class="fa fa-check"></i><b>2.5.4</b> Redfish simulated length data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="growth.html"><a href="growth.html"><i class="fa fa-check"></i><b>3</b> Modelling Individual Growth and Using Stochastic Slicing to Convert Length-based Data Into Age-based Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="growth.html"><a href="growth.html#a4agr---the-growth-class"><i class="fa fa-check"></i><b>3.1</b> a4aGr - The growth class</a></li>
<li class="chapter" data-level="3.2" data-path="growth.html"><a href="growth.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>3.2</b> Adding uncertainty to growth parameters with a multivariate normal distribution</a></li>
<li class="chapter" data-level="3.3" data-path="growth.html"><a href="growth.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-triangle-distribution"><i class="fa fa-check"></i><b>3.3</b> Adding uncertainty to growth parameters with a multivariate triangle distribution</a></li>
<li class="chapter" data-level="3.4" data-path="growth.html"><a href="growth.html#adding-uncertainty-to-growth-parameters-with-statistical-copulas"><i class="fa fa-check"></i><b>3.4</b> Adding uncertainty to growth parameters with statistical copulas</a></li>
<li class="chapter" data-level="3.5" data-path="growth.html"><a href="growth.html#converting-from-length-to-age-based-data---the-l2a-method"><i class="fa fa-check"></i><b>3.5</b> Converting from length to age based data - the <code>l2a()</code> method</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html"><i class="fa fa-check"></i><b>4</b> Modelling Natural Mortality</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#a4am---the-m-class"><i class="fa fa-check"></i><b>4.1</b> <code>a4aM</code> - The M class</a></li>
<li class="chapter" data-level="4.2" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#adding-uncertainty-to-natural-mortality-parameters-with-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>4.2</b> Adding uncertainty to natural mortality parameters with a multivariate normal distribution</a></li>
<li class="chapter" data-level="4.3" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#adding-uncertainty-to-natural-mortality-parameters-with-statistical-copulas"><i class="fa fa-check"></i><b>4.3</b> Adding uncertainty to natural mortality parameters with statistical copulas</a></li>
<li class="chapter" data-level="4.4" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#computing-natural-mortality-time-series---the-m-method"><i class="fa fa-check"></i><b>4.4</b> Computing natural mortality time series - the “m” method</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html"><i class="fa fa-check"></i><b>5</b> Stock assessment framework</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#maths-description"><i class="fa fa-check"></i><b>5.1</b> Maths description </a></li>
<li class="chapter" data-level="5.2" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#model-structure"><i class="fa fa-check"></i><b>5.2</b> Model structure </a></li>
<li class="chapter" data-level="5.3" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#submodel-building-blocks-and-fundamental-r-formulas"><i class="fa fa-check"></i><b>5.3</b> Submodel building blocks and fundamental <code>R</code> formulas</a></li>
<li class="chapter" data-level="5.4" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#the-major-effects-available-for-modelling"><i class="fa fa-check"></i><b>5.4</b> The major effects available for modelling</a></li>
<li class="chapter" data-level="5.5" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#classes-description"><i class="fa fa-check"></i><b>5.5</b> Classes Description </a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html"><i class="fa fa-check"></i><b>6</b> Introduction to Splines</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#generalize-to-polynomials"><i class="fa fa-check"></i><b>6.1</b> Generalize to polynomials</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#thin-plate-spline"><i class="fa fa-check"></i><b>6.2</b> Thin plate spline</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#the-mgcv-package-inside-a4a"><i class="fa fa-check"></i><b>6.3</b> The <code>mgcv</code> package inside <code>a4a</code></a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#on-the-number-of-knots-k"><i class="fa fa-check"></i><b>6.4</b> On the number of knots <span class="math inline">\(k\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fitting.html"><a href="fitting.html"><i class="fa fa-check"></i><b>7</b> Fitting</a>
<ul>
<li class="chapter" data-level="7.1" data-path="fitting.html"><a href="fitting.html#fishing-mortality-submodel-f_ay"><i class="fa fa-check"></i><b>7.1</b> Fishing mortality submodel (<span class="math inline">\(F_{ay}\)</span>)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="fitting.html"><a href="fitting.html#separable-model"><i class="fa fa-check"></i><b>7.1.1</b> Separable model</a></li>
<li class="chapter" data-level="7.1.2" data-path="fitting.html"><a href="fitting.html#model-with-age-year-interaction"><i class="fa fa-check"></i><b>7.1.2</b> Model with age-year interaction</a></li>
<li class="chapter" data-level="7.1.3" data-path="fitting.html"><a href="fitting.html#constant-selectivity-for-contiguous-ages-or-years"><i class="fa fa-check"></i><b>7.1.3</b> Constant selectivity for contiguous ages or years</a></li>
<li class="chapter" data-level="7.1.4" data-path="fitting.html"><a href="fitting.html#time-blocks-selectivity"><i class="fa fa-check"></i><b>7.1.4</b> Time blocks selectivity</a></li>
<li class="chapter" data-level="7.1.5" data-path="fitting.html"><a href="fitting.html#time-changing-selectivity"><i class="fa fa-check"></i><b>7.1.5</b> Time changing selectivity</a></li>
<li class="chapter" data-level="7.1.6" data-path="fitting.html"><a href="fitting.html#closed-form-selection-pattern"><i class="fa fa-check"></i><b>7.1.6</b> Closed form selection pattern</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="fitting.html"><a href="fitting.html#abundance-indices-catchability-submodel-q_ays"><i class="fa fa-check"></i><b>7.2</b> Abundance indices catchability submodel (<span class="math inline">\(Q_{ays}\)</span>)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-age-based-indices"><i class="fa fa-check"></i><b>7.2.1</b> Catchability submodel for age based indices</a></li>
<li class="chapter" data-level="7.2.2" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-age-aggregated-biomass-indices"><i class="fa fa-check"></i><b>7.2.2</b> Catchability submodel for age aggregated biomass indices</a></li>
<li class="chapter" data-level="7.2.3" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-single-age-indices"><i class="fa fa-check"></i><b>7.2.3</b> Catchability submodel for single age indices</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fitting.html"><a href="fitting.html#stock-recruitment-submodel-r_y"><i class="fa fa-check"></i><b>7.3</b> Stock-recruitment submodel (<span class="math inline">\(R_y\)</span>)</a></li>
<li class="chapter" data-level="7.4" data-path="fitting.html"><a href="fitting.html#observation-variance-submodel-sigma2_ay-tau2_ays"><i class="fa fa-check"></i><b>7.4</b> Observation variance submodel (<span class="math inline">\(\{\sigma^2_{ay}, \tau^2_{ays}\}\)</span>)</a></li>
<li class="chapter" data-level="7.5" data-path="fitting.html"><a href="fitting.html#initial-year-abundance-submodel-n_ay1"><i class="fa fa-check"></i><b>7.5</b> Initial year abundance submodel (<span class="math inline">\(N_{a,y=1}\)</span>)</a></li>
<li class="chapter" data-level="7.6" data-path="fitting.html"><a href="fitting.html#more-models"><i class="fa fa-check"></i><b>7.6</b> More models</a></li>
<li class="chapter" data-level="7.7" data-path="fitting.html"><a href="fitting.html#working-with-covariates"><i class="fa fa-check"></i><b>7.7</b> Working with covariates</a></li>
<li class="chapter" data-level="7.8" data-path="fitting.html"><a href="fitting.html#assessing-admb-files"><i class="fa fa-check"></i><b>7.8</b> Assessing <code>ADMB</code> files</a></li>
<li class="chapter" data-level="7.9" data-path="fitting.html"><a href="fitting.html#missing-observations-in-the-catch-matrix-or-index"><i class="fa fa-check"></i><b>7.9</b> Missing observations in the catch matrix or index</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>8</b> Diagnostics </a>
<ul>
<li class="chapter" data-level="8.1" data-path="diagnostics.html"><a href="diagnostics.html#residuals"><i class="fa fa-check"></i><b>8.1</b> Residuals</a></li>
<li class="chapter" data-level="8.2" data-path="diagnostics.html"><a href="diagnostics.html#predictive-skill"><i class="fa fa-check"></i><b>8.2</b> Predictive skill</a></li>
<li class="chapter" data-level="8.3" data-path="diagnostics.html"><a href="diagnostics.html#aggregated-catch-in-weight"><i class="fa fa-check"></i><b>8.3</b> Aggregated catch in weight</a></li>
<li class="chapter" data-level="8.4" data-path="diagnostics.html"><a href="diagnostics.html#fit-summary-information-and-cross-validation-metrics"><i class="fa fa-check"></i><b>8.4</b> Fit summary, information and cross-validation metrics</a></li>
<li class="chapter" data-level="8.5" data-path="diagnostics.html"><a href="diagnostics.html#retrospective-analysis"><i class="fa fa-check"></i><b>8.5</b> Retrospective analysis</a></li>
<li class="chapter" data-level="8.6" data-path="diagnostics.html"><a href="diagnostics.html#hindcast"><i class="fa fa-check"></i><b>8.6</b> Hindcast</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>9</b> Uncertainty </a>
<ul>
<li class="chapter" data-level="9.1" data-path="uncertainty.html"><a href="uncertainty.html#the-simulate-and-predict-methods"><i class="fa fa-check"></i><b>9.1</b> The <code>simulate</code> and <code>predict</code> methods</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="uncertainty.html"><a href="uncertainty.html#predict"><i class="fa fa-check"></i><b>9.1.1</b> <code>predict()</code></a></li>
<li class="chapter" data-level="9.1.2" data-path="uncertainty.html"><a href="uncertainty.html#simulate"><i class="fa fa-check"></i><b>9.1.2</b> <code>simulate()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="uncertainty.html"><a href="uncertainty.html#prediction-error"><i class="fa fa-check"></i><b>9.2</b> Prediction error</a></li>
<li class="chapter" data-level="9.3" data-path="uncertainty.html"><a href="uncertainty.html#confidence-interval-coverage"><i class="fa fa-check"></i><b>9.3</b> Confidence interval coverage</a></li>
<li class="chapter" data-level="9.4" data-path="uncertainty.html"><a href="uncertainty.html#propagate-uncertainty-into-stock-assessment"><i class="fa fa-check"></i><b>9.4</b> Propagate uncertainty into stock assessment</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>10</b> The statistical catch-at-age stock assessment framework with Markov Chain Monte Carlo (MCMC) </a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#the-mcmc-method-for-sca"><i class="fa fa-check"></i><b>10.1</b> The MCMC method for <code>sca</code></a></li>
<li class="chapter" data-level="10.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#diagnostics-with-coda"><i class="fa fa-check"></i><b>10.2</b> Diagnostics with CODA</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#traceplots"><i class="fa fa-check"></i><b>10.2.1</b> Traceplots</a></li>
<li class="chapter" data-level="10.2.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#autocorrelation-and-crosscorrelation-analysis"><i class="fa fa-check"></i><b>10.2.2</b> Autocorrelation and crosscorrelation analysis</a></li>
<li class="chapter" data-level="10.2.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#geweke-diagnostic"><i class="fa fa-check"></i><b>10.2.3</b> Geweke diagnostic</a></li>
<li class="chapter" data-level="10.2.4" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#cumulative-means"><i class="fa fa-check"></i><b>10.2.4</b> Cumulative means</a></li>
<li class="chapter" data-level="10.2.5" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#distribution-density"><i class="fa fa-check"></i><b>10.2.5</b> Distribution density</a></li>
<li class="chapter" data-level="10.2.6" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#gelman-rubin-statistic"><i class="fa fa-check"></i><b>10.2.6</b> Gelman-Rubin statistic</a></li>
<li class="chapter" data-level="10.2.7" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#acceptance-rate"><i class="fa fa-check"></i><b>10.2.7</b> Acceptance rate</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#admbs-arguments-to-tune-the-mcmc-algorithm"><i class="fa fa-check"></i><b>10.3</b> <code>ADMB</code>’s arguments to tune the MCMC algorithm</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#thinning-rate"><i class="fa fa-check"></i><b>10.3.1</b> Thinning rate</a></li>
<li class="chapter" data-level="10.3.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcscale-and-mcnoscale"><i class="fa fa-check"></i><b>10.3.2</b> mcscale and mcnoscale</a></li>
<li class="chapter" data-level="10.3.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcprobe"><i class="fa fa-check"></i><b>10.3.3</b> mcprobe</a></li>
<li class="chapter" data-level="10.3.4" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcrb"><i class="fa fa-check"></i><b>10.3.4</b> mcrb</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reference-points.html"><a href="reference-points.html"><i class="fa fa-check"></i><b>11</b> Reference Points</a>
<ul>
<li class="chapter" data-level="11.1" data-path="reference-points.html"><a href="reference-points.html#yield-per-recruit-reference-points"><i class="fa fa-check"></i><b>11.1</b> Yield per recruit reference points</a></li>
<li class="chapter" data-level="11.2" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-relationship-based-reference-points"><i class="fa fa-check"></i><b>11.2</b> Stock recruitment relationship based reference points</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-after-fitting-the-stock-assessment-model"><i class="fa fa-check"></i><b>11.2.1</b> Stock recruitment after fitting the stock assessment model</a></li>
<li class="chapter" data-level="11.2.2" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-during-stock-assessment-model-fit"><i class="fa fa-check"></i><b>11.2.2</b> Stock recruitment during stock assessment model fit</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reference-points.html"><a href="reference-points.html#economics-reference-points"><i class="fa fa-check"></i><b>11.3</b> Economics reference points</a></li>
<li class="chapter" data-level="11.4" data-path="reference-points.html"><a href="reference-points.html#computing-user-specific-reference-points"><i class="fa fa-check"></i><b>11.4</b> Computing user specific reference points</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html"><i class="fa fa-check"></i><b>12</b> Projections and harvest control rules</a>
<ul>
<li class="chapter" data-level="12.1" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#simple-workflow"><i class="fa fa-check"></i><b>12.1</b> Simple workflow</a></li>
<li class="chapter" data-level="12.2" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#initial-condition-assumptions"><i class="fa fa-check"></i><b>12.2</b> Initial condition assumptions</a></li>
<li class="chapter" data-level="12.3" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#scenarios"><i class="fa fa-check"></i><b>12.3</b> Scenarios</a></li>
<li class="chapter" data-level="12.4" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#relative-scenarios"><i class="fa fa-check"></i><b>12.4</b> Relative scenarios</a></li>
<li class="chapter" data-level="12.5" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#limits"><i class="fa fa-check"></i><b>12.5</b> Limits</a></li>
<li class="chapter" data-level="12.6" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#harvest-control-rules-hcr"><i class="fa fa-check"></i><b>12.6</b> Harvest Control Rules (HCR)</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html"><i class="fa fa-check"></i><b>13</b> Annex - stock assessment workflow</a>
<ul>
<li class="chapter" data-level="13.1" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-mean-model"><i class="fa fa-check"></i><b>13.1</b> The “mean” model</a></li>
<li class="chapter" data-level="13.2" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-age-effects"><i class="fa fa-check"></i><b>13.2</b> The age effects</a></li>
<li class="chapter" data-level="13.3" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#year-effect-on-fishing-mortality"><i class="fa fa-check"></i><b>13.3</b> Year effect on fishing mortality</a></li>
<li class="chapter" data-level="13.4" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#year-effect-on-catchability"><i class="fa fa-check"></i><b>13.4</b> Year effect on catchability</a></li>
<li class="chapter" data-level="13.5" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-initial-year-population-abundance-model-aka-n1"><i class="fa fa-check"></i><b>13.5</b> The initial year population abundance model, aka N1</a></li>
<li class="chapter" data-level="13.6" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-stock-recruitment-submodel"><i class="fa fa-check"></i><b>13.6</b> The stock recruitment submodel</a></li>
<li class="chapter" data-level="13.7" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-variance-submodel"><i class="fa fa-check"></i><b>13.7</b> The variance submodel</a></li>
<li class="chapter" data-level="13.8" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#final-comments"><i class="fa fa-check"></i><b>13.8</b> Final comments</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fish stock assessment with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="growth" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Modelling Individual Growth and Using Stochastic Slicing to Convert Length-based Data Into Age-based Data<a href="growth.html#growth" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The <code>a4a</code> stock assessment framework is based on age dynamics. Therefore, length information must be processed before running the stock assessment model. The methods in this section provide the analyst flexibility to use a large range of information sources, <em>e.g.</em> literature or online databases, to collect information about the species growth model and uncertainty about the model parameters.</p>
<p>The framework allows the analyst to parametrize individual growth, set the assumptions about it and condition the stock assessment model on those decisions. It incentivizes the uptake of estimation uncertainty, as well as exploring several parameterizations and/or growth models to deal with structural uncertainty, finally propagating uncertainty into stock assessment.</p>
<p>Within the <code>a4a</code> framework this is handled using the <code>a4aGr</code> class and its methods. This class stores information about the growth model and it’s parameters, including parameters’ uncertainty and the distributions governing it. The class’s main method is <code>l2a</code> that converts length to ages based on a length based stock object and using the model defined in the <code>a4aGr</code> instance.</p>
<div id="a4agr---the-growth-class" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> a4aGr - The growth class<a href="growth.html#a4agr---the-growth-class" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The conversion of length data to age is performed through the use of a growth model. The implementation is done through the <code>a4aGr</code> class .</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="growth.html#cb13-1" tabindex="-1"></a><span class="fu">showClass</span>(<span class="st">&quot;a4aGr&quot;</span>)</span></code></pre></div>
<pre><code>## Class &quot;a4aGr&quot; [package &quot;FLa4a&quot;]
## 
## Slots:
##                                                                             
## Name:      grMod  grInvMod    params      vcov     distr      name      desc
## Class:   formula   formula     FLPar     array character character character
##                 
## Name:      range
## Class:   numeric
## 
## Extends: &quot;FLComp&quot;</code></pre>
<p>To construct an <code>a4aGr</code> object, the growth model and parameters must be provided. Here we show an example using the von Bertalanffy growth model. To create the <code>a4aGr</code> object it’s necessary to pass the model equation (<span class="math inline">\(length \sim time\)</span>), the inverse model equation (<span class="math inline">\(time \sim length\)</span>) and the parameters. Any growth model can be used as long as it’s possible to write the model (and the inverse) as an R formula.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="growth.html#cb15-1" tabindex="-1"></a>vbObj <span class="ot">&lt;-</span> <span class="fu">a4aGr</span>(</span>
<span id="cb15-2"><a href="growth.html#cb15-2" tabindex="-1"></a>    <span class="at">grMod=</span><span class="sc">~</span>linf<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>(t<span class="sc">-</span>t0))),      </span>
<span id="cb15-3"><a href="growth.html#cb15-3" tabindex="-1"></a>    <span class="at">grInvMod=</span><span class="sc">~</span>t0<span class="dv">-1</span><span class="sc">/</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>len<span class="sc">/</span>linf),      </span>
<span id="cb15-4"><a href="growth.html#cb15-4" tabindex="-1"></a>    <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">linf=</span><span class="fl">58.5</span>, <span class="at">k=</span><span class="fl">0.086</span>, <span class="at">t0=</span><span class="fl">0.001</span>, <span class="at">units=</span><span class="fu">c</span>(<span class="st">&quot;cm&quot;</span>,<span class="st">&quot;year-1&quot;</span>,<span class="st">&quot;year&quot;</span>))     </span>
<span id="cb15-5"><a href="growth.html#cb15-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Check the model and its inverse:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="growth.html#cb16-1" tabindex="-1"></a>lc<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb16-2"><a href="growth.html#cb16-2" tabindex="-1"></a><span class="fu">predict</span>(vbObj, <span class="at">len=</span>lc)</span></code></pre></div>
<pre><code>##    iter
##           1
##   1 4.86575</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="growth.html#cb18-1" tabindex="-1"></a><span class="fu">predict</span>(vbObj, <span class="at">t=</span><span class="fu">predict</span>(vbObj, <span class="at">len=</span>lc))</span></code></pre></div>
<pre><code>##    iter
##      1
##   1 20</code></pre>
<p>The predict method allows the transformation between lengths and ages, and vice-versa, using the growth model.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="growth.html#cb20-1" tabindex="-1"></a><span class="fu">predict</span>(vbObj, <span class="at">len=</span><span class="dv">5</span><span class="sc">:</span><span class="dv">10</span><span class="fl">+0.5</span>)</span></code></pre></div>
<pre><code>##    iter
##            1
##   1 1.149080
##   2 1.370570
##   3 1.596362
##   4 1.826625
##   5 2.061540
##   6 2.301299</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="growth.html#cb22-1" tabindex="-1"></a><span class="fu">predict</span>(vbObj, <span class="at">t=</span><span class="dv">5</span><span class="sc">:</span><span class="dv">10</span><span class="fl">+0.5</span>)</span></code></pre></div>
<pre><code>##    iter
##            1
##   1 22.04376
##   2 25.04796
##   3 27.80460
##   4 30.33408
##   5 32.65511
##   6 34.78488</code></pre>
</div>
<div id="adding-uncertainty-to-growth-parameters-with-a-multivariate-normal-distribution" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Adding uncertainty to growth parameters with a multivariate normal distribution<a href="growth.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uncertainty in the growth model is introduced through the inclusion of parameter uncertainty. This is done by making use of the parameter variance-covariance matrix (the <code>vcov</code> slot of the <code>a4aGr</code> class) and setting a distribution for the parameters. The variance-covariance matrix could come from the parameter uncertainty from fitting the growth model parameters, or a meta analysis of correlation between parameters.</p>
<p>Here we set the variance-covariance matrix by scaling a correlation matrix, using a cv of 0.2. Based on</p>
<p><span class="math display">\[\rho_{x,y}=\frac{\Sigma_{x,y}}{\sigma_x \sigma_y}\]</span></p>
<p>and</p>
<p><span class="math display">\[CV_x=\frac{\sigma_x}{\mu_x}\]</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="growth.html#cb24-1" tabindex="-1"></a><span class="co"># Make an empty cor matrix</span></span>
<span id="cb24-2"><a href="growth.html#cb24-2" tabindex="-1"></a>cm <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb24-3"><a href="growth.html#cb24-3" tabindex="-1"></a><span class="co"># k and linf are negatively correlated while t0 is independent</span></span>
<span id="cb24-4"><a href="growth.html#cb24-4" tabindex="-1"></a>cm[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> cm[<span class="dv">2</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.5</span></span>
<span id="cb24-5"><a href="growth.html#cb24-5" tabindex="-1"></a><span class="co"># scale cor to var using CV=0.2</span></span>
<span id="cb24-6"><a href="growth.html#cb24-6" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb24-7"><a href="growth.html#cb24-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">linf=</span><span class="dv">60</span>, <span class="at">k=</span><span class="fl">0.09</span>, <span class="at">t0=</span><span class="sc">-</span><span class="fl">0.01</span>)</span>
<span id="cb24-8"><a href="growth.html#cb24-8" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb24-9"><a href="growth.html#cb24-9" tabindex="-1"></a>l <span class="ot">&lt;-</span> vc</span>
<span id="cb24-10"><a href="growth.html#cb24-10" tabindex="-1"></a>l[<span class="dv">1</span>,] <span class="ot">&lt;-</span> l[,<span class="dv">1</span>] <span class="ot">&lt;-</span> p[<span class="dv">1</span>]<span class="sc">*</span>cv</span>
<span id="cb24-11"><a href="growth.html#cb24-11" tabindex="-1"></a>k <span class="ot">&lt;-</span> vc</span>
<span id="cb24-12"><a href="growth.html#cb24-12" tabindex="-1"></a>k[,<span class="dv">2</span>] <span class="ot">&lt;-</span> k[<span class="dv">2</span>,] <span class="ot">&lt;-</span> p[<span class="dv">2</span>]<span class="sc">*</span>cv</span>
<span id="cb24-13"><a href="growth.html#cb24-13" tabindex="-1"></a>t <span class="ot">&lt;-</span> vc</span>
<span id="cb24-14"><a href="growth.html#cb24-14" tabindex="-1"></a>t[<span class="dv">3</span>,] <span class="ot">&lt;-</span> t[,<span class="dv">3</span>] <span class="ot">&lt;-</span> p[<span class="dv">3</span>]<span class="sc">*</span>cv</span>
<span id="cb24-15"><a href="growth.html#cb24-15" tabindex="-1"></a>mm <span class="ot">&lt;-</span> t<span class="sc">*</span>k<span class="sc">*</span>l</span>
<span id="cb24-16"><a href="growth.html#cb24-16" tabindex="-1"></a><span class="fu">diag</span>(mm) <span class="ot">&lt;-</span> <span class="fu">diag</span>(mm)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb24-17"><a href="growth.html#cb24-17" tabindex="-1"></a>mm <span class="ot">&lt;-</span> mm<span class="sc">*</span>cm</span>
<span id="cb24-18"><a href="growth.html#cb24-18" tabindex="-1"></a><span class="co"># check that we have the intended correlation</span></span>
<span id="cb24-19"><a href="growth.html#cb24-19" tabindex="-1"></a><span class="fu">all.equal</span>(cm, <span class="fu">cov2cor</span>(mm))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Create the <code>a4aGr</code> object as before but now we also include the <code>vcov</code> argument for the variance-covariance matrix.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="growth.html#cb26-1" tabindex="-1"></a>vbObj <span class="ot">&lt;-</span> <span class="fu">a4aGr</span>(</span>
<span id="cb26-2"><a href="growth.html#cb26-2" tabindex="-1"></a>  <span class="at">grMod=</span><span class="sc">~</span>linf<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>k<span class="sc">*</span>(t<span class="sc">-</span>t0))),</span>
<span id="cb26-3"><a href="growth.html#cb26-3" tabindex="-1"></a>  <span class="at">grInvMod=</span><span class="sc">~</span>t0<span class="dv">-1</span><span class="sc">/</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>len<span class="sc">/</span>linf),</span>
<span id="cb26-4"><a href="growth.html#cb26-4" tabindex="-1"></a>  <span class="at">params=</span><span class="fu">FLPar</span>(</span>
<span id="cb26-5"><a href="growth.html#cb26-5" tabindex="-1"></a>    <span class="at">linf=</span>p[<span class="st">&quot;linf&quot;</span>], <span class="at">k=</span>p[<span class="st">&quot;k&quot;</span>], <span class="at">t0=</span>p[<span class="st">&quot;t0&quot;</span>],</span>
<span id="cb26-6"><a href="growth.html#cb26-6" tabindex="-1"></a>    <span class="at">units=</span><span class="fu">c</span>(<span class="st">&quot;cm&quot;</span>,<span class="st">&quot;year-1&quot;</span>,<span class="st">&quot;year&quot;</span>)),</span>
<span id="cb26-7"><a href="growth.html#cb26-7" tabindex="-1"></a>    <span class="at">vcov=</span>mm</span>
<span id="cb26-8"><a href="growth.html#cb26-8" tabindex="-1"></a>)</span></code></pre></div>
<p>First we show a simple example where we assume that the parameters are represented using a multivariate normal distribution. Note that the object we have just created has a single iteration of each parameter.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="growth.html#cb27-1" tabindex="-1"></a>vbObj<span class="sc">@</span>params</span></code></pre></div>
<pre><code>## An object of class &quot;FLPar&quot;
## params
##  linf     k    t0 
## 60.00  0.09 -0.01 
## units:  cm year-1 year</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="growth.html#cb29-1" tabindex="-1"></a><span class="fu">dim</span>(vbObj<span class="sc">@</span>params)</span></code></pre></div>
<pre><code>## [1] 3 1</code></pre>
<p>We simulate 250 iterations from the <code>a4aGr</code> object by calling <code>mvrnorm()</code> using the variance-covariance matrix we created earlier. The object will now have 250 iterations of each parameter, randomly sampled from the multivariate normal distribution.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="growth.html#cb31-1" tabindex="-1"></a>vbNorm <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">250</span>,vbObj)</span>
<span id="cb31-2"><a href="growth.html#cb31-2" tabindex="-1"></a>vbNorm<span class="sc">@</span>params</span></code></pre></div>
<pre><code>## An object of class &quot;FLPar&quot;
## iters:  250 
## 
## params
##                linf                   k                  t0 
## 59.353077(11.54632)  0.088790( 0.01817) -0.010038( 0.00189) 
## units:  cm year-1 year</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="growth.html#cb33-1" tabindex="-1"></a><span class="fu">dim</span>(vbNorm<span class="sc">@</span>params)</span></code></pre></div>
<pre><code>## [1]   3 250</code></pre>
<p>We can now convert from length to ages data based on the 250 parameter iterations, which will produce 250 sets of age data. For example, the next code will convert a single length vector using each of the 250 parameter iterations.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="growth.html#cb35-1" tabindex="-1"></a>lvec <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span><span class="fl">+0.5</span></span>
<span id="cb35-2"><a href="growth.html#cb35-2" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">predict</span>(vbNorm, <span class="at">len=</span>lvec)</span>
<span id="cb35-3"><a href="growth.html#cb35-3" tabindex="-1"></a><span class="fu">dim</span>(ages)</span></code></pre></div>
<pre><code>## [1]   6 250</code></pre>
<p>The marginal distributions of the parameters can be seen in Figure <a href="growth.html#fig:plotnormparams">3.1</a>.</p>
<div class="figure"><span style="display:block;" id="fig:plotnormparams"></span>
<img src="_main_files/figure-html/plotnormparams-1.png" alt="The marginal distributions of each of the parameters from using a multivariate normal distribution." width="672" />
<p class="caption">
Figure 3.1: The marginal distributions of each of the parameters from using a multivariate normal distribution.
</p>
</div>
<p>Pairwise plots show the covariance between each pair of parameters and the shape of their correlation (Figure <a href="growth.html#fig:plotnormscatter">3.2</a>).</p>
<div class="figure"><span style="display:block;" id="fig:plotnormscatter"></span>
<img src="_main_files/figure-html/plotnormscatter-1.png" alt="Scatter plot of the 10000 samples parameter from the multivariate normal distribution." width="672" />
<p class="caption">
Figure 3.2: Scatter plot of the 10000 samples parameter from the multivariate normal distribution.
</p>
</div>
<p>Using the new generated age vectors one can depict the growth curves for the 250 iterations, which displays individual growth uncertainty (Figure <a href="growth.html#fig:plotmvgrowth">3.3</a>).</p>
<div class="figure"><span style="display:block;" id="fig:plotmvgrowth"></span>
<img src="_main_files/figure-html/plotmvgrowth-1.png" alt="Growth curves using parameters simulated from a multivariate normal distribution." width="672" />
<p class="caption">
Figure 3.3: Growth curves using parameters simulated from a multivariate normal distribution.
</p>
</div>
</div>
<div id="adding-uncertainty-to-growth-parameters-with-a-multivariate-triangle-distribution" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Adding uncertainty to growth parameters with a multivariate triangle distribution<a href="growth.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-triangle-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p></p>
<p>One alternative to using a normal distribution is to use a <a href="http://en.wikipedia.org/wiki/Triangle_distribution">triangle distribution</a>. We use the package <code>triangle</code> <span class="citation">(<a href="#ref-R-triangle">Carnell 2022</a>)</span> where this distribution is parametrized using the minimum, maximum and median values. This can be very attractive if the analyst needs to scrape information from the web or literature, and use a meta-analysis to build the parameters’ distribution. The triangle distribution has the advantage of setting hard tail limits, avoiding to generate extreme values. Here we show an example of setting a triangle distribution with values taken from Fishbase <span class="citation">(<a href="#ref-fishbase">Froese and Pauly 2000</a>)</span>.</p>
<p>The following shows a method to extract data from fishbase. However, due to potential changes in the way one gets data from fishbase from whithin R, we’ve downloaded the data beforehand and load it for this example.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="growth.html#cb37-1" tabindex="-1"></a><span class="co"># The web address for the growth parameters for redfish (Sebastes norvegicus)</span></span>
<span id="cb37-2"><a href="growth.html#cb37-2" tabindex="-1"></a>addr <span class="ot">&lt;-</span> <span class="st">&quot;https://fishbase.se/PopDyn/PopGrowthList.php?ID=501&quot;</span></span>
<span id="cb37-3"><a href="growth.html#cb37-3" tabindex="-1"></a><span class="co"># Scrape the data</span></span>
<span id="cb37-4"><a href="growth.html#cb37-4" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">readHTMLTable</span>(addr))</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="growth.html#cb38-1" tabindex="-1"></a><span class="co"># Interrogate the data table and get vectors of the values</span></span>
<span id="cb38-2"><a href="growth.html#cb38-2" tabindex="-1"></a>linf <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(tab<span class="sc">$</span>dataTable[,<span class="dv">2</span>]))</span>
<span id="cb38-3"><a href="growth.html#cb38-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(tab<span class="sc">$</span>dataTable[,<span class="dv">4</span>]))</span>
<span id="cb38-4"><a href="growth.html#cb38-4" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(tab<span class="sc">$</span>dataTable[,<span class="dv">5</span>]))</span>
<span id="cb38-5"><a href="growth.html#cb38-5" tabindex="-1"></a><span class="co"># Set the min (a), max (b) and median (c) values for the parameter as a list of lists</span></span>
<span id="cb38-6"><a href="growth.html#cb38-6" tabindex="-1"></a><span class="co"># Note that t0 has no &#39;c&#39; (median) value. This makes the distribution symmetrical</span></span>
<span id="cb38-7"><a href="growth.html#cb38-7" tabindex="-1"></a>triPars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-8"><a href="growth.html#cb38-8" tabindex="-1"></a>  <span class="at">linf=</span><span class="fu">list</span>(<span class="at">a=</span><span class="fu">min</span>(linf), <span class="at">b=</span><span class="fu">max</span>(linf), <span class="at">c=</span><span class="fu">median</span>(linf)),</span>
<span id="cb38-9"><a href="growth.html#cb38-9" tabindex="-1"></a>  <span class="at">k=</span><span class="fu">list</span>(<span class="at">a=</span><span class="fu">min</span>(k), <span class="at">b=</span><span class="fu">max</span>(k), <span class="at">c=</span><span class="fu">median</span>(k)),</span>
<span id="cb38-10"><a href="growth.html#cb38-10" tabindex="-1"></a>  <span class="at">t0=</span><span class="fu">list</span>(<span class="at">a=</span><span class="fu">median</span>(t0, <span class="at">na.rm=</span>T)<span class="sc">-</span><span class="fu">IQR</span>(t0, <span class="at">na.rm=</span>T)<span class="sc">/</span><span class="dv">2</span>, <span class="at">b=</span><span class="fu">median</span>(t0, <span class="at">na.rm=</span>T)<span class="sc">+</span><span class="fu">IQR</span>(t0, <span class="at">na.rm=</span>T)<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb38-11"><a href="growth.html#cb38-11" tabindex="-1"></a></span>
<span id="cb38-12"><a href="growth.html#cb38-12" tabindex="-1"></a><span class="co"># Draw 250 samples using mvrtriangle</span></span>
<span id="cb38-13"><a href="growth.html#cb38-13" tabindex="-1"></a>vbTri <span class="ot">&lt;-</span> <span class="fu">mvrtriangle</span>(<span class="dv">250</span>, vbObj, <span class="at">paramMargins=</span>triPars)</span></code></pre></div>
<p>Note that in this case we’re not building a new object with all the parameters’ information. We’re using the argument <code>paramMargins</code> to pass the parameters’ information to the method.</p>
<p>The marginals will reflect the uncertainty on the parameter values that were scraped from <span class="citation">Froese and Pauly (<a href="#ref-fishbase">2000</a>)</span> but, as we don’t really believe the parameters are multivariate normal, here we adopted a distribution based on a <em>t</em> copula with triangle marginals. The marginal distributions can be seen in Figure <a href="growth.html#fig:plottriparams">3.4</a> and the shape of the correlation can be seen in Figure <a href="growth.html#fig:plottriscatter">3.5</a>.</p>
<div class="figure"><span style="display:block;" id="fig:plottriparams"></span>
<img src="_main_files/figure-html/plottriparams-1.png" alt="The marginal distributions of each of the parameters from using a multivariate triangle distribution." width="672" />
<p class="caption">
Figure 3.4: The marginal distributions of each of the parameters from using a multivariate triangle distribution.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:plottriscatter"></span>
<img src="_main_files/figure-html/plottriscatter-1.png" alt="Scatter plot of the 10000 samples parameter from the multivariate triangle distribution." width="672" />
<p class="caption">
Figure 3.5: Scatter plot of the 10000 samples parameter from the multivariate triangle distribution.
</p>
</div>
<p>We can still use <code>predict()</code> to see the growth model uncertainty (Figure <a href="growth.html#fig:plottrigrowth">3.6</a>). Comparing with Figure <a href="growth.html#fig:plotmvgrowth">3.3</a> one can see that using triangle distribution generates a lot less outliers, or values outside the central range of the growth curve.</p>
<div class="figure"><span style="display:block;" id="fig:plottrigrowth"></span>
<img src="_main_files/figure-html/plottrigrowth-1.png" alt="Growth curves using parameters simulated from a multivariate triangle distribution." width="672" />
<p class="caption">
Figure 3.6: Growth curves using parameters simulated from a multivariate triangle distribution.
</p>
</div>
<p>Remember that the above examples use a variance-covariance matrix that we essentially made up. An alternative would be to scrape the entire growth parameters dataset from Fishbase and compute the shape of the variance-covariance matrix yourself.</p>
</div>
<div id="adding-uncertainty-to-growth-parameters-with-statistical-copulas" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Adding uncertainty to growth parameters with statistical copulas<a href="growth.html#adding-uncertainty-to-growth-parameters-with-statistical-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A more general approach to adding parameter uncertainty is to make use of statistical copulas <span class="citation">(<a href="#ref-sklar1959">Sklar 1959</a>)</span>. <span class="citation">Genest, Okhrin, and Bodnar (<a href="#ref-copulahistory">2024</a>)</span> describes statistical “copula” as a multivariate cumulative distribution function with uniform margins on the unit interval. <span class="citation">Sklar (<a href="#ref-sklar1959">1959</a>)</span> highlighted the fact that any multivariate distribution can be expressed as a function of its margins and a copula. The idea is very actractive, one can simulate any multivariate distribution by setting a multivariate function in the unit interval which describes how the margins relate to each other, and scale up the univariate uniform margin with any continuos univariate distribution.</p>
<p>In our case this is possible with the <code>mvrcop()</code> function, borrowed from the package <code>copula</code> <span class="citation">(<a href="#ref-R-copula">Jun Yan 2007</a>)</span>. The example below keeps the same parameters and changes only the copula type and family but a lot more can be done. Check the package <code>copula</code> for more information.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="growth.html#cb39-1" tabindex="-1"></a>vbCop <span class="ot">&lt;-</span> <span class="fu">mvrcop</span>(<span class="dv">250</span>, vbObj,</span>
<span id="cb39-2"><a href="growth.html#cb39-2" tabindex="-1"></a>  <span class="at">copula=</span><span class="st">&quot;archmCopula&quot;</span>,</span>
<span id="cb39-3"><a href="growth.html#cb39-3" tabindex="-1"></a>  <span class="at">family=</span><span class="st">&quot;clayton&quot;</span>,</span>
<span id="cb39-4"><a href="growth.html#cb39-4" tabindex="-1"></a>  <span class="at">param=</span><span class="dv">2</span>,</span>
<span id="cb39-5"><a href="growth.html#cb39-5" tabindex="-1"></a>  <span class="at">margins=</span><span class="st">&quot;triangle&quot;</span>,</span>
<span id="cb39-6"><a href="growth.html#cb39-6" tabindex="-1"></a>  <span class="at">paramMargins=</span>triPars)</span></code></pre></div>
<p>The shape of the correlation as well as the resulting growth curves are shown in Figures <a href="growth.html#fig:plotcoptriscatter">3.7</a> and <a href="growth.html#fig:plotcoptrigrowth">3.8</a>.</p>
<div class="figure"><span style="display:block;" id="fig:plotcoptriscatter"></span>
<img src="_main_files/figure-html/plotcoptriscatter-1.png" alt="Scatter plot of the 250 samples parameter from the using an archmCopula copula with triangle margins." width="672" />
<p class="caption">
Figure 3.7: Scatter plot of the 250 samples parameter from the using an archmCopula copula with triangle margins.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:plotcoptrigrowth"></span>
<img src="_main_files/figure-html/plotcoptrigrowth-1.png" alt="Growth curves using parameters simulated from an archmCopula copula with triangle margins." width="672" />
<p class="caption">
Figure 3.8: Growth curves using parameters simulated from an archmCopula copula with triangle margins.
</p>
</div>
</div>
<div id="converting-from-length-to-age-based-data---the-l2a-method" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Converting from length to age based data - the <code>l2a()</code> method<a href="growth.html#converting-from-length-to-age-based-data---the-l2a-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>After introducing uncertainty in the growth model through the parameters it’s time to transform the length-based dataset into an age-based dataset. The method that deals with this process is <code>l2a()</code>. The implementation of this method for the <code>FLQuant</code> class is the main workhorse. There are two other implementations, for the <code>FLStock</code> and <code>FLIndex</code> classes, which are mainly wrappers that call the <code>FLQuant</code> method several times.</p>
<p>When converting from length-based data to age-based data you need to be aware of how the aggregation of length classes is performed. For example, individuals in length classes 1-2, 2-3, and 3-4 cm may all be considered as being of age 1 (obviously depending on the growth model). How should the values in those length classes be combined?</p>
<p>If the values are abundances then the values should be summed. Summing other types of values, such as mean weight, does not make sense. Instead these values are averaged over the length classes (possibly weighted by the abundance). This is controlled using the <code>stat</code> argument which can be either <code>mean</code> or <code>sum</code> (the default). Fishing mortality is not computed to avoid making wrong assumptions about the meaning of F at length.</p>
<p>We demonstrate the method by converting a catch-at-length <code>FLQuant</code> to a catch-at-age <code>FLQuant</code>. First we make an <code>a4aGr</code> object with a multivariate triangle distribution using parameters extracted from an AI agent. We use 10 iterations as an example, and call <code>l2a()</code> by passing in the length-based <code>FLQuant</code> and the <code>a4aGr</code> object.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="growth.html#cb40-1" tabindex="-1"></a>triPars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb40-2"><a href="growth.html#cb40-2" tabindex="-1"></a>  <span class="at">linf=</span><span class="fu">list</span>(<span class="at">a=</span><span class="dv">55</span>, <span class="at">b=</span><span class="dv">60</span>),</span>
<span id="cb40-3"><a href="growth.html#cb40-3" tabindex="-1"></a>  <span class="at">k=</span><span class="fu">list</span>(<span class="at">a=</span><span class="fl">0.05</span>, <span class="at">b=</span><span class="fl">0.06</span>),</span>
<span id="cb40-4"><a href="growth.html#cb40-4" tabindex="-1"></a>  <span class="at">t0=</span><span class="fu">list</span>(<span class="at">a=</span><span class="sc">-</span><span class="dv">3</span>, <span class="at">b=</span><span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb40-5"><a href="growth.html#cb40-5" tabindex="-1"></a></span>
<span id="cb40-6"><a href="growth.html#cb40-6" tabindex="-1"></a><span class="co"># Draw 10 samples using mvrtriangle</span></span>
<span id="cb40-7"><a href="growth.html#cb40-7" tabindex="-1"></a>vbTriSmall <span class="ot">&lt;-</span> <span class="fu">mvrtriangle</span>(<span class="dv">10</span>, vbObj, <span class="at">paramMargins=</span>triPars)</span>
<span id="cb40-8"><a href="growth.html#cb40-8" tabindex="-1"></a><span class="co"># slice catch numbers at lengths to ages by summing catches</span></span>
<span id="cb40-9"><a href="growth.html#cb40-9" tabindex="-1"></a>cth.n <span class="ot">&lt;-</span> <span class="fu">l2a</span>(<span class="fu">catch.n</span>(rfLen.stk), vbTriSmall)</span>
<span id="cb40-10"><a href="growth.html#cb40-10" tabindex="-1"></a><span class="co"># note there&#39;s a lot of 0 catches so we&#39;ll set the plus group at 21</span></span>
<span id="cb40-11"><a href="growth.html#cb40-11" tabindex="-1"></a>cth.n <span class="ot">&lt;-</span> <span class="fu">setPlusGroup</span>(cth.n, <span class="dv">21</span>)</span>
<span id="cb40-12"><a href="growth.html#cb40-12" tabindex="-1"></a><span class="co"># there&#39;s also negative ages. The simulated data included individuals in lengths that won&#39;t show in the catches, like 1 cm. We&#39;ll trim those ages</span></span>
<span id="cb40-13"><a href="growth.html#cb40-13" tabindex="-1"></a>cth.n <span class="ot">&lt;-</span> cth.n[<span class="fu">ac</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">21</span>)]</span>
<span id="cb40-14"><a href="growth.html#cb40-14" tabindex="-1"></a></span>
<span id="cb40-15"><a href="growth.html#cb40-15" tabindex="-1"></a><span class="co"># slice catch weights at lengths to ages by averaging catches</span></span>
<span id="cb40-16"><a href="growth.html#cb40-16" tabindex="-1"></a>cth.wt <span class="ot">&lt;-</span> <span class="fu">l2a</span>(<span class="fu">catch.wt</span>(rfLen.stk), vbTriSmall, <span class="at">stat=</span><span class="st">&quot;mean&quot;</span>)</span>
<span id="cb40-17"><a href="growth.html#cb40-17" tabindex="-1"></a><span class="co"># same process to deal with negative ages</span></span>
<span id="cb40-18"><a href="growth.html#cb40-18" tabindex="-1"></a>cth.wt <span class="ot">&lt;-</span> cth.wt[<span class="fu">ac</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">21</span>)]</span></code></pre></div>
<p>In the previous example, the <code>FLQuant</code> object that was sliced (<code>catch.n(rfLen.stk)</code>) had only one iteration. This iteration was sliced by each of the iterations in the growth model. It is possible for the <code>FLQuant</code> object to have the same number of iterations as the growth model, in which case each iteration of the <code>FLQuant</code> and the growth model are used together. It is also possible for the growth model to have only one iteration while the <code>FLQuant</code> object has many iterations. The same growth model is then used for each of the <code>FLQuant</code> iterations. As with all <code>FLR</code> objects, the general rule is <em>one or n</em> iterations.</p>
<p>As well as converting one <code>FLQuant</code> at a time, we can convert entire <code>FLStock</code> and <code>FLIndex</code> objects. In these cases the individual <code>FLQuant</code> slots of those classes are converted from length-based to age-based. As mentioned above, the aggregation method depends on the type of values the slots contain. The abundance slots (<code>*.n</code>, such as <code>stock.n</code>) are summed. The <code>*.wt</code>, <code>m</code>, <code>mat</code>, <code>harvest.spwn</code> and <code>m.spwn</code> slots of an <code>FLStock</code> object are averaged. The <code>catch.wt</code> and <code>sel.pattern</code> slots of an <code>FLIndex</code> object are averaged, while the <code>index</code>, <code>index.var</code> and <code>catch.n</code> slots are summed.</p>
<p>The method for <code>FLStock</code> classes takes an additional argument for the plusgroup.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="growth.html#cb41-1" tabindex="-1"></a>aStk <span class="ot">&lt;-</span> <span class="fu">l2a</span>(rfLen.stk, vbTriSmall, <span class="at">plusgroup=</span><span class="dv">21</span>)</span></code></pre></div>
<pre><code>## [1] &quot;maxfbar has been changed to accomodate new plusgroup&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="growth.html#cb43-1" tabindex="-1"></a>aIdx <span class="ot">&lt;-</span> <span class="fu">l2a</span>(rfTrawl.idx, vbTriSmall)</span></code></pre></div>
<p>When converting with <code>l2a()</code> all lengths above Linf are converted to the maximum age, as there is no information in the growth model about how to deal with individuals larger than Linf.</p>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-triangle" class="csl-entry">
Carnell, Rob. 2022. <em>Triangle: Distribution Functions and Parameter Estimates for the Triangle Distribution</em>. <a href="https://bertcarnell.github.io/triangle/">https://bertcarnell.github.io/triangle/</a>.
</div>
<div id="ref-fishbase" class="csl-entry">
Froese, R., and D. Pauly, eds. 2000. <em>FishBase 2000: Concepts, Design and Data Sources.</em> ICLARM, Los Baños, Laguna, Philippines.
</div>
<div id="ref-copulahistory" class="csl-entry">
Genest, Christian, Ostap Okhrin, and Taras Bodnar. 2024. <span>“Copula Modeling from Abe Sklar to the Present Day.”</span> <em>Journal of Multivariate Analysis</em> 201: 105278. https://doi.org/<a href="https://doi.org/10.1016/j.jmva.2023.105278">https://doi.org/10.1016/j.jmva.2023.105278</a>.
</div>
<div id="ref-R-copula" class="csl-entry">
Jun Yan. 2007. <span>“Enjoy the Joy of Copulas: With a Package <span class="nocase">copula</span>.”</span> <em>Journal of Statistical Software</em> 21 (4): 1–21. <a href="https://www.jstatsoft.org/v21/i04/">https://www.jstatsoft.org/v21/i04/</a>.
</div>
<div id="ref-sklar1959" class="csl-entry">
Sklar, M. 1959. <span>“Fonctions de r<span>é</span>partition <span class="nocase">à</span> n Dimensions Et Leurs Marges.”</span> In <em>Annales de l’ISUP</em>, 8:229–31. 3.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelling-natural-mortality.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-growth.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf", "_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
