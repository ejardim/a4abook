[["propagate-uncertainty-into-stock-assessment.html", "14 Propagate uncertainty into stock assessment", " 14 Propagate uncertainty into stock assessment In a multistage stock assessment process as described in this book, it’s important to be able to propagate uncertainty across the different stages. This section describes methods to propagate uncertainty across stages and compares their outcomes in terms of stock assessment outputs. The idea is to add uncertainty as one moves from one stage to the next. If a stock has uncertainty on it’s growth parameters, or natural mortality, or any other quantity estimated or set during the input data preparation, the model fit uncertainty will be added to it by generating iterations in the input data which are then used to fit the stock assessment model. The suggested workflow is: Add uncertainty in growth or M parameters. Draw from the parameters distribution. Compute metrics for stock assessment. If there’s uncertainty in growth parameters use slicing to created iterations of metrics by age, e.g. catch at age and index at age. If there’s uncertainty in M parameters draw from the distribution and generate iterations of the M matrix. If both draw from growth and M parameters, potentially having into account correlation between those parameters, and generate iterations of age based metrics and M. Fit the stock assessment model to each iteration Simulate from each fit Aggregate results in single FLStock object. In this section we give an example of how uncertainty in natural mortality, set up using the m() method and the class a4aM (see chapter XX), is propagated through the stock assessment. We’ll use the stock of Red Mullet in the Mediterranean GSA 1 (see Introduction for details) and 3 methods to add estimation uncertainty (step 5 above): Take one draw of the fit Take n draws of the fit and summarize with the median Take n draws of the fit and combine all These outcomes will be compared with a fit across M iterations without any sampling from the fit. Using a4a methods we’ll model natural mortality using a negative exponential model by age, Jensen’s estimator for the level and no time trend. We include multivariate normal uncertainty using the mvrnorm() method and create 250 iterations. nits &lt;- 250 shape &lt;- FLModelSim(model=~exp(-age-0.5)) level &lt;- FLModelSim(model=~k^0.66*t^0.57, params = FLPar(k=0.4, t=10), vcov=matrix(c(0.002, 0.01,0.01, 1), ncol=2)) #trend &lt;- FLModelSim(model=~b, params=FLPar(b=0.5), vcov=matrix(0.02)) m4 &lt;- a4aM(shape=shape, level=level) m4 &lt;- mvrnorm(nits, m4) range(m4)[] &lt;- range(stk00)[] range(m4)[c(&quot;minmbar&quot;,&quot;maxmbar&quot;)]&lt;-c(1,1) flq &lt;- m(m4)[] quant(flq) &lt;- &quot;age&quot; stk0 &lt;- propagate(stk00, nits) m(stk0) &lt;- flq The M matrix for this stock is shown in Figure14.1). Figure 14.1: Natural mortality generated from M model’s parameter uncertainty We fit the same model to the new stock object which has uncertainty in the natural mortality and add estimation uncertainty following the methods described above. # create objects to store the results stk01 &lt;- stk0 stk02 &lt;- stk0 stk03 &lt;- propagate(stk00, nits*nits) # run without estimation unceratainty stk04 &lt;- stk00 + sca(stk0, idx00) for(i in 1:nits){ stk &lt;- iter(stk0, i) fit &lt;- sca(stk, idx00) # Method 1 iter(stk01, i) &lt;- stk + simulate(fit, 1) # Method 2 iter(stk02, i) &lt;- qapply(stk + simulate(fit, nits), iterMedians) # Method 3 iter(stk03, (nits*(i-1)+1):(nits*i)) &lt;- stk + simulate(fit, nits) } plot(FLStocks(&quot;M&quot;=stk04, &quot;M + 1 estimation sample&quot;=stk01, &quot;M + estimation median&quot;=stk02, &quot;M + n estimation samples&quot;=stk03)) Figure 14.2: Stock summary. Stock metrics computed over fits including uncertainty in M and estimation uncertainty "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
