<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 Annex - stock assessment workflow | Fish stock assessment with R</title>
  <meta name="description" content="How to do stock assessment in R using the a4a framework" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="18 Annex - stock assessment workflow | Fish stock assessment with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="How to do stock assessment in R using the a4a framework" />
  <meta name="github-repo" content="ejardim/a4abook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 Annex - stock assessment workflow | Fish stock assessment with R" />
  
  <meta name="twitter:description" content="How to do stock assessment in R using the a4a framework" />
  

<meta name="author" content="John Doe and friends" />


<meta name="date" content="2025-03-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sections-to-be-added.html"/>

<script src="libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stock assessment framework</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Before starting</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#license-documentation-and-development-status"><i class="fa fa-check"></i><b>1.1</b> License, documentation and development status</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-and-loading-libraries"><i class="fa fa-check"></i><b>1.2</b> Installing and loading libraries</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#how-to-read-this-document"><i class="fa fa-check"></i><b>1.3</b> How to read this document</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#how-to-get-help"><i class="fa fa-check"></i><b>1.4</b> How to get help</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#notation"><i class="fa fa-check"></i><b>1.5</b> Notation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#the-assessment-for-all-initiative-a4a"><i class="fa fa-check"></i><b>2.1</b> The “Assessment for All” Initiative (a4a)</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#multi-stage-modelling-approach"><i class="fa fa-check"></i><b>2.2</b> Multi-stage modelling approach</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#stock-assessment-process-add-something-about-using-sca-as-exploratory-data-tool"><i class="fa fa-check"></i><b>2.3</b> Stock Assessment Process [ADD SOMETHING ABOUT USING SCA AS EXPLORATORY DATA TOOL]</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#stock-assessment-as-a-linear-model-colin"><i class="fa fa-check"></i><b>2.4</b> Stock assessment as a linear model [COLIN]</a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#data-used-in-the-book"><i class="fa fa-check"></i><b>2.5</b> Data used in the book</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction.html"><a href="introduction.html#plaice-in-area-fao-27-ices-area-iv"><i class="fa fa-check"></i><b>2.5.1</b> Plaice in area FAO 27, ICES area IV</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction.html"><a href="introduction.html#european-hake-in-fao-37-gsas-1567"><i class="fa fa-check"></i><b>2.5.2</b> European hake in FAO 37, GSAs 1,5,6,7</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction.html"><a href="introduction.html#red-mullet-in-fao-27-gsa-1"><i class="fa fa-check"></i><b>2.5.3</b> Red mullet in FAO 27, GSA 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html"><i class="fa fa-check"></i><b>3</b> Introduction to Splines</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#generalize-to-polynomials"><i class="fa fa-check"></i><b>3.1</b> Generalize to polynomials</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#thin-plate-spline"><i class="fa fa-check"></i><b>3.2</b> Thin plate spline</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#comparison"><i class="fa fa-check"></i><b>3.3</b> Comparison</a></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#the-mgcv-package-inside-a4a"><i class="fa fa-check"></i><b>3.4</b> The <code>mgcv</code> package inside <code>a4a</code></a></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#on-the-number-of-knots-k"><i class="fa fa-check"></i><b>3.5</b> On the number of knots <span class="math inline">\(k\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><i class="fa fa-check"></i><b>4</b> Modelling Individual Growth and Using Stochastic Slicing to Convert Length-based Data Into Age-based Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#a4agr---the-growth-class"><i class="fa fa-check"></i><b>4.1</b> a4aGr - The growth class</a></li>
<li class="chapter" data-level="4.2" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>4.2</b> Adding uncertainty to growth parameters with a multivariate normal distribution}</a></li>
<li class="chapter" data-level="4.3" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-triangle-distribution"><i class="fa fa-check"></i><b>4.3</b> Adding uncertainty to growth parameters with a multivariate triangle distribution}</a></li>
<li class="chapter" data-level="4.4" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#adding-uncertainty-to-growth-parameters-with-statistical-copulas"><i class="fa fa-check"></i><b>4.4</b> Adding uncertainty to growth parameters with statistical copulas}</a></li>
<li class="chapter" data-level="4.5" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#converting-from-length-to-age-based-data---the-l2a-method"><i class="fa fa-check"></i><b>4.5</b> Converting from length to age based data - the <code>l2a()</code> method}</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html"><i class="fa fa-check"></i><b>5</b> Modelling Natural Mortality</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#a4am---the-m-class"><i class="fa fa-check"></i><b>5.1</b> <code>a4aM</code> - The M class</a></li>
<li class="chapter" data-level="5.2" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#adding-uncertainty-to-natural-mortality-parameters-with-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>5.2</b> Adding uncertainty to natural mortality parameters with a multivariate normal distribution</a></li>
<li class="chapter" data-level="5.3" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#adding-uncertainty-to-natural-mortality-parameters-with-statistical-copulas"><i class="fa fa-check"></i><b>5.3</b> Adding uncertainty to natural mortality parameters with statistical copulas</a></li>
<li class="chapter" data-level="5.4" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#computing-natural-mortality-time-series---the-m-method"><i class="fa fa-check"></i><b>5.4</b> Computing natural mortality time series - the “m” method</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html"><i class="fa fa-check"></i><b>6</b> Stock assessment framework</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#maths-description"><i class="fa fa-check"></i><b>6.1</b> Maths description </a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#observations"><i class="fa fa-check"></i><b>6.1.1</b> Observations</a></li>
<li class="chapter" data-level="6.1.2" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#the-population-dynamics-model"><i class="fa fa-check"></i><b>6.1.2</b> The population dynamics model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#classes-description"><i class="fa fa-check"></i><b>6.2</b> Classes Description </a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="submodel-structure.html"><a href="submodel-structure.html"><i class="fa fa-check"></i><b>7</b> Submodel structure </a>
<ul>
<li class="chapter" data-level="7.1" data-path="submodel-structure.html"><a href="submodel-structure.html#submodel-building-blocks-and-fundamental-r-formulas"><i class="fa fa-check"></i><b>7.1</b> Submodel building blocks and fundamental <code>R</code> formulas</a></li>
<li class="chapter" data-level="7.2" data-path="submodel-structure.html"><a href="submodel-structure.html#the-major-effects-available-for-modelling"><i class="fa fa-check"></i><b>7.2</b> The major effects available for modelling</a></li>
<li class="chapter" data-level="7.3" data-path="submodel-structure.html"><a href="submodel-structure.html#the-submodel-class-and-methods"><i class="fa fa-check"></i><b>7.3</b> The submodel class and methods</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="fitting.html"><a href="fitting.html"><i class="fa fa-check"></i><b>8</b> Fitting</a>
<ul>
<li class="chapter" data-level="8.1" data-path="fitting.html"><a href="fitting.html#fishing-mortality-submodel-f_ay"><i class="fa fa-check"></i><b>8.1</b> Fishing mortality submodel (<span class="math inline">\(F_{ay}\)</span>)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="fitting.html"><a href="fitting.html#separable-model"><i class="fa fa-check"></i><b>8.1.1</b> Separable model</a></li>
<li class="chapter" data-level="8.1.2" data-path="fitting.html"><a href="fitting.html#constant-selectivity-for-contiguous-ages-or-years"><i class="fa fa-check"></i><b>8.1.2</b> Constant selectivity for contiguous ages or years</a></li>
<li class="chapter" data-level="8.1.3" data-path="fitting.html"><a href="fitting.html#time-blocks-selectivity"><i class="fa fa-check"></i><b>8.1.3</b> Time blocks selectivity</a></li>
<li class="chapter" data-level="8.1.4" data-path="fitting.html"><a href="fitting.html#time-changing-selectivity"><i class="fa fa-check"></i><b>8.1.4</b> Time changing selectivity</a></li>
<li class="chapter" data-level="8.1.5" data-path="fitting.html"><a href="fitting.html#closed-form-selection-pattern"><i class="fa fa-check"></i><b>8.1.5</b> Closed form selection pattern</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="fitting.html"><a href="fitting.html#abundance-indices-catchability-submodel-q_ays"><i class="fa fa-check"></i><b>8.2</b> Abundance indices catchability submodel (<span class="math inline">\(Q_{ays}\)</span>)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-age-based-indices"><i class="fa fa-check"></i><b>8.2.1</b> Catchability submodel for age based indices</a></li>
<li class="chapter" data-level="8.2.2" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-age-aggregated-biomass-indices"><i class="fa fa-check"></i><b>8.2.2</b> Catchability submodel for age aggregated biomass indices</a></li>
<li class="chapter" data-level="8.2.3" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-single-age-indices"><i class="fa fa-check"></i><b>8.2.3</b> Catchability submodel for single age indices</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="fitting.html"><a href="fitting.html#stock-recruitment-submodel-r_y"><i class="fa fa-check"></i><b>8.3</b> Stock-recruitment submodel (<span class="math inline">\(R_y\)</span>)</a></li>
<li class="chapter" data-level="8.4" data-path="fitting.html"><a href="fitting.html#observation-variance-submodel-sigma2_ay-tau2_ays"><i class="fa fa-check"></i><b>8.4</b> Observation variance submodel (<span class="math inline">\(\{\sigma^2_{ay}, \tau^2_{ays}\}\)</span>)</a></li>
<li class="chapter" data-level="8.5" data-path="fitting.html"><a href="fitting.html#initial-year-abundance-submodel-n_ay1"><i class="fa fa-check"></i><b>8.5</b> Initial year abundance submodel (<span class="math inline">\(N_{a,y=1}\)</span>)</a></li>
<li class="chapter" data-level="8.6" data-path="fitting.html"><a href="fitting.html#more-models"><i class="fa fa-check"></i><b>8.6</b> More models</a></li>
<li class="chapter" data-level="8.7" data-path="fitting.html"><a href="fitting.html#data-weigthing"><i class="fa fa-check"></i><b>8.7</b> Data weigthing</a></li>
<li class="chapter" data-level="8.8" data-path="fitting.html"><a href="fitting.html#working-with-covariates"><i class="fa fa-check"></i><b>8.8</b> Working with covariates</a></li>
<li class="chapter" data-level="8.9" data-path="fitting.html"><a href="fitting.html#assessing-files"><i class="fa fa-check"></i><b>8.9</b> Assessing files</a></li>
<li class="chapter" data-level="8.10" data-path="fitting.html"><a href="fitting.html#missing-observations-in-the-catch-matrix-or-index"><i class="fa fa-check"></i><b>8.10</b> Missing observations in the catch matrix or index</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>9</b> Diagnostics </a>
<ul>
<li class="chapter" data-level="9.1" data-path="diagnostics.html"><a href="diagnostics.html#residuals"><i class="fa fa-check"></i><b>9.1</b> Residuals</a></li>
<li class="chapter" data-level="9.2" data-path="diagnostics.html"><a href="diagnostics.html#predictive-skill"><i class="fa fa-check"></i><b>9.2</b> Predictive skill</a></li>
<li class="chapter" data-level="9.3" data-path="diagnostics.html"><a href="diagnostics.html#aggreagted-catch-in-weight"><i class="fa fa-check"></i><b>9.3</b> Aggreagted catch in weight</a></li>
<li class="chapter" data-level="9.4" data-path="diagnostics.html"><a href="diagnostics.html#fit-summary-information-and-cross-validation-metrics"><i class="fa fa-check"></i><b>9.4</b> Fit summary, information and cross-validation metrics</a></li>
<li class="chapter" data-level="9.5" data-path="diagnostics.html"><a href="diagnostics.html#the-package-a4adiags"><i class="fa fa-check"></i><b>9.5</b> The package a4adiags</a></li>
<li class="chapter" data-level="9.6" data-path="diagnostics.html"><a href="diagnostics.html#retrospective-analysis"><i class="fa fa-check"></i><b>9.6</b> Retrospective analysis</a></li>
<li class="chapter" data-level="9.7" data-path="diagnostics.html"><a href="diagnostics.html#hindcast"><i class="fa fa-check"></i><b>9.7</b> Hindcast</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html"><i class="fa fa-check"></i><b>10</b> Predict and simulate </a>
<ul>
<li class="chapter" data-level="10.1" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#predict"><i class="fa fa-check"></i><b>10.1</b> predict()</a></li>
<li class="chapter" data-level="10.2" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#simulate"><i class="fa fa-check"></i><b>10.2</b> simulate()</a></li>
<li class="chapter" data-level="10.3" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#simulate-and-predict"><i class="fa fa-check"></i><b>10.3</b> simulate() and predict()</a></li>
<li class="chapter" data-level="10.4" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#details"><i class="fa fa-check"></i><b>10.4</b> Details</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>11</b> The statistical catch-at-age stock assessment framework with Markov Chain Monte Carlo (MCMC) </a>
<ul>
<li class="chapter" data-level="11.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#the-mcmc-method-for-sca"><i class="fa fa-check"></i><b>11.1</b> The MCMC method for <code>sca</code></a></li>
<li class="chapter" data-level="11.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#diagnostics-with-coda"><i class="fa fa-check"></i><b>11.2</b> Diagnostics with CODA</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#traceplots"><i class="fa fa-check"></i><b>11.2.1</b> Traceplots</a></li>
<li class="chapter" data-level="11.2.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#autocorrelation-and-crosscorrelation-analysis"><i class="fa fa-check"></i><b>11.2.2</b> Autocorrelation and crosscorrelation analysis</a></li>
<li class="chapter" data-level="11.2.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#geweke-diagnostic"><i class="fa fa-check"></i><b>11.2.3</b> Geweke diagnostic</a></li>
<li class="chapter" data-level="11.2.4" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#cumulative-means"><i class="fa fa-check"></i><b>11.2.4</b> Cumulative means</a></li>
<li class="chapter" data-level="11.2.5" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#distribution-density"><i class="fa fa-check"></i><b>11.2.5</b> Distribution density</a></li>
<li class="chapter" data-level="11.2.6" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#gelman-rubin-statistic"><i class="fa fa-check"></i><b>11.2.6</b> Gelman-Rubin statistic</a></li>
<li class="chapter" data-level="11.2.7" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#acceptance-rate"><i class="fa fa-check"></i><b>11.2.7</b> Acceptance rate</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#admbs-arguments-to-tune-the-mcmc-algorithm"><i class="fa fa-check"></i><b>11.3</b> <code>ADMB</code>’s arguments to tune the MCMC algorithm</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#thinning-rate"><i class="fa fa-check"></i><b>11.3.1</b> Thinning rate</a></li>
<li class="chapter" data-level="11.3.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcscale-and-mcnoscale"><i class="fa fa-check"></i><b>11.3.2</b> mcscale and mcnoscale</a></li>
<li class="chapter" data-level="11.3.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcprobe"><i class="fa fa-check"></i><b>11.3.3</b> mcprobe</a></li>
<li class="chapter" data-level="11.3.4" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcrb"><i class="fa fa-check"></i><b>11.3.4</b> mcrb</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html"><i class="fa fa-check"></i><b>12</b> Projections and harvest control rules</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#references"><i class="fa fa-check"></i><b>12.0.1</b> References:</a></li>
<li class="chapter" data-level="12.1" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#simple-workflow"><i class="fa fa-check"></i><b>12.1</b> Simple workflow</a></li>
<li class="chapter" data-level="12.2" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#initial-condition-assumptions-check-fwdwindow"><i class="fa fa-check"></i><b>12.2</b> Initial condition assumptions [CHECK fwdWindow]</a></li>
<li class="chapter" data-level="12.3" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#scenarios"><i class="fa fa-check"></i><b>12.3</b> Scenarios</a></li>
<li class="chapter" data-level="12.4" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#relative-scenarios"><i class="fa fa-check"></i><b>12.4</b> Relative scenarios</a></li>
<li class="chapter" data-level="12.5" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#limits"><i class="fa fa-check"></i><b>12.5</b> Limits</a></li>
<li class="chapter" data-level="12.6" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#harvest-control-rule"><i class="fa fa-check"></i><b>12.6</b> Harvest Control Rule</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="reference-points.html"><a href="reference-points.html"><i class="fa fa-check"></i><b>13</b> Reference Points</a>
<ul>
<li class="chapter" data-level="13.1" data-path="reference-points.html"><a href="reference-points.html#yield-per-recruit-reference-points"><i class="fa fa-check"></i><b>13.1</b> Yield per recruit reference points</a></li>
<li class="chapter" data-level="13.2" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-relationship-based-reference-points"><i class="fa fa-check"></i><b>13.2</b> Stock recruitment relationship based reference points</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-after-fitting-the-stock-assessment-model"><i class="fa fa-check"></i><b>13.2.1</b> Stock recruitment after fitting the stock assessment model</a></li>
<li class="chapter" data-level="13.2.2" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-during-fitting-the-stock-assessment-model"><i class="fa fa-check"></i><b>13.2.2</b> Stock recruitment during fitting the stock assessment model</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="reference-points.html"><a href="reference-points.html#economics-reference-points"><i class="fa fa-check"></i><b>13.3</b> Economics reference points</a></li>
<li class="chapter" data-level="13.4" data-path="reference-points.html"><a href="reference-points.html#computing-user-specific-reference-points"><i class="fa fa-check"></i><b>13.4</b> Computing user specific reference points</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="propagate-uncertainty-into-stock-assessment.html"><a href="propagate-uncertainty-into-stock-assessment.html"><i class="fa fa-check"></i><b>14</b> Propagate uncertainty into stock assessment</a></li>
<li class="chapter" data-level="15" data-path="modelling-fleet-selectivity.html"><a href="modelling-fleet-selectivity.html"><i class="fa fa-check"></i><b>15</b> Modelling fleet selectivity</a>
<ul>
<li class="chapter" data-level="15.1" data-path="modelling-fleet-selectivity.html"><a href="modelling-fleet-selectivity.html#modelling-fleets-with-different-proportions-of-the-catch-covariate"><i class="fa fa-check"></i><b>15.1</b> Modelling fleets with different proportions of the catch covariate</a></li>
<li class="chapter" data-level="15.2" data-path="modelling-fleet-selectivity.html"><a href="modelling-fleet-selectivity.html#modelling-f-with-mean-length-by-fleet"><i class="fa fa-check"></i><b>15.2</b> Modelling f with mean length by fleet</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="modelling-spatial-effects.html"><a href="modelling-spatial-effects.html"><i class="fa fa-check"></i><b>16</b> Modelling spatial effects</a></li>
<li class="chapter" data-level="17" data-path="sections-to-be-added.html"><a href="sections-to-be-added.html"><i class="fa fa-check"></i><b>17</b> Sections to be added!?</a></li>
<li class="chapter" data-level="18" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html"><i class="fa fa-check"></i><b>18</b> Annex - stock assessment workflow</a>
<ul>
<li class="chapter" data-level="18.1" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-mean-model"><i class="fa fa-check"></i><b>18.1</b> The “mean” model</a></li>
<li class="chapter" data-level="18.2" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-age-effects"><i class="fa fa-check"></i><b>18.2</b> The age effects</a></li>
<li class="chapter" data-level="18.3" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#year-effect-on-fishing-mortality"><i class="fa fa-check"></i><b>18.3</b> Year effect on fishing mortality</a></li>
<li class="chapter" data-level="18.4" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#year-effect-on-catchability"><i class="fa fa-check"></i><b>18.4</b> Year effect on catchability</a></li>
<li class="chapter" data-level="18.5" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-initial-year-population-abundance-model-aka-n1"><i class="fa fa-check"></i><b>18.5</b> The initial year population abundance model, aka N1</a></li>
<li class="chapter" data-level="18.6" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-stock-recruitment-submodel"><i class="fa fa-check"></i><b>18.6</b> The stock recruitment submodel</a></li>
<li class="chapter" data-level="18.7" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-variance-submodel"><i class="fa fa-check"></i><b>18.7</b> The variance submodel</a></li>
<li class="chapter" data-level="18.8" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#final-comments"><i class="fa fa-check"></i><b>18.8</b> Final comments</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fish stock assessment with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="annex---stock-assessment-workflow" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">18</span> Annex - stock assessment workflow<a href="annex---stock-assessment-workflow.html#annex---stock-assessment-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The following sections describes a potential workflow for fitting a <code>a4a</code> stock assessment model. The idea is to explore the age and year effects in isolation and adjust the model’s smoothness to model those effects.</p>
<p>The procedure is heavily supported by residuals’ analysis. In a well specified model residuals should show a random pattern, without any trend or very high values (outliers).</p>
<div id="the-mean-model" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> The “mean” model<a href="annex---stock-assessment-workflow.html#the-mean-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To start the analysis we’ll fit a “mean” model, where all submodels will be set to an overall average, by using the <span class="math inline">\(\sim 1\)</span> formula. This will be our reference model to see how adding age and year effects will show up in the diagnostic tools, in particular in the residuals.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="annex---stock-assessment-workflow.html#cb321-1" tabindex="-1"></a><span class="fu">library</span>(FLa4a)</span>
<span id="cb321-2"><a href="annex---stock-assessment-workflow.html#cb321-2" tabindex="-1"></a><span class="fu">data</span>(hke1567)</span>
<span id="cb321-3"><a href="annex---stock-assessment-workflow.html#cb321-3" tabindex="-1"></a><span class="fu">data</span>(hke1567.idx)</span>
<span id="cb321-4"><a href="annex---stock-assessment-workflow.html#cb321-4" tabindex="-1"></a>fit01 <span class="ot">&lt;-</span> <span class="fu">sca</span>(hke1567, hke1567.idx, <span class="at">fmod=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">qmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>), <span class="at">srmod=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">vmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>),  <span class="at">n1mod=</span><span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb321-5"><a href="annex---stock-assessment-workflow.html#cb321-5" tabindex="-1"></a>res01 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit01, hke1567, hke1567.idx)</span></code></pre></div>
<p>The common residuals plot clearly shows a time trend for each age (Figure <a href="annex---stock-assessment-workflow.html#fig:meanresbyage">18.2</a>) for both datasets. Furthermore, inspecting how catch ate age residuals are positioned across ages, by comparing the level of residuals for each age, one can see the pattern of lower than 0 residuals in age 0, reversing the signal for ages 1 and 2, close to 0 in ages 3 and 4, and again below 0 in age 5.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="annex---stock-assessment-workflow.html#cb322-1" tabindex="-1"></a><span class="fu">plot</span>(res01)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:meanresbyyear"></span>
<img src="_main_files/figure-html/meanresbyyear-1.png" alt="Mean fit residuals by year)" width="672" />
<p class="caption">
Figure 18.1: Mean fit residuals by year)
</p>
</div>
<p>This pattern becomes more apparent when plotting the residuals by age across years.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="annex---stock-assessment-workflow.html#cb323-1" tabindex="-1"></a><span class="fu">plot</span>(res01, <span class="at">auxline=</span><span class="st">&quot;l&quot;</span>, <span class="at">by=</span><span class="st">&quot;age&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:meanresbyage"></span>
<img src="_main_files/figure-html/meanresbyage-1.png" alt="Mean fit residuals by age" width="25cm" height="18cm" angle=90 />
<p class="caption">
Figure 18.2: Mean fit residuals by age
</p>
</div>
</div>
<div id="the-age-effects" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> The age effects<a href="annex---stock-assessment-workflow.html#the-age-effects" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following models will introduce age effects in the fishing mortality submodel and catchability submodel. In the fishing mortality submodel we’ll introduce a <code>factor</code> which means that there will be as many parameters as ages minus 1 and each parameters will be independent of each other.</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="annex---stock-assessment-workflow.html#cb324-1" tabindex="-1"></a>fit02 <span class="ot">&lt;-</span> <span class="fu">sca</span>(hke1567, hke1567.idx, <span class="at">fmod=</span><span class="sc">~</span><span class="fu">factor</span>(age), <span class="at">qmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>), <span class="at">srmod=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">vmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>),  <span class="at">n1mod=</span><span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb324-2"><a href="annex---stock-assessment-workflow.html#cb324-2" tabindex="-1"></a>res02 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit02, hke1567, hke1567.idx)</span></code></pre></div>
<p>The residuals plot now shows catch at age residuals less stagered, reflecting the modelling of the age effect.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="annex---stock-assessment-workflow.html#cb325-1" tabindex="-1"></a><span class="fu">plot</span>(res02)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fageresbyyear"></span>
<img src="_main_files/figure-html/fageresbyyear-1.png" alt="Fishing mortality model with age effect residuals by year" width="672" />
<p class="caption">
Figure 18.3: Fishing mortality model with age effect residuals by year
</p>
</div>
<p>The residuals plot by age shows the same outcome.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="annex---stock-assessment-workflow.html#cb326-1" tabindex="-1"></a><span class="fu">plot</span>(res02, <span class="at">auxline=</span><span class="st">&quot;l&quot;</span>, <span class="at">by=</span><span class="st">&quot;age&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fageresbyage"></span>
<img src="_main_files/figure-html/fageresbyage-1.png" alt="Fishing mortality model with age effect residuals by age" width="672" />
<p class="caption">
Figure 18.4: Fishing mortality model with age effect residuals by age
</p>
</div>
<p>We’ll now proceed adding an age effect to the catchability model while removing the catch at age effect.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="annex---stock-assessment-workflow.html#cb327-1" tabindex="-1"></a>fit03 <span class="ot">&lt;-</span> <span class="fu">sca</span>(hke1567, hke1567.idx, <span class="at">fmod=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">qmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="fu">factor</span>(age)), <span class="at">srmod=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">vmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>),  <span class="at">n1mod=</span><span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb327-2"><a href="annex---stock-assessment-workflow.html#cb327-2" tabindex="-1"></a>res03 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit03, hke1567, hke1567.idx)</span></code></pre></div>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="annex---stock-assessment-workflow.html#cb328-1" tabindex="-1"></a><span class="fu">plot</span>(res03)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:qageresbyyear"></span>
<img src="_main_files/figure-html/qageresbyyear-1.png" alt="Index catchability model with age effect residuals by year" width="672" />
<p class="caption">
Figure 18.5: Index catchability model with age effect residuals by year
</p>
</div>
<p>The residuals plot by age shows the same outcome.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="annex---stock-assessment-workflow.html#cb329-1" tabindex="-1"></a><span class="fu">plot</span>(res03, <span class="at">auxline=</span><span class="st">&quot;l&quot;</span>, <span class="at">by=</span><span class="st">&quot;age&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:qageresbyage"></span>
<img src="_main_files/figure-html/qageresbyage-1.png" alt="Index catchability model with age effect residuals by age" width="672" />
<p class="caption">
Figure 18.6: Index catchability model with age effect residuals by age
</p>
</div>
<p>Finally both effects are brought together.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="annex---stock-assessment-workflow.html#cb330-1" tabindex="-1"></a>fit04 <span class="ot">&lt;-</span> <span class="fu">sca</span>(hke1567, hke1567.idx, <span class="at">fmod=</span><span class="sc">~</span><span class="fu">factor</span>(age), <span class="at">qmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="fu">factor</span>(age)), <span class="at">srmod=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">vmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>),  <span class="at">n1mod=</span><span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb330-2"><a href="annex---stock-assessment-workflow.html#cb330-2" tabindex="-1"></a>res04 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit04, hke1567, hke1567.idx)</span></code></pre></div>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="annex---stock-assessment-workflow.html#cb331-1" tabindex="-1"></a><span class="fu">plot</span>(res04)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fqageresbyyear"></span>
<img src="_main_files/figure-html/fqageresbyyear-1.png" alt="Fishing mortality and index catchability models with age effect residuals by year" width="672" />
<p class="caption">
Figure 18.7: Fishing mortality and index catchability models with age effect residuals by year
</p>
</div>
<p>The residuals plot by age shows the same outcome.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="annex---stock-assessment-workflow.html#cb332-1" tabindex="-1"></a><span class="fu">plot</span>(res04, <span class="at">auxline=</span><span class="st">&quot;l&quot;</span>, <span class="at">by=</span><span class="st">&quot;age&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fqageresbyage"></span>
<img src="_main_files/figure-html/fqageresbyage-1.png" alt="Fishing mortality and index catchability models with age effect residuals by age" width="672" />
<p class="caption">
Figure 18.8: Fishing mortality and index catchability models with age effect residuals by age
</p>
</div>
</div>
<div id="year-effect-on-fishing-mortality" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> Year effect on fishing mortality<a href="annex---stock-assessment-workflow.html#year-effect-on-fishing-mortality" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This model will introduce an year effect in the fishing mortality submodel on top of the F age effect added before. Inspecting the last set of residuals (Figure <a href="annex---stock-assessment-workflow.html#fig:fqageresbyage">18.8</a>) one can easily see the pattern across years with more positive residuals in the beggining of the time series and more negative in the most recent years. As for age we’re using a <code>factor</code> for years. The new model’s residuals won’t show such a pronounced effect anymore (Figures <a href="annex---stock-assessment-workflow.html#fig:fyearresbyyear">18.9</a> and <a href="annex---stock-assessment-workflow.html#fig:fyearresbyage">18.10</a>).</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="annex---stock-assessment-workflow.html#cb333-1" tabindex="-1"></a>fit05 <span class="ot">&lt;-</span> <span class="fu">sca</span>(hke1567, hke1567.idx, <span class="at">fmod=</span><span class="sc">~</span><span class="fu">factor</span>(age) <span class="sc">+</span> <span class="fu">factor</span>(year), <span class="at">qmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>), <span class="at">srmod=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">vmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>),  <span class="at">n1mod=</span><span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb333-2"><a href="annex---stock-assessment-workflow.html#cb333-2" tabindex="-1"></a>res05 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit05, hke1567, hke1567.idx)</span></code></pre></div>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="annex---stock-assessment-workflow.html#cb334-1" tabindex="-1"></a><span class="fu">plot</span>(res05)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fyearresbyyear"></span>
<img src="_main_files/figure-html/fyearresbyyear-1.png" alt="Fishing mortality model with year effect residuals by year" width="672" />
<p class="caption">
Figure 18.9: Fishing mortality model with year effect residuals by year
</p>
</div>
<p>The residuals plot by age shows the same outcome.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="annex---stock-assessment-workflow.html#cb335-1" tabindex="-1"></a><span class="fu">plot</span>(res05, <span class="at">auxline=</span><span class="st">&quot;l&quot;</span>, <span class="at">by=</span><span class="st">&quot;age&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fyearresbyage"></span>
<img src="_main_files/figure-html/fyearresbyage-1.png" alt="Fishing mortality model with year effect residuals by age" width="672" />
<p class="caption">
Figure 18.10: Fishing mortality model with year effect residuals by age
</p>
</div>
<p>We can see now that the residuals show a lot less patterns than before. There’s still some issues, the survey catchability seems to have an year trend. However the model is not fully specified yet, stock recruitment is modelled as constant over time, the initial population abundance is also modelled as a constant as well as the variance models.</p>
</div>
<div id="year-effect-on-catchability" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> Year effect on catchability<a href="annex---stock-assessment-workflow.html#year-effect-on-catchability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It’s uncommon to include year trends on the abundance index catchability model. Such decision needs to be considered carefully as the trend in the index, in the case of a well design scientific survey, should result from a change in abundance. Modelling that trend would attribute such change to the survey design and remove it from the abundance. If the survey index is based on a commercial CPUE it becomes more likely that changes in selectivity or fishing behaviour could show up in the index as changes in abundance. Although the common process of standardizing CPUEs should deal with technical issues.</p>
<p>In the case of adding year effects to teh catchability submode the same formulas can be used, to include period breaks, trends, etc.</p>
</div>
<div id="the-initial-year-population-abundance-model-aka-n1" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> The initial year population abundance model, aka N1<a href="annex---stock-assessment-workflow.html#the-initial-year-population-abundance-model-aka-n1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This model sets the n-at-age in the first year of the time series, which is needed due to the lack of previous data to reconstruct those cohorts. It will affect the population numbers in the lower triangle of the initial population matrix and catches.</p>
<p>The following model will introduce an age effect in the population abundance in the first year of the time series.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="annex---stock-assessment-workflow.html#cb336-1" tabindex="-1"></a>fit06 <span class="ot">&lt;-</span> <span class="fu">sca</span>(hke1567, hke1567.idx, <span class="at">fmod=</span><span class="sc">~</span><span class="fu">factor</span>(age) <span class="sc">+</span> <span class="fu">factor</span>(year), <span class="at">qmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="fu">factor</span>(age)), <span class="at">srmod=</span><span class="sc">~</span><span class="dv">1</span>, <span class="at">vmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>),  <span class="at">n1mod=</span><span class="sc">~</span><span class="fu">factor</span>(age))</span>
<span id="cb336-2"><a href="annex---stock-assessment-workflow.html#cb336-2" tabindex="-1"></a>res06 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit06, hke1567, hke1567.idx)</span></code></pre></div>
<p>The best way to inspect the effect of this model is to zoom into the initial years of the time series.</p>
<p>Figure <a href="annex---stock-assessment-workflow.html#fig:n1resbyage05">18.11</a> zooms into the previous model, which used an intercept only model for N1, while Figure <a href="annex---stock-assessment-workflow.html#fig:n1resbyage06">18.12</a>.</p>
<div class="figure"><span style="display:block;" id="fig:n1resbyage05"></span>
<img src="_main_files/figure-html/n1resbyage05-1.png" alt="N1 fitted as an intercept only model: 2007 - 2010 residuals by age" width="672" />
<p class="caption">
Figure 18.11: N1 fitted as an intercept only model: 2007 - 2010 residuals by age
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:n1resbyage06"></span>
<img src="_main_files/figure-html/n1resbyage06-1.png" alt="N1 fitted with an age effect model: 2007 - 2010 residuals by age" width="672" />
<p class="caption">
Figure 18.12: N1 fitted with an age effect model: 2007 - 2010 residuals by age
</p>
</div>
<p>Comparing the two plots it can be seen the effect of modeling abundance in the initial year. Residuals for both catch at age and catchability improved considerably. The following years also improve to different levels.</p>
</div>
<div id="the-stock-recruitment-submodel" class="section level2 hasAnchor" number="18.6">
<h2><span class="header-section-number">18.6</span> The stock recruitment submodel<a href="annex---stock-assessment-workflow.html#the-stock-recruitment-submodel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this example we’ll simply add a model to allow recruitment to vary over time and we’ll see how to track potential improvements in the residuals.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="annex---stock-assessment-workflow.html#cb337-1" tabindex="-1"></a>fit07 <span class="ot">&lt;-</span> <span class="fu">sca</span>(hke1567, hke1567.idx, <span class="at">fmod=</span><span class="sc">~</span><span class="fu">factor</span>(age) <span class="sc">+</span> <span class="fu">factor</span>(year), <span class="at">qmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="fu">factor</span>(age)), <span class="at">srmod=</span><span class="sc">~</span><span class="fu">factor</span>(year), <span class="at">vmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="dv">1</span>, <span class="sc">~</span><span class="dv">1</span>),  <span class="at">n1mod=</span><span class="sc">~</span><span class="fu">factor</span>(age))</span>
<span id="cb337-2"><a href="annex---stock-assessment-workflow.html#cb337-2" tabindex="-1"></a>res07 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit07, hke1567, hke1567.idx)</span></code></pre></div>
<p>The residuals plot by year are very useful to see the effect of adding a varying stock recruitment model. The year trends present in previous models are not absent. Recruitment variability when left unmodelled was being picked up by trends in the survey catchability and catch at age. And due to the cohort dynamics underlying the catch at age model, where propagating into other ages’ estimates.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="annex---stock-assessment-workflow.html#cb338-1" tabindex="-1"></a><span class="fu">plot</span>(res07)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:srresbyyear"></span>
<img src="_main_files/figure-html/srresbyyear-1.png" alt="Stock-recruitment model with year effect residuals by year" width="672" />
<p class="caption">
Figure 18.13: Stock-recruitment model with year effect residuals by year
</p>
</div>
</div>
<div id="the-variance-submodel" class="section level2 hasAnchor" number="18.7">
<h2><span class="header-section-number">18.7</span> The variance submodel<a href="annex---stock-assessment-workflow.html#the-variance-submodel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, we’re testing the variance submodel, specifically the catch at age variance model. We won’t dig into the catchability variance model though. It’s common to accept that a scientific survey following a well designed sampling protocol will have equal variance across ages since no preferential areas should be sampled sampled.</p>
<p>The variance model will use a smoother with <code>k=3</code>. The expectation is that the variance model will have a U-shape, since yourger and older ages are usually less caught and as such estomates of those ages will have larger variances than fully exploited ages.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="annex---stock-assessment-workflow.html#cb339-1" tabindex="-1"></a>fit08 <span class="ot">&lt;-</span> <span class="fu">sca</span>(hke1567, hke1567.idx, <span class="at">fmod=</span><span class="sc">~</span><span class="fu">factor</span>(age) <span class="sc">+</span> <span class="fu">s</span>(year, <span class="at">k=</span><span class="dv">10</span>), <span class="at">qmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="fu">factor</span>(age)), <span class="at">srmod=</span><span class="sc">~</span><span class="fu">s</span>(year, <span class="at">k=</span><span class="dv">10</span>), <span class="at">vmod=</span><span class="fu">list</span>(<span class="sc">~</span><span class="fu">s</span>(age, <span class="at">k=</span><span class="dv">3</span>), <span class="sc">~</span><span class="dv">1</span>),  <span class="at">n1mod=</span><span class="sc">~</span><span class="fu">factor</span>(age))</span></code></pre></div>
<p>We’ll use the pearson residuals for this analysis since those are standardized by the predicted variances of the model and not the residual variance itself, like the more common standardized residuals. Figure <a href="annex---stock-assessment-workflow.html#fig:vresbyyear08">18.15</a> shows an improve set of residuals when compared to Figure <a href="annex---stock-assessment-workflow.html#fig:vresbyyear07">18.14</a> which add an intercept only model for the variance model.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="annex---stock-assessment-workflow.html#cb340-1" tabindex="-1"></a>res07 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit07, hke1567, hke1567.idx, <span class="at">type=</span><span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb340-2"><a href="annex---stock-assessment-workflow.html#cb340-2" tabindex="-1"></a>res08 <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit08, hke1567, hke1567.idx, <span class="at">type=</span><span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="annex---stock-assessment-workflow.html#cb341-1" tabindex="-1"></a><span class="fu">plot</span>(res07)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:vresbyyear07"></span>
<img src="_main_files/figure-html/vresbyyear07-1.png" alt="Variance model with intercept only age effect pearson residuals" width="672" />
<p class="caption">
Figure 18.14: Variance model with intercept only age effect pearson residuals
</p>
</div>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="annex---stock-assessment-workflow.html#cb342-1" tabindex="-1"></a><span class="fu">plot</span>(res08)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:vresbyyear08"></span>
<img src="_main_files/figure-html/vresbyyear08-1.png" alt="Variance model with age effect pearson residuals" width="672" />
<p class="caption">
Figure 18.15: Variance model with age effect pearson residuals
</p>
</div>
<p>To see what’s happening with the variance model one can use predict to plot the different models fitted.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="annex---stock-assessment-workflow.html#cb343-1" tabindex="-1"></a>flqs <span class="ot">&lt;-</span> <span class="fu">FLQuants</span>(<span class="at">mod08=</span><span class="fu">predict</span>(fit08)<span class="sc">$</span>vmodel<span class="sc">$</span>catch[,<span class="st">&quot;2022&quot;</span>], <span class="at">mod07=</span><span class="fu">predict</span>(fit07)<span class="sc">$</span>vmodel<span class="sc">$</span>catch[,<span class="st">&quot;2022&quot;</span>])</span>
<span id="cb343-2"><a href="annex---stock-assessment-workflow.html#cb343-2" tabindex="-1"></a><span class="fu">xyplot</span>(data<span class="sc">~</span>age, <span class="at">data=</span>flqs, <span class="at">group=</span>qname, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">auto.key=</span>T)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:vagepredbyage"></span>
<img src="_main_files/figure-html/vagepredbyage-1.png" alt="Variance models for catch at age" width="672" />
<p class="caption">
Figure 18.16: Variance models for catch at age
</p>
</div>
<p>To see the effect these models have on the estimated quantities one can look at the variance of the estimates:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="annex---stock-assessment-workflow.html#cb344-1" tabindex="-1"></a>flqs <span class="ot">&lt;-</span> <span class="fu">FLQuants</span>(<span class="at">mod08=</span><span class="fu">catch.n</span>(hke1567<span class="sc">+</span><span class="fu">simulate</span>(fit08, <span class="at">nsim=</span><span class="dv">500</span>))[,<span class="st">&quot;2022&quot;</span>], <span class="at">mod07=</span><span class="fu">catch.n</span>(hke1567<span class="sc">+</span><span class="fu">simulate</span>(fit07, <span class="at">nsim=</span><span class="dv">500</span>))[,<span class="st">&quot;2022&quot;</span>])</span>
<span id="cb344-2"><a href="annex---stock-assessment-workflow.html#cb344-2" tabindex="-1"></a><span class="fu">bwplot</span>(data<span class="sc">~</span>qname<span class="sc">|</span><span class="fu">factor</span>(age),  <span class="at">data=</span><span class="fu">as.data.frame</span>(flqs), <span class="at">scales=</span><span class="st">&quot;free&quot;</span>, <span class="at">auto.key=</span>T)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:vage"></span>
<img src="_main_files/figure-html/vage-1.png" alt="Estimates of population abundance with different variance models" width="672" />
<p class="caption">
Figure 18.17: Estimates of population abundance with different variance models
</p>
</div>
</div>
<div id="final-comments" class="section level2 hasAnchor" number="18.8">
<h2><span class="header-section-number">18.8</span> Final comments<a href="annex---stock-assessment-workflow.html#final-comments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The sequence presented here can be changed and eploited in any order the user is interested or prefers to.</p>
<p>The approach of not allowing year effects in surveys and variance model can be modified if the user prefers to do so.</p>
<p>The (ab)use of <code>factor</code> is for demonstration purposes only. The user is incentivised to explore other model forms, in particular smoothers.</p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Chambers, J. M., and T. J. Hastie. 1991. <em>Statistical Models in s</em>. Taylor &amp; Francis. <a href="https://books.google.be/books?id=IBkLQAAACAAJ">https://books.google.be/books?id=IBkLQAAACAAJ</a>.
</div>
<div class="csl-entry">
Fournier, David A., Hans J. Skaug, Johnoel Ancheta, James Ianelli, Arni Magnusson, Mark N. Maunder, Anders Nielsen, and John Sibert. 2012. <span>“A<span>D</span> Model Builder: Using Automatic Differentiation for Statistical Inference of Highly Parameterized Complex Nonlinear Models.”</span> <em>Optim. Methods Softw.</em> 27 (2): 233–49. <a href="https://doi.org/10.1080/10556788.2011.597854">https://doi.org/10.1080/10556788.2011.597854</a>.
</div>
<div class="csl-entry">
Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D. B. Rubin. 2013. <em>Bayesian Data Analysis, Third Edition</em>. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis. <a href="https://books.google.be/books?id=ZXL6AQAAQBAJ">https://books.google.be/books?id=ZXL6AQAAQBAJ</a>.
</div>
<div class="csl-entry">
Gelman, Andrew, and Donald B Rubin. 1992. <span>“Inference from Iterative Simulation Using Multiple Sequences.”</span> <em>Statistical Science</em> 7 (4): 457–72.
</div>
<div class="csl-entry">
Geweke, John. 1992. <span>“Evaluating the Accuracy of Sampling-Based Approaches to the Calculation of Posterior Moments.”</span> In <em>Bayesian Statistics, 4 (<span>P</span>eñíscola, 1991)</em>, 169–93. Oxford Univ. Press, New York.
</div>
<div class="csl-entry">
Gilks, W. R., S. Richardson, and D. Spiegelhalter. 1995. <em>Markov Chain Monte Carlo in Practice</em>. Chapman &amp; Hall/CRC Interdisciplinary Statistics. Taylor &amp; Francis. <a href="https://books.google.be/books?id=TRXrMWY_i2IC">https://books.google.be/books?id=TRXrMWY_i2IC</a>.
</div>
<div class="csl-entry">
Hamel, Owen S., James N. Ianelli, Mark N. Maunder, and André E. Punt. 2023. <span>“Natural Mortality: Theory, Estimation and Application in Fishery Stock Assessment Models.”</span> <em>Fisheries Research</em> 261 (May): 106638. <a href="https://doi.org/10.1016/j.fishres.2023.106638">https://doi.org/10.1016/j.fishres.2023.106638</a>.
</div>
<div class="csl-entry">
Hastie, T. J., and R. J. Tibshirani. 1990. <em>Generalized Additive Models</em>. Chapman &amp; Hall/CRC Monographs on Statistics &amp; Applied Probability. Taylor &amp; Francis. <a href="https://books.google.be/books?id=qa29r1Ze1coC">https://books.google.be/books?id=qa29r1Ze1coC</a>.
</div>
<div class="csl-entry">
Hilborn, Ray. 2010. <span>“Pretty Good Yield and Exploited Fishes.”</span> <em>Marine Policy</em> 34 (1): 193–96. https://doi.org/<a href="https://doi.org/10.1016/j.marpol.2009.04.013">https://doi.org/10.1016/j.marpol.2009.04.013</a>.
</div>
<div class="csl-entry">
Hilborn, Ray, and Carl J Walters. 2013. <em>Quantitative Fisheries Stock Assessment: Choice, Dynamics and Uncertainty</em>. Springer Science &amp; Business Media.
</div>
<div class="csl-entry">
Jacobsen, Nis Sand, and Timothy E. Essington. 2018. <span>“Natural Mortality Augments Population Fluctuations of Forage Fish.”</span> <em>Fish and Fisheries</em> 19 (5): 791–97. <a href="https://doi.org/10.1111/FAF.12290">https://doi.org/10.1111/FAF.12290</a>.
</div>
<div class="csl-entry">
Jardim, Ernesto, Colin P. Millar, Iago Mosqueira, Finlay Scott, Giacomo Chato Osio, Marco Ferretti, Nekane Alzorriz, and Alessandro Orio. 2014. <span>“Food for Thought What If Stock Assessment Is as Simple as a Linear Model? The A4a Initiative,”</span> January.
</div>
<div class="csl-entry">
López Quintero, Freddy Omar, Javier E. Contreras-Reyes, and Rodrigo Wiff. 2017. <span>“Incorporating Uncertainty into a Length-Based Estimator of Natural Mortality in Fish Populations.”</span> <em>Fishery Bulletin</em> 115 (3): 355–64. <a href="https://doi.org/10.7755/FB.115.3.6">https://doi.org/10.7755/FB.115.3.6</a>.
</div>
<div class="csl-entry">
Maceina, Michael J., and Steven M. Sammons. 2016. <span>“Assessing the Accuracy of Published Natural Mortality Estimators Using Rates Determined from Five Unexploited Freshwater Fish Populations.”</span> <em>North American Journal of Fisheries Management</em> 36 (2): 433–46. <a href="https://doi.org/10.1080/02755947.2015.1129002">https://doi.org/10.1080/02755947.2015.1129002</a>.
</div>
<div class="csl-entry">
Millar, Colin P., Ernesto Jardim, Finlay Scott, Giacomo Chato Osio, Iago Mosqueira, and Nekane Alzorriz. 2014. <span>“Model Averaging to Streamline the Stock Assessment Process.”</span> <em>ICES Journal of Marine Science</em> 72 (1): 93–98. <a href="https://doi.org/10.1093/icesjms/fsu043">https://doi.org/10.1093/icesjms/fsu043</a>.
</div>
<div class="csl-entry">
Monnahan, Cole C, Trevor A Branch, James T Thorson, Ian J Stewart, and Cody S Szuwalski. 2019. <span>“Overcoming Long <span>Bayesian</span> Run Times in Integrated Fisheries Stock Assessments.”</span> Edited by Shijie Zhou. <em>ICES Journal of Marine Science</em> 76 (6): 1477–88. <a href="https://doi.org/10.1093/icesjms/fsz059">https://doi.org/10.1093/icesjms/fsz059</a>.
</div>
<div class="csl-entry">
Neal, Radford M. 1993. <span>“Probabilistic Inference Using Markov Chain Monte Carlo Methods.”</span>
</div>
<div class="csl-entry">
Nelder, John A. 1965. <span>“The Analysis of Randomized Experiments with Orthogonal Block Structure. I. Block Structure and the Null Analysis of Variance.”</span> <em>Proceedings of The Royal Society A: Mathematical, Physical and Engineering Sciences</em> 283 (1393): 147–62. <a href="https://doi.org/10.1098/RSPA.1965.0012">https://doi.org/10.1098/RSPA.1965.0012</a>.
</div>
<div class="csl-entry">
OECD. 2009. <span>“OECD Economic Outlook.”</span> https://doi.org/<a href="https://doi.org/10.1787/eco_outlook-v2009-1-en">https://doi.org/10.1787/eco_outlook-v2009-1-en</a>.
</div>
<div class="csl-entry">
Pawitan, Yudi. 2001. <em>In All Likelihood: Statistical Modelling and Inference Using Likelihood</em>. Oxford University Press. <a href="https://doi.org/10.1093/oso/9780198507659.001.0001">https://doi.org/10.1093/oso/9780198507659.001.0001</a>.
</div>
<div class="csl-entry">
Punt, André E, Anthony DM Smith, and Gurong Cui. 2001. <span>“Review of Progress in the Introduction of Management Strategy Evaluation (MSE) Approaches in Australia’s South East Fishery.”</span> <em>Marine and Freshwater Research</em> 52 (4): 719–26.
</div>
<div class="csl-entry">
Rindorf, Anna, Catherine Mary Dichmont, Phillip S. Levin, Pamela Mace, Sean Pascoe, Raul Prellezo, André E. Punt, et al. 2016. <span>“Food for Thought: Pretty Good Multispecies Yield.”</span> <em>ICES Journal of Marine Science</em> 74 (2): 475–86. <a href="https://doi.org/10.1093/icesjms/fsw071">https://doi.org/10.1093/icesjms/fsw071</a>.
</div>
<div class="csl-entry">
Robert, C., and G. Casella. 2005. <em>Monte Carlo Statistical Methods</em>. Springer Texts in Statistics. Springer New York. <a href="https://books.google.be/books?id=HfhGAxn5GugC">https://books.google.be/books?id=HfhGAxn5GugC</a>.
</div>
<div class="csl-entry">
Robertson, Matthew D., Paul M. Regular, and Noel G. Cadigan. 2022. <span>“Limited Temporal Variability in Natural Mortality for Juvenile American Plaice on the Grand Bank of Newfoundland.”</span> <em>Journal of Northwest Atlantic Fishery Science</em> 53 (September): 47–56. <a href="https://doi.org/10.2960/j.v53.m738">https://doi.org/10.2960/j.v53.m738</a>.
</div>
<div class="csl-entry">
Scott, Finlay, Ernesto Jardim, Colin P Millar, and Santiago Cerviño. 2016. <span>“An Applied Framework for Incorporating Multiple Sources of Uncertainty in Fisheries Stock Assessments.”</span> <em>PLoS One</em> 11 (5): e0154922.
</div>
<div class="csl-entry">
Vaart, A. W. van der. 1998. <em>Asymptotic Statistics</em>. Vol. 3. Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge University Press, Cambridge. <a href="https://doi.org/10.1017/CBO9780511802256">https://doi.org/10.1017/CBO9780511802256</a>.
</div>
<div class="csl-entry">
Wasserman, Larry. 2004. <em>All of Statistics</em>. Springer Texts in Statistics. Springer-Verlag, New York. <a href="https://doi.org/10.1007/978-0-387-21736-9">https://doi.org/10.1007/978-0-387-21736-9</a>.
</div>
<div class="csl-entry">
White, Halbert. 1982. <span>“Maximum Likelihood Estimation of Misspecified Models.”</span> <em>Econometrica</em> 50 (1): 1–25. <a href="https://doi.org/10.2307/1912526">https://doi.org/10.2307/1912526</a>.
</div>
<div class="csl-entry">
Wilkinson, Graham N., and C. E. Rogers. 1973. <span>“Symbolic Description of Factorial Models for Analysis of Variance.”</span> <em>Applied Statistics</em> 22: 392–99. <a href="https://api.semanticscholar.org/CorpusID:118281143">https://api.semanticscholar.org/CorpusID:118281143</a>.
</div>
</div>
</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="sections-to-be-added.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/30-annexworkflow.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
