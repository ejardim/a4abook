# Modelling fleet selectivity

## Modelling fleets with different proportions of the catch covariate

cp1 <- cp2 <- catch.n(ple4)
pa <- c(0.2, 0.3, 0.5, 0.5, 0.6, 0.7, 0.6, 0.6, 0.6, 0.6)
na <- nrow(cp1)
for(i in 1:na) cp1[i][] <- mean(rbinom(100, 1, pa[i]))
for(i in 1:na) cp2[i][] <- mean(rbinom(100, 1, 1-pa[i]))
cp2 <- 1-cp1

fmod <- ~s(year, k=20) + s(age, k=3, by=cp1) + s(age, k=5, by=cp2)
fit <- sca(ple4, ple4.indices, fmodel=fmod, covar=FLQuants(cp1=cp1, cp2=cp2))

fmod <- ~s(year, k=20) + s(age, k=5)
fit0 <- sca(ple4, ple4.indices, fmodel=fmod)

plot(FLStocks(f1=ple4+fit, f0=ple4+fit0))

