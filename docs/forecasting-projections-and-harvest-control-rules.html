<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Forecasting, projections and harvest control rules | Fish stock assessment with R</title>
  <meta name="description" content="How to do stock assessment in R using the a4a framework" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Forecasting, projections and harvest control rules | Fish stock assessment with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="How to do stock assessment in R using the a4a framework" />
  <meta name="github-repo" content="ejardim/a4abook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Forecasting, projections and harvest control rules | Fish stock assessment with R" />
  
  <meta name="twitter:description" content="How to do stock assessment in R using the a4a framework" />
  

<meta name="author" content="John Doe and friends" />


<meta name="date" content="2024-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reference-points.html"/>
<link rel="next" href="sections-to-be-added.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stock assessment framework</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> cover-image: path to the social sharing image like images/cover.jpg</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#license-documentation-and-development-status"><i class="fa fa-check"></i><b>1.1</b> License, documentation and development status</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installing-and-loading-libraries"><i class="fa fa-check"></i><b>1.2</b> Installing and loading libraries</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#how-to-read-this-document"><i class="fa fa-check"></i><b>1.3</b> How to read this document</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#how-to-get-help"><i class="fa fa-check"></i><b>1.4</b> How to get help</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#notation"><i class="fa fa-check"></i><b>1.5</b> Notation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><i class="fa fa-check"></i><b>3</b> Modelling Individual Growth and Using Stochastic Slicing to Convert Length-based Data Into Age-based Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#background"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#a4agr---the-growth-class"><i class="fa fa-check"></i><b>3.2</b> a4aGr - The growth class</a></li>
<li class="chapter" data-level="3.3" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>3.3</b> Adding uncertainty to growth parameters with a multivariate normal distribution}</a></li>
<li class="chapter" data-level="3.4" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-triangle-distribution"><i class="fa fa-check"></i><b>3.4</b> Adding uncertainty to growth parameters with a multivariate triangle distribution}</a></li>
<li class="chapter" data-level="3.5" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#adding-uncertainty-to-growth-parameters-with-statistical-copulas"><i class="fa fa-check"></i><b>3.5</b> Adding uncertainty to growth parameters with statistical copulas}</a></li>
<li class="chapter" data-level="3.6" data-path="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html"><a href="modelling-individual-growth-and-using-stochastic-slicing-to-convert-length-based-data-into-age-based-data.html#converting-from-length-to-age-based-data---the-l2a-method"><i class="fa fa-check"></i><b>3.6</b> Converting from length to age based data - the <code>l2a()</code> method}</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="natural-mortality-modelling.html"><a href="natural-mortality-modelling.html"><i class="fa fa-check"></i><b>4</b> Natural Mortality Modelling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="natural-mortality-modelling.html"><a href="natural-mortality-modelling.html#background-1"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="natural-mortality-modelling.html"><a href="natural-mortality-modelling.html#a4am---the-m-class"><i class="fa fa-check"></i><b>4.2</b> <code>a4aM</code> - The M class</a></li>
<li class="chapter" data-level="4.3" data-path="natural-mortality-modelling.html"><a href="natural-mortality-modelling.html#adding-uncertainty-to-natural-mortality-parameters-with-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>4.3</b> Adding uncertainty to natural mortality parameters with a multivariate normal distribution</a></li>
<li class="chapter" data-level="4.4" data-path="natural-mortality-modelling.html"><a href="natural-mortality-modelling.html#adding-uncertainty-to-natural-mortality-parameters-with-statistical-copulas"><i class="fa fa-check"></i><b>4.4</b> Adding uncertainty to natural mortality parameters with statistical copulas</a></li>
<li class="chapter" data-level="4.5" data-path="natural-mortality-modelling.html"><a href="natural-mortality-modelling.html#computing-natural-mortality-time-series---the-m-method"><i class="fa fa-check"></i><b>4.5</b> Computing natural mortality time series - the “m” method</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html"><i class="fa fa-check"></i><b>5</b> Stock assessment framework</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#maths-description"><i class="fa fa-check"></i><b>5.1</b> Maths description </a></li>
<li class="chapter" data-level="5.2" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#classes-description"><i class="fa fa-check"></i><b>5.2</b> Classes description </a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="submodel-structure.html"><a href="submodel-structure.html"><i class="fa fa-check"></i><b>6</b> Submodel structure </a>
<ul>
<li class="chapter" data-level="6.1" data-path="submodel-structure.html"><a href="submodel-structure.html#submodel-building-blocks-and-fundamental-r-formulas"><i class="fa fa-check"></i><b>6.1</b> Submodel building blocks and fundamental <code>R</code> formulas</a></li>
<li class="chapter" data-level="6.2" data-path="submodel-structure.html"><a href="submodel-structure.html#the-major-effects-available-for-modelling"><i class="fa fa-check"></i><b>6.2</b> The major effects available for modelling</a></li>
<li class="chapter" data-level="6.3" data-path="submodel-structure.html"><a href="submodel-structure.html#the-submodel-class-and-methods"><i class="fa fa-check"></i><b>6.3</b> The submodel class and methods</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fitting.html"><a href="fitting.html"><i class="fa fa-check"></i><b>7</b> Fitting</a>
<ul>
<li class="chapter" data-level="7.1" data-path="fitting.html"><a href="fitting.html#fishing-mortality-submodel-f_ay"><i class="fa fa-check"></i><b>7.1</b> Fishing mortality submodel (<span class="math inline">\(F_{ay}\)</span>)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="fitting.html"><a href="fitting.html#separable-model"><i class="fa fa-check"></i><b>7.1.1</b> Separable model</a></li>
<li class="chapter" data-level="7.1.2" data-path="fitting.html"><a href="fitting.html#constant-selectivity-for-contiguous-ages-or-years"><i class="fa fa-check"></i><b>7.1.2</b> Constant selectivity for contiguous ages or years</a></li>
<li class="chapter" data-level="7.1.3" data-path="fitting.html"><a href="fitting.html#time-blocks-selectivity"><i class="fa fa-check"></i><b>7.1.3</b> Time blocks selectivity</a></li>
<li class="chapter" data-level="7.1.4" data-path="fitting.html"><a href="fitting.html#time-changing-selectivity"><i class="fa fa-check"></i><b>7.1.4</b> Time changing selectivity</a></li>
<li class="chapter" data-level="7.1.5" data-path="fitting.html"><a href="fitting.html#trawl-fleets"><i class="fa fa-check"></i><b>7.1.5</b> Trawl fleets}</a></li>
<li class="chapter" data-level="7.1.6" data-path="fitting.html"><a href="fitting.html#nets-and-liners-fleets"><i class="fa fa-check"></i><b>7.1.6</b> Nets and Liners fleets}</a></li>
<li class="chapter" data-level="7.1.7" data-path="fitting.html"><a href="fitting.html#multigear-fleets"><i class="fa fa-check"></i><b>7.1.7</b> Multigear fleets}</a></li>
<li class="chapter" data-level="7.1.8" data-path="fitting.html"><a href="fitting.html#trawl-surveys"><i class="fa fa-check"></i><b>7.1.8</b> Trawl surveys}</a></li>
<li class="chapter" data-level="7.1.9" data-path="fitting.html"><a href="fitting.html#closed-form-selection-pattern"><i class="fa fa-check"></i><b>7.1.9</b> Closed form selection pattern}</a></li>
<li class="chapter" data-level="7.1.10" data-path="fitting.html"><a href="fitting.html#more-models"><i class="fa fa-check"></i><b>7.1.10</b> More models</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="fitting.html"><a href="fitting.html#abundance-indices-catchability-submodel-q_ays"><i class="fa fa-check"></i><b>7.2</b> Abundance indices catchability submodel (<span class="math inline">\(Q_{ays}\)</span>)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-age-based-indices"><i class="fa fa-check"></i><b>7.2.1</b> Catchability submodel for age based indices</a></li>
<li class="chapter" data-level="7.2.2" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-age-aggregated-biomass-indices"><i class="fa fa-check"></i><b>7.2.2</b> Catchability submodel for age aggregated biomass indices}</a></li>
<li class="chapter" data-level="7.2.3" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-single-age-indices"><i class="fa fa-check"></i><b>7.2.3</b> Catchability submodel for single age indices</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fitting.html"><a href="fitting.html#stock-recruitment-submodel-r_y"><i class="fa fa-check"></i><b>7.3</b> Stock-recruitment submodel (<span class="math inline">\(R_y\)</span>)}</a></li>
<li class="chapter" data-level="7.4" data-path="fitting.html"><a href="fitting.html#observation-variance-submodel-sigma2_ay-tau2_ays"><i class="fa fa-check"></i><b>7.4</b> Observation variance submodel (<span class="math inline">\(\{\sigma^2_{ay}, \tau^2_{ays}\}\)</span>)</a></li>
<li class="chapter" data-level="7.5" data-path="fitting.html"><a href="fitting.html#initial-year-abundance-submodel-n_ay1"><i class="fa fa-check"></i><b>7.5</b> Initial year abundance submodel (<span class="math inline">\(N_{a,y=1}\)</span>)}</a></li>
<li class="chapter" data-level="7.6" data-path="fitting.html"><a href="fitting.html#data-weigthing"><i class="fa fa-check"></i><b>7.6</b> Data weigthing</a></li>
<li class="chapter" data-level="7.7" data-path="fitting.html"><a href="fitting.html#working-with-covariates"><i class="fa fa-check"></i><b>7.7</b> Working with covariates</a></li>
<li class="chapter" data-level="7.8" data-path="fitting.html"><a href="fitting.html#assessing-files"><i class="fa fa-check"></i><b>7.8</b> Assessing files</a></li>
<li class="chapter" data-level="7.9" data-path="fitting.html"><a href="fitting.html#missing-observations-in-the-catch-matrix-or-index"><i class="fa fa-check"></i><b>7.9</b> Missing observations in the catch matrix or index</a></li>
<li class="chapter" data-level="7.10" data-path="fitting.html"><a href="fitting.html#introduction-to-splines"><i class="fa fa-check"></i><b>7.10</b> Introduction to Splines</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="fitting.html"><a href="fitting.html#understanding-spline-basics"><i class="fa fa-check"></i><b>7.10.1</b> Understanding Spline Basics</a></li>
<li class="chapter" data-level="7.10.2" data-path="fitting.html"><a href="fitting.html#generate-some-artificial-data"><i class="fa fa-check"></i><b>7.10.2</b> Generate some artificial data</a></li>
<li class="chapter" data-level="7.10.3" data-path="fitting.html"><a href="fitting.html#cubic-regression-splines"><i class="fa fa-check"></i><b>7.10.3</b> Cubic Regression Splines</a></li>
<li class="chapter" data-level="7.10.4" data-path="fitting.html"><a href="fitting.html#thin-plate-spline"><i class="fa fa-check"></i><b>7.10.4</b> Thin plate spline</a></li>
<li class="chapter" data-level="7.10.5" data-path="fitting.html"><a href="fitting.html#comparison"><i class="fa fa-check"></i><b>7.10.5</b> Comparison</a></li>
<li class="chapter" data-level="7.10.6" data-path="fitting.html"><a href="fitting.html#the-mgcv-package-inside-a4a"><i class="fa fa-check"></i><b>7.10.6</b> The <code>mgcv</code> package inside <code>a4a</code></a></li>
<li class="chapter" data-level="7.10.7" data-path="fitting.html"><a href="fitting.html#on-the-number-of-knots-k"><i class="fa fa-check"></i><b>7.10.7</b> On the number of knots <span class="math inline">\(k\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>8</b> Diagnostics </a>
<ul>
<li class="chapter" data-level="8.1" data-path="diagnostics.html"><a href="diagnostics.html#residuals"><i class="fa fa-check"></i><b>8.1</b> Residuals</a></li>
<li class="chapter" data-level="8.2" data-path="diagnostics.html"><a href="diagnostics.html#predictive-skill"><i class="fa fa-check"></i><b>8.2</b> Predictive skill</a></li>
<li class="chapter" data-level="8.3" data-path="diagnostics.html"><a href="diagnostics.html#aggreagted-catch-in-weight"><i class="fa fa-check"></i><b>8.3</b> Aggreagted catch in weight}</a></li>
<li class="chapter" data-level="8.4" data-path="diagnostics.html"><a href="diagnostics.html#fit-summary-information-and-cross-validation-metrics"><i class="fa fa-check"></i><b>8.4</b> Fit summary, information and cross-validation metrics</a></li>
<li class="chapter" data-level="8.5" data-path="diagnostics.html"><a href="diagnostics.html#the-package-a4adiags"><i class="fa fa-check"></i><b>8.5</b> The package a4adiags</a></li>
<li class="chapter" data-level="8.6" data-path="diagnostics.html"><a href="diagnostics.html#residuals-and-submodels-misspecifiction"><i class="fa fa-check"></i><b>8.6</b> Residuals and submodels misspecifiction</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="diagnostics.html"><a href="diagnostics.html#the-mean-model"><i class="fa fa-check"></i><b>8.6.1</b> The “mean” model</a></li>
<li class="chapter" data-level="8.6.2" data-path="diagnostics.html"><a href="diagnostics.html#the-age-effects"><i class="fa fa-check"></i><b>8.6.2</b> The age effects</a></li>
<li class="chapter" data-level="8.6.3" data-path="diagnostics.html"><a href="diagnostics.html#the-fishing-mortality-year-model"><i class="fa fa-check"></i><b>8.6.3</b> The fishing mortality year model</a></li>
<li class="chapter" data-level="8.6.4" data-path="diagnostics.html"><a href="diagnostics.html#the-initial-year-population-abundance-model-aka-n1"><i class="fa fa-check"></i><b>8.6.4</b> The initial year population abundance model, aka N1</a></li>
<li class="chapter" data-level="8.6.5" data-path="diagnostics.html"><a href="diagnostics.html#the-stock-recruitment-submodel"><i class="fa fa-check"></i><b>8.6.5</b> The stock recruitment submodel</a></li>
<li class="chapter" data-level="8.6.6" data-path="diagnostics.html"><a href="diagnostics.html#the-variance-submodel"><i class="fa fa-check"></i><b>8.6.6</b> The variance submodel</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html"><i class="fa fa-check"></i><b>9</b> Predict and simulate </a>
<ul>
<li class="chapter" data-level="9.1" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#basic-functions"><i class="fa fa-check"></i><b>9.1</b> Basic functions}</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#simulate"><i class="fa fa-check"></i><b>9.1.1</b> simulate()</a></li>
<li class="chapter" data-level="9.1.2" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#genflquant"><i class="fa fa-check"></i><b>9.1.2</b> genFLQuant()</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#submodels"><i class="fa fa-check"></i><b>9.2</b> submodels</a></li>
<li class="chapter" data-level="9.3" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#predict"><i class="fa fa-check"></i><b>9.3</b> Predict</a></li>
<li class="chapter" data-level="9.4" data-path="predict-and-simulate.html"><a href="predict-and-simulate.html#simulate-1"><i class="fa fa-check"></i><b>9.4</b> Simulate</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-mcmc.html"><i class="fa fa-check"></i><b>10</b> The statistical catch-at-age stock assessment framework with MCMC </a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-mcmc.html#diagnostics-with-coda"><i class="fa fa-check"></i><b>10.1</b> Diagnostics with CODA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="propagate-natural-mortality-uncertainty.html"><a href="propagate-natural-mortality-uncertainty.html"><i class="fa fa-check"></i><b>11</b> Propagate natural mortality uncertainty</a></li>
<li class="chapter" data-level="12" data-path="smoothness-mgcv-and-fits.html"><a href="smoothness-mgcv-and-fits.html"><i class="fa fa-check"></i><b>12</b> Smoothness, mgcv and fits</a></li>
<li class="chapter" data-level="13" data-path="modelling-spatial-effects.html"><a href="modelling-spatial-effects.html"><i class="fa fa-check"></i><b>13</b> Modelling spatial effects</a></li>
<li class="chapter" data-level="14" data-path="reference-points.html"><a href="reference-points.html"><i class="fa fa-check"></i><b>14</b> Reference Points</a>
<ul>
<li class="chapter" data-level="14.1" data-path="reference-points.html"><a href="reference-points.html#yield-per-recruit-reference-points"><i class="fa fa-check"></i><b>14.1</b> Yield per recruit reference points</a></li>
<li class="chapter" data-level="14.2" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-relationship-based-reference-points"><i class="fa fa-check"></i><b>14.2</b> Stock recruitment relationship based reference points</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-after-fitting-the-stock-assessment-model"><i class="fa fa-check"></i><b>14.2.1</b> Stock recruitment after fitting the stock assessment model</a></li>
<li class="chapter" data-level="14.2.2" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-during-fitting-the-stock-assessment-model"><i class="fa fa-check"></i><b>14.2.2</b> Stock recruitment during fitting the stock assessment model</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="reference-points.html"><a href="reference-points.html#economics-reference-points"><i class="fa fa-check"></i><b>14.3</b> Economics reference points</a></li>
<li class="chapter" data-level="14.4" data-path="reference-points.html"><a href="reference-points.html#computing-user-specific-reference-points"><i class="fa fa-check"></i><b>14.4</b> Computing user specific reference points</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="forecasting-projections-and-harvest-control-rules.html"><a href="forecasting-projections-and-harvest-control-rules.html"><i class="fa fa-check"></i><b>15</b> Forecasting, projections and harvest control rules</a>
<ul>
<li class="chapter" data-level="15.1" data-path="forecasting-projections-and-harvest-control-rules.html"><a href="forecasting-projections-and-harvest-control-rules.html#initial-condition-assumptions"><i class="fa fa-check"></i><b>15.1</b> Initial condition assumptions</a></li>
<li class="chapter" data-level="15.2" data-path="forecasting-projections-and-harvest-control-rules.html"><a href="forecasting-projections-and-harvest-control-rules.html#scenarios"><i class="fa fa-check"></i><b>15.2</b> Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="sections-to-be-added.html"><a href="sections-to-be-added.html"><i class="fa fa-check"></i><b>16</b> Sections to be added!?</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fish stock assessment with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="forecasting-projections-and-harvest-control-rules" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Chapter 15</span> Forecasting, projections and harvest control rules<a href="forecasting-projections-and-harvest-control-rules.html#forecasting-projections-and-harvest-control-rules" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Massad et.al has a nice definition “Prediction in general science can be divided into two components: forecasting and projections [2]. A forecast is an attempt to predict what will happen. A projection is an attempt to describe what would happen, given certain hypotheses [3].”</p>
<p>(OECD)
“Forecasting” and “prediction” are often used synonymously
in the customary sense of assessing the magnitude which a
quantity will assume at some future point of time .</p>
<p>Medium-term projections or scenarios
In the context of the OECD’s Economic Outlook, medium-
term projections or scenarios look out five to six years, and
are published as part of the OECD’s projection exercise.</p>
<p>Projection
This term is used in two connected senses.
1. In relation to a time series it means a future value
calculated according to predetermined changes in the
assumptions of the environment.
2. More recently, it has been used in probability theory to
denote the conditional expectation of a variate.
Since a regression equation gives the expectation of the
dependent variate conditional upon values of the predicted
(“independent”) variates and such equations are used for
forecasting or prediction, the usages are connected.</p>
<p>Considering the above definitions one can think of the process of advising future fishing opportunities as a mix of forecasting and projections. When using a HCR that is accepted by decision makers to predict the catches which can be taken from the stock, one’s in forecasting space. The process will retur what will happen having into account the known conditions of the system. On the other hand, when exploring potential future outcomes based on a set of scenarios previously defined, one’s much more in projection’s space.</p>
<p>In fisheries science it’s not common to make the distinction between forecasts and predictions, and, in general, the approach tends to be much more within the realm of predictions. For example, it’s common to run scenarios when giving advice to fisheries managers or test different assumptions about future events.</p>
<p>Strickly speaking projections are not part of the stock assessment process. The assessment of the status of the stock is completed when the analysts produces a comparison between the estimates of biomass and fishing mortality and the respective reference points. At that point it’s possible to make statements about the stock being overfished, or not, and being subject to overfishing, or not.</p>
<p>Projections tend to come after having estimates of abundance or biomass and fishing mortality. Together with estimates, or assumptions, about the population’s dynamics: growth, reproduction, natural mortality, etc; one can predict catches, biomass, abundance and other relevant statistics, under spoecific conditions and with a certain level of uncertainty.</p>
<p>For this section we’ll be using the package <code>FLasher</code> (REF) from the FLR family of packages. Starting by fitting a model including a stock recruitment model. For projections one needs to set future recruitment.</p>
<pre><code>## Loading required package: FLCore</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: iterators</code></pre>
<pre><code>## FLCore (Version 2.6.20.9302, packaged: 2024-11-11 13:05:29 UTC)</code></pre>
<pre><code>## Loading required package: triangle</code></pre>
<pre><code>## This is FLa4a 1.9.0. For overview type &#39;help(package=&quot;FLa4a&quot;)&#39;</code></pre>
<pre><code>## Loading required package: FLFishery</code></pre>
<pre><code>## Loading required package: ggplotFL</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## 
## Attaching package: &#39;ggplot2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:FLCore&#39;:
## 
##     %+%</code></pre>
<pre><code>## FLasher: Atop the buttress the gargoyle sits</code></pre>
<p>The basic workflow to project with <code>FLasher</code> is to extend the <code>FLStock</code> object to store the predictions using the method <code>stf</code>, set the targets for the projection with method <code>fwdControl</code> and project the fishery with the method <code>fwd</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="forecasting-projections-and-harvest-control-rules.html#cb14-1" tabindex="-1"></a>stk0 <span class="ot">&lt;-</span> ple4 <span class="sc">+</span> fit0</span>
<span id="cb14-2"><a href="forecasting-projections-and-harvest-control-rules.html#cb14-2" tabindex="-1"></a>stk <span class="ot">&lt;-</span> <span class="fu">stf</span>(stk0, <span class="at">nyears=</span><span class="dv">5</span>)</span>
<span id="cb14-3"><a href="forecasting-projections-and-harvest-control-rules.html#cb14-3" tabindex="-1"></a>trg <span class="ot">&lt;-</span> <span class="fu">fwdControl</span>(<span class="at">year =</span> <span class="dv">2018</span><span class="sc">:</span><span class="dv">2022</span>, <span class="at">quant =</span> <span class="st">&quot;f&quot;</span>, <span class="at">value =</span> <span class="fl">0.4</span>)</span>
<span id="cb14-4"><a href="forecasting-projections-and-harvest-control-rules.html#cb14-4" tabindex="-1"></a>stk <span class="ot">&lt;-</span> <span class="fu">fwd</span>(stk, <span class="at">control=</span>trg, <span class="at">sr=</span>sr0)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="_main_files/figure-html/unnamed-chunk-4-1.png" alt="Projection of stock for 5 years with fixed fishing mortality and recruitment" width="672" />
<p class="caption">
Figure 15.1: Projection of stock for 5 years with fixed fishing mortality and recruitment
</p>
</div>
<p>A natural addition to this forecast is to add uncertainty. We’ll do that by generating uncertainty in population numbers, catch numbers and fishing mortality, using <code>simulate</code>. And add stock recruitment uncertinaty, combining observation and parameter uncertainty. The first using the residuals of the fit and the latter by fitting the stock recruitment models to the iterations simulated in the previous step, which creates an empirical distribution of the stock recruitment parameters, similar to a boot strap process.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="forecasting-projections-and-harvest-control-rules.html#cb15-1" tabindex="-1"></a>stk0 <span class="ot">&lt;-</span> ple4 <span class="sc">+</span> <span class="fu">simulate</span>(fit0, <span class="dv">250</span>)</span>
<span id="cb15-2"><a href="forecasting-projections-and-harvest-control-rules.html#cb15-2" tabindex="-1"></a>recr <span class="ot">&lt;-</span> <span class="fu">residuals</span>(sr0)</span>
<span id="cb15-3"><a href="forecasting-projections-and-harvest-control-rules.html#cb15-3" tabindex="-1"></a>stk <span class="ot">&lt;-</span> <span class="fu">stf</span>(stk0, <span class="at">nyears=</span><span class="dv">5</span>)</span>
<span id="cb15-4"><a href="forecasting-projections-and-harvest-control-rules.html#cb15-4" tabindex="-1"></a>recs <span class="ot">&lt;-</span> <span class="fu">window</span>(<span class="fu">rec</span>(stk), <span class="dv">2018</span>, <span class="dv">2022</span>)</span>
<span id="cb15-5"><a href="forecasting-projections-and-harvest-control-rules.html#cb15-5" tabindex="-1"></a>recs <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(recs, <span class="fu">mean</span>(recr), <span class="fu">sqrt</span>(<span class="fu">var</span>(recr) <span class="sc">+</span> <span class="fu">vcov</span>(sr0)))</span>
<span id="cb15-6"><a href="forecasting-projections-and-harvest-control-rules.html#cb15-6" tabindex="-1"></a>stk <span class="ot">&lt;-</span> <span class="fu">fwd</span>(stk, <span class="at">control=</span>trg, <span class="at">sr=</span>sr0, <span class="at">residuals=</span>recs)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="_main_files/figure-html/unnamed-chunk-6-1.png" alt="Stochastic projection of stock for 5 years with fixed fishing mortality and recruitment" width="672" />
<p class="caption">
Figure 15.2: Stochastic projection of stock for 5 years with fixed fishing mortality and recruitment
</p>
</div>
<div id="initial-condition-assumptions" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Initial condition assumptions<a href="forecasting-projections-and-harvest-control-rules.html#initial-condition-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When projecting the stock forward one needs to make a number of assumptions about initial conditions, the starting point from where projections will be made. The method <code>stf</code> has a set of options that allows the analyst to decide about those assumptions.</p>
<ul>
<li><code>wts.nyears</code>: Number of years to average over to get the future mean weights at age, default is 3</li>
<li><code>fbar.nyears</code>: Number of years to average the F over, default is 3</li>
<li><code>f.rescale</code>: Rescale F to most recent F estimate, default is FALSE</li>
<li><code>arith.mean</code>: If TRUE the arithmetic mean is used. If FALSE the geometric mean is used. Default is TRUE.</li>
<li><code>disc.nyears</code>: Number of years to average over to get the future mean proportion of discards at age. Defau;lt is to be the same as wts.nyears</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="forecasting-projections-and-harvest-control-rules.html#cb16-1" tabindex="-1"></a>stk.alt <span class="ot">&lt;-</span> <span class="fu">stf</span>(stk0, <span class="at">nyears=</span><span class="dv">5</span>, <span class="at">wts.nyears =</span> <span class="dv">20</span>, <span class="at">fbar.nyears =</span> <span class="dv">10</span>, <span class="at">f.rescale =</span> <span class="cn">TRUE</span>, <span class="at">disc.nyears =</span> <span class="dv">10</span>)</span>
<span id="cb16-2"><a href="forecasting-projections-and-harvest-control-rules.html#cb16-2" tabindex="-1"></a>stk.alt <span class="ot">&lt;-</span> <span class="fu">fwd</span>(stk.alt, <span class="at">control=</span>trg, <span class="at">sr=</span>sr0, <span class="at">residuals=</span>recs)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-8"></span>
<img src="_main_files/figure-html/unnamed-chunk-8-1.png" alt="Stochastic projections of stock for 5 years with fixed fishing mortality and recruitment. Two scenarios with different assumptions about initial conditions" width="672" />
<p class="caption">
Figure 15.3: Stochastic projections of stock for 5 years with fixed fishing mortality and recruitment. Two scenarios with different assumptions about initial conditions
</p>
</div>
</div>
<div id="scenarios" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Scenarios<a href="forecasting-projections-and-harvest-control-rules.html#scenarios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There’s a wide range of scenarios that can be of interest to project in order to give advice to policy makers, or to better understand the fitted stock assessment model. For example, forecasting the stock in the absence of fishing for a few generations, gives good insights about the dynamics of the population being modelled.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="forecasting-projections-and-harvest-control-rules.html#cb17-1" tabindex="-1"></a>stk <span class="ot">&lt;-</span> <span class="fu">stf</span>(stk0, <span class="at">nyears=</span><span class="dv">25</span>)</span>
<span id="cb17-2"><a href="forecasting-projections-and-harvest-control-rules.html#cb17-2" tabindex="-1"></a>recs <span class="ot">&lt;-</span> <span class="fu">window</span>(<span class="fu">rec</span>(stk), <span class="dv">2018</span>, <span class="fu">range</span>(stk)[<span class="st">&quot;maxyear&quot;</span>])</span>
<span id="cb17-3"><a href="forecasting-projections-and-harvest-control-rules.html#cb17-3" tabindex="-1"></a>recs <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(recs, <span class="fu">mean</span>(recr), <span class="fu">sqrt</span>(<span class="fu">var</span>(recr) <span class="sc">+</span> <span class="fu">vcov</span>(sr0)))</span>
<span id="cb17-4"><a href="forecasting-projections-and-harvest-control-rules.html#cb17-4" tabindex="-1"></a>trg <span class="ot">&lt;-</span> <span class="fu">fwdControl</span>(<span class="at">year =</span> <span class="dv">2018</span><span class="sc">:</span><span class="fu">range</span>(stk)[<span class="st">&quot;maxyear&quot;</span>], <span class="at">quant =</span> <span class="st">&quot;f&quot;</span>, <span class="at">value =</span> <span class="dv">0</span>)</span>
<span id="cb17-5"><a href="forecasting-projections-and-harvest-control-rules.html#cb17-5" tabindex="-1"></a>stk <span class="ot">&lt;-</span> <span class="fu">fwd</span>(stk, <span class="at">control=</span>trg, <span class="at">sr=</span>sr0, <span class="at">residuals=</span>recs)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="_main_files/figure-html/unnamed-chunk-10-1.png" alt="Stochastic projection of stock for 25 years with fixed fishing mortality and recruitment" width="672" />
<p class="caption">
Figure 15.4: Stochastic projection of stock for 25 years with fixed fishing mortality and recruitment
</p>
</div>
<p>These scenarios are defined by the target quantities one’s trying to achieve. In <code>FLasher</code> there are the following target quantities:
- srp
- ssb_end
- biomass_end
- ssb_spawn
- biomass_spawn
- ssb_flash
- biomass_flash
- inmb_end
- indb
- catch
- landings
- discards
- f
- fbar
- revenue
- effort</p>
<p>[IAGO NEED YOUR HELP HERE]</p>
<p>When projecting the stock under the conditions defined by the scenario one can mix several quantities. For example it may be interesting to project an initial situation of growing the stock forward by a higher exploitation to evaluate how catches would behave. Since we’re going to increase SSB let’s use a beverton and holt recruitment model to introduce more structure in teh model.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="forecasting-projections-and-harvest-control-rules.html#cb18-1" tabindex="-1"></a>trg <span class="ot">&lt;-</span> <span class="fu">fwdControl</span>(<span class="at">year =</span> <span class="dv">2018</span><span class="sc">:</span><span class="fu">range</span>(stk)[<span class="st">&quot;maxyear&quot;</span>], <span class="at">quant =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;ssb_end&quot;</span>, <span class="dv">15</span>), <span class="fu">rep</span>(<span class="st">&quot;f&quot;</span>, <span class="dv">10</span>)), <span class="at">value =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1500000</span>, <span class="dv">15</span>), <span class="fu">rep</span>(<span class="fl">0.3</span>, <span class="dv">10</span>)))</span>
<span id="cb18-2"><a href="forecasting-projections-and-harvest-control-rules.html#cb18-2" tabindex="-1"></a>stk <span class="ot">&lt;-</span> <span class="fu">fwd</span>(stk, <span class="at">control=</span>trg, <span class="at">sr=</span>sr0, <span class="at">residuals=</span>recs)</span></code></pre></div>
<pre><code>## Warning in .local(object, fishery, control, ...): Unsolved targets at control
## rows: 1, 3, 5, 9, 7, 13, 27, 11, 19, 29, 25, 21, 23, 17, 15</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-12"></span>
<img src="_main_files/figure-html/unnamed-chunk-12-1.png" alt="Stochastic projection of stock for 25 years with fixed SSB for 15 years followed by fixed fishing mortality for 10 years and constant recruitment" width="672" />
<p class="caption">
Figure 15.5: Stochastic projection of stock for 25 years with fixed SSB for 15 years followed by fixed fishing mortality for 10 years and constant recruitment
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reference-points.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sections-to-be-added.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/14-fwd.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
