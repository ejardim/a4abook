[["index.html", "The a4a Initiative stock assessment framework Chapter 1 Before starting 1.1 License, documentation and development status 1.2 Installing and loading libraries 1.3 How to read this document 1.4 Notation", " The a4a Initiative stock assessment framework Ernesto Jardim 2024-10-22 Chapter 1 Before starting 1.1 License, documentation and development status The software is released under the EUPL 1.1. For more information on the a4a methodologies refer to Jardim, et.al, 2014, Millar, et.al, 2014 and Scott, et.al, 2016. Documentation can be found at http://flr-project.org/FLa4a. You are welcome to: Submit suggestions and bug-reports at: https://github.com/flr/FLa4a/issues Send a pull request on: https://github.com/flr/FLa4a/ Compose a friendly e-mail to the maintainer, see packageDescription('FLa4a') 1.2 Installing and loading libraries To run the FLa4a methods the reader will need to install the package and its dependencies and load them. Some datasets are distributed with the package and as such need to be loaded too. # from CRAN install.packages(c(&quot;copula&quot;,&quot;triangle&quot;, &quot;coda&quot;, &quot;grid&quot;, &quot;gridExtra&quot;, &quot;latticeExtra&quot;)) # from FLR install.packages(c(&quot;FLCore&quot;, &quot;FLa4a&quot;), repos=&quot;http://flr-project.org/R&quot;) # libraries library(devtools) library(FLa4a) library(XML) library(reshape2) library(ggplotFL) # datasets data(ple4) data(ple4.indices) data(ple4.index) data(rfLen) packageVersion(&quot;FLCore&quot;) ## [1] &#39;2.6.20.920&#39; packageVersion(&quot;FLa4a&quot;) ## [1] &#39;1.9.0&#39; 1.3 How to read this document The target audience for this document are readers with some experience in R and some background on stock assessment. The document explains the approach being developed by for fish stock assessment and scientific advice. It presents a mixture of text and code, where the first explains the concepts behind the methods, while the last shows how these can be run with the software provided. Moreover, having the code allows the reader to copy/paste and replicate the analysis presented here. The sections and subsections are as independent as possible, so it can be used as a reference document for the FLa4a. 1.4 Notation Along this chapter the notation presented in Table 1.1 will be used. Mathematical descriptions will be kept as simple as possible for readability. Table 1.1: Mathematical notation Type Symbol Description variables \\(C\\) catches \\(F\\) fishing mortality \\(M\\) natural mortality \\(R\\) recruitment \\(Q\\) vessel or fleet catchability \\(w\\) weights \\(l\\) likelihood \\(I\\) abundance index \\(S\\) spawning stock biomass \\(CV\\) coefficient of variation \\(D\\) residuals or deviances \\(N\\) normal distribution \\(\\beta\\) parameter \\(a\\) stock-recruitment parameter \\(b\\) stock-recruitment parameter \\(\\sigma^2\\) variance of catch \\(\\tau^2\\) variance of index \\(\\phi^2\\) variance of predicted recruitment \\(\\upsilon^2\\) variance of residuals subscripts \\(a\\) age \\(y\\) year \\(C\\) catch \\(I\\) abundance index \\(N\\) normal distribution \\(s\\) survey \\(SR\\) stock recruitment relationship superscripts and accents \\(\\hat{}\\) observation \\(\\tilde{}\\) prediction \\(c\\) catches \\(s\\) abundance index "],["introduction.html", "Chapter 2 Introduction", " Chapter 2 Introduction The a4a stock assessment framework is based in a non-linear catch-at-age model implemented in R, FLR and ADMB that can be applied rapidly to a wide range of situations with low setup requirements. The framework is built of submodels which define the different parts of a statistical catch at age model that require structural assumptions. In the a4a framework these are fishing mortality-at-age, abundance indicies catchability-at-age, recruitment, observation variances of catch-at-age and abundance indices-at-age, and abundance-at-age in the first year of the data series (see section @ref{sec:math} for details). Other important processes, like natural mortality, individual growth and reproduction, are treated as fixed, as it’s common in stock assessment methods. Nevertheless, the a4a framework provides methods to condition these processes prior to the model fit, and propagate their uncertainty into the assessment process. See chapters XX and section XX. The submodels formulation uses linear models, which opens the possibility of using the linear modelling tools available in R. For example, mgcv gam formulas or factorial design formulas using lm(). The ‘language’ of linear models has been developing within the statistical community for many years, and constitutes an elegant way of defining models without going through the complexity of mathematical representations. This approach makes it also easier to communicate among scientists: J. A. Nelder, 1965, notation for randomized block design Wilkinson and Rodgers, 1973, symbolic description for factorial designs Hastie and Tibshirani, 1990, introduced notation for smoothers Chambers and Hastie, 1991, further developed for use in S "],["stock-assessment-framework.html", "Chapter 3 Stock assessment framework 3.1 Maths description 3.2 Classes description ", " Chapter 3 Stock assessment framework 3.1 Maths description The stock assessment model behind the framework is based in two main equations to link observations to processes, the Baranov’s catch equation and abundance indices equation. Catches in numbers by age and year are defined in terms of the three quantities: natural mortality, fishing mortality and recruitment; using a modified form of the well known Baranov catch equation: \\[C_{ay} = \\frac{F_{ay}}{F_{ay}+M_{ay}}\\left(1 - e^{-(F_{ay}+M_{ay})}\\right) R_{y}e^{-\\sum (F_{ay} + M_{ay})} \\] Survey indices by age and year are defined in terms of the same three quantities with the addition of survey catchability: \\[I_{ays} = Q_{ays} R_{y}e^{-\\sum (F_{ay} + M_{ay})}\\] Observed catches and observed survey indices are assumed to be log-normally distributed, or equivalently, normally distributed on the log-scale, with specific observation variance: \\[ \\log \\hat{C}_{ay} \\sim \\text{Normal} \\Big( \\log C_{ay}, \\sigma^2_{ay}\\Big) \\] \\[ \\log \\hat{I}_{ays} \\sim \\text{Normal} \\Big( \\log I_{ays}, \\tau^2_{ays} \\Big) \\] The log-likelihood can now be defined as the sum of the log-likelihood of the observed catches: \\[ \\ell_C = \\sum_{ay} w^{(c)}_{ay}\\ \\ell_N \\Big( \\log C_{ay}, \\sigma^2_{ay} ;\\ \\log \\hat{C}_{ay} \\Big) \\] and the log-likelihood of the observed survey indices as: \\[ \\ell_I = \\sum_s \\sum_{ay} w^{(s)}_{ays}\\ \\ell_N \\Big( \\log I_{ays}, \\tau_{ays}^2 ;\\ \\log \\hat{I}_{ays} \\Big)\\] giving the total log-likelihood \\[\\ell = \\ell_C + \\ell_I\\] which is defined in terms of the strictly positive quantites, \\(M_{ay}\\), \\(F_{ay}\\), \\(Q_{ays}\\) and \\(R_{y}\\), and the observation variances \\(\\sigma_{ay}\\) and \\(\\tau_{ays}\\). As such, the log-likelihood is over-parameterised as there are many more parameters than observations. In order to reduce the number of parameters, \\(M_{ay}\\) is assumed known (as is common). %==================================================================== %THE FOLLOWING NEEDS REVISION, need to bring in N1 submod %==================================================================== The remaining parameters are written in terms of a linear combination of covariates \\(x_{ayk}\\), e.g. \\[\\log F_{ay} = \\sum_k \\beta_k x_{ayk}\\] where \\(k\\) is the number of parameters to be estimated and is sufficiently small. Using this tecnique the quantities \\(\\log F\\), \\(\\log Q\\), \\(\\log \\sigma\\) and \\(\\log \\tau\\) %\\(\\log \\text{initial\\,age\\,structure}\\) % this is not present in the above (in bold in the equations above) can be described by a reduced number of parameters. The following section has more discussion on the use of linear models in a4a. %==================================================================== The a4a statistical catch-at-age model can addionally allow for a functional relationship that links predicted recruitment \\(\\tilde{R}\\) based on spawning stock biomass and modelled recruitment \\(R\\), to be imposed as a fixed variance random effect. [NEEDS REVISION, sentence not clear] Options for the relationship are the hard coded models Ricker, Beverton Holt, smooth hockeystick or geometric mean. This is implemented by including a third component in the log-likelihood: \\[\\ell_{SR} = \\sum_y \\ell_N \\Big( \\log \\tilde{R}_y(a, b), \\phi_y^2 ;\\ \\log R_y \\Big)\\] giving the total log-likelihood \\[\\ell = \\ell_C + \\ell_I + \\ell_{SR}\\] Using the (time varying) Ricker model as an example, predicted recruitment is \\[\\tilde{R}_y(a_y,b_y) = a_y S_{y-1} e^{-b_y S_{y-1}}\\] where \\(S\\) is spawning stock biomass derived from the model parameters \\(F\\) and \\(R\\), and the fixed quantites \\(M\\) and mean weights by year and age. It is assumed that \\(R\\) is log-normally distributed, or equivalently, normally distributed on the log-scale about the (log) recruitment predicted by the SR model \\(\\tilde{R}\\), with known variance \\(\\phi^2\\), i.e. \\[\\log R_y \\sim \\text{Normal} \\Big( \\log \\tilde{R}_y, \\phi_y^2 \\Big)\\] which leads to the definition of \\(\\ell_{SR}\\) given above. In all cases \\(a\\) and \\(b\\) are strictly positive, and with the quantities \\(F\\), \\(R\\), etc. linear models are used to parameterise \\(\\log a\\) and/or \\(\\log b\\), where relevant. %==================================================================== %THE FOLLOWING NEEDS REVISION, this is not just the default I guess, % it’s always present since R predictions will be a mix of S/R and \\(\\gamma\\) %==================================================================== By default, recruitment \\(R\\) as apposed to the reruitment predicted from a stock recruitment model \\(\\tilde{R}\\), is specified as a linear model with a parameter for each year, i.e. \\[\\log R_y = \\gamma_y\\] This is to allow modelled recruitment \\(R_y\\) to be shrunk towards the stock recruitment model. However, if it is considered appropriate that recruitment can be determined exactly by a relationship with covariates, it is possible, to instead define \\(\\log R\\) in terms of a linear model in the same way as \\(\\log F\\), \\(\\log Q\\), \\(\\log \\sigma\\) and \\(\\log \\tau\\). %But this is pretty much the same as taking a geometric mean, with a model on log a, and making the variance very small. %==================================================================== % WE NEED TO ADD SOMETHING ABOUT HOW THE PLUSGROUP IS MODELLED %==================================================================== 3.2 Classes description Figure ?? shows the process to fit a statistical stock assessment catch at age method. (scamethod.png) The a4aFit class The a4aFitSA and a4aFitMCMC classes. Both classes have the same structure "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
