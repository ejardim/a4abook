<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Modelling Natural Mortality | Fish stock assessment with R - DRAFT</title>
  <meta name="description" content="How to do stock assessment in R using the a4a framework" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Modelling Natural Mortality | Fish stock assessment with R - DRAFT" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="How to do stock assessment in R using the a4a framework" />
  <meta name="github-repo" content="ejardim/a4abook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Modelling Natural Mortality | Fish stock assessment with R - DRAFT" />
  
  <meta name="twitter:description" content="How to do stock assessment in R using the a4a framework" />
  



<meta name="date" content="2025-05-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="growth.html"/>
<link rel="next" href="stock-assessment-framework.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stock assessment framework</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Before starting</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installing-and-loading-libraries"><i class="fa fa-check"></i><b>1.1</b> Installing and loading libraries</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#how-to-read-this-document"><i class="fa fa-check"></i><b>1.2</b> How to read this document</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#how-to-get-help"><i class="fa fa-check"></i><b>1.3</b> How to get help</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.4</b> Acknowledgements</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.5</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#the-assessment-for-all-initiative-a4a"><i class="fa fa-check"></i><b>2.1</b> The “Assessment for All” Initiative (a4a)</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#multi-stage-modelling-approach"><i class="fa fa-check"></i><b>2.2</b> Multi-stage modelling approach</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#stock-assessment-process"><i class="fa fa-check"></i><b>2.3</b> Stock Assessment Process</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#stock-assessment-as-a-linear-model"><i class="fa fa-check"></i><b>2.4</b> Stock assessment as a linear model</a></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#data-used-in-the-book"><i class="fa fa-check"></i><b>2.5</b> Data used in the book</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction.html"><a href="introduction.html#plaice-in-area-fao-27-ices-area-iv"><i class="fa fa-check"></i><b>2.5.1</b> Plaice in area FAO 27, ICES area IV</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction.html"><a href="introduction.html#european-hake-in-fao-37-gsas-1567"><i class="fa fa-check"></i><b>2.5.2</b> European hake in FAO 37, GSAs 1,5,6,7</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction.html"><a href="introduction.html#red-mullet-in-fao-27-gsa-1"><i class="fa fa-check"></i><b>2.5.3</b> Red mullet in FAO 27, GSA 1</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction.html"><a href="introduction.html#redfish-simulated-length-data"><i class="fa fa-check"></i><b>2.5.4</b> Redfish simulated length data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction.html"><a href="introduction.html#notation"><i class="fa fa-check"></i><b>2.6</b> Notation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="growth.html"><a href="growth.html"><i class="fa fa-check"></i><b>3</b> Modelling Individual Growth and Using Stochastic Slicing to Convert Length-based Data Into Age-based Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="growth.html"><a href="growth.html#a4agr---the-growth-class"><i class="fa fa-check"></i><b>3.1</b> a4aGr - The growth class</a></li>
<li class="chapter" data-level="3.2" data-path="growth.html"><a href="growth.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>3.2</b> Adding uncertainty to growth parameters with a multivariate normal distribution</a></li>
<li class="chapter" data-level="3.3" data-path="growth.html"><a href="growth.html#adding-uncertainty-to-growth-parameters-with-a-multivariate-triangle-distribution"><i class="fa fa-check"></i><b>3.3</b> Adding uncertainty to growth parameters with a multivariate triangle distribution</a></li>
<li class="chapter" data-level="3.4" data-path="growth.html"><a href="growth.html#adding-uncertainty-to-growth-parameters-with-statistical-copulas"><i class="fa fa-check"></i><b>3.4</b> Adding uncertainty to growth parameters with statistical copulas</a></li>
<li class="chapter" data-level="3.5" data-path="growth.html"><a href="growth.html#converting-from-length-to-age-based-data---the-l2a-method"><i class="fa fa-check"></i><b>3.5</b> Converting from length to age based data - the <code>l2a()</code> method</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html"><i class="fa fa-check"></i><b>4</b> Modelling Natural Mortality</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#a4am---the-m-class"><i class="fa fa-check"></i><b>4.1</b> <code>a4aM</code> - The M class</a></li>
<li class="chapter" data-level="4.2" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#adding-uncertainty-to-natural-mortality-parameters-with-a-multivariate-normal-distribution"><i class="fa fa-check"></i><b>4.2</b> Adding uncertainty to natural mortality parameters with a multivariate normal distribution</a></li>
<li class="chapter" data-level="4.3" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#adding-uncertainty-to-natural-mortality-parameters-with-statistical-copulas"><i class="fa fa-check"></i><b>4.3</b> Adding uncertainty to natural mortality parameters with statistical copulas</a></li>
<li class="chapter" data-level="4.4" data-path="modelling-natural-mortality.html"><a href="modelling-natural-mortality.html#computing-natural-mortality-time-series---the-m-method"><i class="fa fa-check"></i><b>4.4</b> Computing natural mortality time series - the “m” method</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html"><i class="fa fa-check"></i><b>5</b> Stock assessment framework</a>
<ul>
<li class="chapter" data-level="5.1" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#maths-description"><i class="fa fa-check"></i><b>5.1</b> Maths description </a></li>
<li class="chapter" data-level="5.2" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#model-structure"><i class="fa fa-check"></i><b>5.2</b> Model structure </a></li>
<li class="chapter" data-level="5.3" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#submodel-building-blocks-and-fundamental-r-formulas"><i class="fa fa-check"></i><b>5.3</b> Submodel building blocks and fundamental <code>R</code> formulas</a></li>
<li class="chapter" data-level="5.4" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#the-major-effects-available-for-modelling"><i class="fa fa-check"></i><b>5.4</b> The major effects available for modelling</a></li>
<li class="chapter" data-level="5.5" data-path="stock-assessment-framework.html"><a href="stock-assessment-framework.html#classes-description"><i class="fa fa-check"></i><b>5.5</b> Classes Description </a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html"><i class="fa fa-check"></i><b>6</b> Introduction to Splines</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#generalize-to-polynomials"><i class="fa fa-check"></i><b>6.1</b> Generalize to polynomials</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#thin-plate-spline"><i class="fa fa-check"></i><b>6.2</b> Thin plate spline</a></li>
<li class="chapter" data-level="6.3" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#the-mgcv-package-inside-a4a"><i class="fa fa-check"></i><b>6.3</b> The <code>mgcv</code> package inside <code>a4a</code></a></li>
<li class="chapter" data-level="6.4" data-path="introduction-to-splines.html"><a href="introduction-to-splines.html#on-the-number-of-knots-k"><i class="fa fa-check"></i><b>6.4</b> On the number of knots <span class="math inline">\(k\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fitting.html"><a href="fitting.html"><i class="fa fa-check"></i><b>7</b> Fitting</a>
<ul>
<li class="chapter" data-level="7.1" data-path="fitting.html"><a href="fitting.html#fishing-mortality-submodel-f_ay"><i class="fa fa-check"></i><b>7.1</b> Fishing mortality submodel (<span class="math inline">\(F_{ay}\)</span>)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="fitting.html"><a href="fitting.html#separable-model"><i class="fa fa-check"></i><b>7.1.1</b> Separable model</a></li>
<li class="chapter" data-level="7.1.2" data-path="fitting.html"><a href="fitting.html#model-with-age-year-interaction"><i class="fa fa-check"></i><b>7.1.2</b> Model with age-year interaction</a></li>
<li class="chapter" data-level="7.1.3" data-path="fitting.html"><a href="fitting.html#constant-selectivity-for-contiguous-ages-or-years"><i class="fa fa-check"></i><b>7.1.3</b> Constant selectivity for contiguous ages or years</a></li>
<li class="chapter" data-level="7.1.4" data-path="fitting.html"><a href="fitting.html#time-blocks-selectivity"><i class="fa fa-check"></i><b>7.1.4</b> Time blocks selectivity</a></li>
<li class="chapter" data-level="7.1.5" data-path="fitting.html"><a href="fitting.html#time-changing-selectivity"><i class="fa fa-check"></i><b>7.1.5</b> Time changing selectivity</a></li>
<li class="chapter" data-level="7.1.6" data-path="fitting.html"><a href="fitting.html#closed-form-selection-pattern"><i class="fa fa-check"></i><b>7.1.6</b> Closed form selection pattern</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="fitting.html"><a href="fitting.html#abundance-indices-catchability-submodel-q_ays"><i class="fa fa-check"></i><b>7.2</b> Abundance indices catchability submodel (<span class="math inline">\(Q_{ays}\)</span>)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-age-based-indices"><i class="fa fa-check"></i><b>7.2.1</b> Catchability submodel for age based indices</a></li>
<li class="chapter" data-level="7.2.2" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-age-aggregated-biomass-indices"><i class="fa fa-check"></i><b>7.2.2</b> Catchability submodel for age aggregated biomass indices</a></li>
<li class="chapter" data-level="7.2.3" data-path="fitting.html"><a href="fitting.html#catchability-submodel-for-single-age-indices"><i class="fa fa-check"></i><b>7.2.3</b> Catchability submodel for single age indices</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fitting.html"><a href="fitting.html#stock-recruitment-submodel-r_y"><i class="fa fa-check"></i><b>7.3</b> Stock-recruitment submodel (<span class="math inline">\(R_y\)</span>)</a></li>
<li class="chapter" data-level="7.4" data-path="fitting.html"><a href="fitting.html#observation-variance-submodel-sigma2_ay-tau2_ays"><i class="fa fa-check"></i><b>7.4</b> Observation variance submodel (<span class="math inline">\(\{\sigma^2_{ay}, \tau^2_{ays}\}\)</span>)</a></li>
<li class="chapter" data-level="7.5" data-path="fitting.html"><a href="fitting.html#initial-year-abundance-submodel-n_ay1"><i class="fa fa-check"></i><b>7.5</b> Initial year abundance submodel (<span class="math inline">\(N_{a,y=1}\)</span>)</a></li>
<li class="chapter" data-level="7.6" data-path="fitting.html"><a href="fitting.html#more-models"><i class="fa fa-check"></i><b>7.6</b> More models</a></li>
<li class="chapter" data-level="7.7" data-path="fitting.html"><a href="fitting.html#working-with-covariates"><i class="fa fa-check"></i><b>7.7</b> Working with covariates</a></li>
<li class="chapter" data-level="7.8" data-path="fitting.html"><a href="fitting.html#assessing-admb-files"><i class="fa fa-check"></i><b>7.8</b> Assessing <code>ADMB</code> files</a></li>
<li class="chapter" data-level="7.9" data-path="fitting.html"><a href="fitting.html#missing-observations-in-the-catch-matrix-or-index"><i class="fa fa-check"></i><b>7.9</b> Missing observations in the catch matrix or index</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>8</b> Diagnostics </a>
<ul>
<li class="chapter" data-level="8.1" data-path="diagnostics.html"><a href="diagnostics.html#residuals"><i class="fa fa-check"></i><b>8.1</b> Residuals</a></li>
<li class="chapter" data-level="8.2" data-path="diagnostics.html"><a href="diagnostics.html#predictive-skill"><i class="fa fa-check"></i><b>8.2</b> Predictive skill</a></li>
<li class="chapter" data-level="8.3" data-path="diagnostics.html"><a href="diagnostics.html#aggregated-catch-in-weight"><i class="fa fa-check"></i><b>8.3</b> Aggregated catch in weight</a></li>
<li class="chapter" data-level="8.4" data-path="diagnostics.html"><a href="diagnostics.html#fit-summary-information-and-cross-validation-metrics"><i class="fa fa-check"></i><b>8.4</b> Fit summary, information and cross-validation metrics</a></li>
<li class="chapter" data-level="8.5" data-path="diagnostics.html"><a href="diagnostics.html#retrospective-analysis"><i class="fa fa-check"></i><b>8.5</b> Retrospective analysis</a></li>
<li class="chapter" data-level="8.6" data-path="diagnostics.html"><a href="diagnostics.html#hindcast"><i class="fa fa-check"></i><b>8.6</b> Hindcast</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>9</b> Uncertainty </a>
<ul>
<li class="chapter" data-level="9.1" data-path="uncertainty.html"><a href="uncertainty.html#the-simulate-and-predict-methods"><i class="fa fa-check"></i><b>9.1</b> The <code>simulate</code> and <code>predict</code> methods</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="uncertainty.html"><a href="uncertainty.html#predict"><i class="fa fa-check"></i><b>9.1.1</b> <code>predict()</code></a></li>
<li class="chapter" data-level="9.1.2" data-path="uncertainty.html"><a href="uncertainty.html#simulate"><i class="fa fa-check"></i><b>9.1.2</b> <code>simulate()</code></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="uncertainty.html"><a href="uncertainty.html#prediction-error"><i class="fa fa-check"></i><b>9.2</b> Prediction error</a></li>
<li class="chapter" data-level="9.3" data-path="uncertainty.html"><a href="uncertainty.html#confidence-interval-coverage"><i class="fa fa-check"></i><b>9.3</b> Confidence interval coverage</a></li>
<li class="chapter" data-level="9.4" data-path="uncertainty.html"><a href="uncertainty.html#propagate-uncertainty-into-stock-assessment"><i class="fa fa-check"></i><b>9.4</b> Propagate uncertainty into stock assessment</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>10</b> The statistical catch-at-age stock assessment framework with Markov Chain Monte Carlo (MCMC) </a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#the-mcmc-method-for-sca"><i class="fa fa-check"></i><b>10.1</b> The MCMC method for <code>sca</code></a></li>
<li class="chapter" data-level="10.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#diagnostics-with-coda"><i class="fa fa-check"></i><b>10.2</b> Diagnostics with CODA</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#traceplots"><i class="fa fa-check"></i><b>10.2.1</b> Traceplots</a></li>
<li class="chapter" data-level="10.2.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#autocorrelation-and-crosscorrelation-analysis"><i class="fa fa-check"></i><b>10.2.2</b> Autocorrelation and crosscorrelation analysis</a></li>
<li class="chapter" data-level="10.2.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#geweke-diagnostic"><i class="fa fa-check"></i><b>10.2.3</b> Geweke diagnostic</a></li>
<li class="chapter" data-level="10.2.4" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#cumulative-means"><i class="fa fa-check"></i><b>10.2.4</b> Cumulative means</a></li>
<li class="chapter" data-level="10.2.5" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#distribution-density"><i class="fa fa-check"></i><b>10.2.5</b> Distribution density</a></li>
<li class="chapter" data-level="10.2.6" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#gelman-rubin-statistic"><i class="fa fa-check"></i><b>10.2.6</b> Gelman-Rubin statistic</a></li>
<li class="chapter" data-level="10.2.7" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#acceptance-rate"><i class="fa fa-check"></i><b>10.2.7</b> Acceptance rate</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#admbs-arguments-to-tune-the-mcmc-algorithm"><i class="fa fa-check"></i><b>10.3</b> <code>ADMB</code>’s arguments to tune the MCMC algorithm</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#thinning-rate"><i class="fa fa-check"></i><b>10.3.1</b> Thinning rate</a></li>
<li class="chapter" data-level="10.3.2" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcscale-and-mcnoscale"><i class="fa fa-check"></i><b>10.3.2</b> mcscale and mcnoscale</a></li>
<li class="chapter" data-level="10.3.3" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcprobe"><i class="fa fa-check"></i><b>10.3.3</b> mcprobe</a></li>
<li class="chapter" data-level="10.3.4" data-path="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html"><a href="the-statistical-catch-at-age-stock-assessment-framework-with-markov-chain-monte-carlo-mcmc.html#mcrb"><i class="fa fa-check"></i><b>10.3.4</b> mcrb</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reference-points.html"><a href="reference-points.html"><i class="fa fa-check"></i><b>11</b> Reference Points</a>
<ul>
<li class="chapter" data-level="11.1" data-path="reference-points.html"><a href="reference-points.html#yield-per-recruit-reference-points"><i class="fa fa-check"></i><b>11.1</b> Yield per recruit reference points</a></li>
<li class="chapter" data-level="11.2" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-relationship-based-reference-points"><i class="fa fa-check"></i><b>11.2</b> Stock recruitment relationship based reference points</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-after-fitting-the-stock-assessment-model"><i class="fa fa-check"></i><b>11.2.1</b> Stock recruitment after fitting the stock assessment model</a></li>
<li class="chapter" data-level="11.2.2" data-path="reference-points.html"><a href="reference-points.html#stock-recruitment-during-stock-assessment-model-fit"><i class="fa fa-check"></i><b>11.2.2</b> Stock recruitment during stock assessment model fit</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reference-points.html"><a href="reference-points.html#economics-reference-points"><i class="fa fa-check"></i><b>11.3</b> Economics reference points</a></li>
<li class="chapter" data-level="11.4" data-path="reference-points.html"><a href="reference-points.html#computing-user-specific-reference-points"><i class="fa fa-check"></i><b>11.4</b> Computing user specific reference points</a></li>
<li class="chapter" data-level="11.5" data-path="reference-points.html"><a href="reference-points.html#assessing-the-status-of-the-stock"><i class="fa fa-check"></i><b>11.5</b> Assessing the status of the stock</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html"><i class="fa fa-check"></i><b>12</b> Projections and harvest control rules</a>
<ul>
<li class="chapter" data-level="12.1" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#simple-workflow"><i class="fa fa-check"></i><b>12.1</b> Simple workflow</a></li>
<li class="chapter" data-level="12.2" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#initial-condition-assumptions"><i class="fa fa-check"></i><b>12.2</b> Initial condition assumptions</a></li>
<li class="chapter" data-level="12.3" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#scenarios"><i class="fa fa-check"></i><b>12.3</b> Scenarios</a></li>
<li class="chapter" data-level="12.4" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#relative-scenarios"><i class="fa fa-check"></i><b>12.4</b> Relative scenarios</a></li>
<li class="chapter" data-level="12.5" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#limits"><i class="fa fa-check"></i><b>12.5</b> Limits</a></li>
<li class="chapter" data-level="12.6" data-path="projections-and-harvest-control-rules.html"><a href="projections-and-harvest-control-rules.html#harvest-control-rules-hcr"><i class="fa fa-check"></i><b>12.6</b> Harvest Control Rules (HCR)</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html"><i class="fa fa-check"></i><b>13</b> Annex - stock assessment workflow</a>
<ul>
<li class="chapter" data-level="13.1" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-mean-model"><i class="fa fa-check"></i><b>13.1</b> The “mean” model</a></li>
<li class="chapter" data-level="13.2" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-age-effects"><i class="fa fa-check"></i><b>13.2</b> The age effects</a></li>
<li class="chapter" data-level="13.3" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#year-effect-on-fishing-mortality"><i class="fa fa-check"></i><b>13.3</b> Year effect on fishing mortality</a></li>
<li class="chapter" data-level="13.4" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#year-effect-on-catchability"><i class="fa fa-check"></i><b>13.4</b> Year effect on catchability</a></li>
<li class="chapter" data-level="13.5" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-initial-year-population-abundance-model-aka-n1"><i class="fa fa-check"></i><b>13.5</b> The initial year population abundance model, aka N1</a></li>
<li class="chapter" data-level="13.6" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-stock-recruitment-submodel"><i class="fa fa-check"></i><b>13.6</b> The stock recruitment submodel</a></li>
<li class="chapter" data-level="13.7" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#the-variance-submodel"><i class="fa fa-check"></i><b>13.7</b> The variance submodel</a></li>
<li class="chapter" data-level="13.8" data-path="annex---stock-assessment-workflow.html"><a href="annex---stock-assessment-workflow.html#final-comments"><i class="fa fa-check"></i><b>13.8</b> Final comments</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fish stock assessment with R - DRAFT</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelling-natural-mortality" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Modelling Natural Mortality<a href="modelling-natural-mortality.html#modelling-natural-mortality" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Natural mortality (<span class="math inline">\(M\)</span>) is a critical parameter in stock assessment models, representing all sources of mortality not related to fishing or harvest (<span class="math inline">\(F\)</span>). Combined, these two sources constitute the total mortality (<span class="math inline">\(Z\)</span>) that individuals experience, with <span class="math inline">\(Z = F + M\)</span>.</p>
<p>However, natural mortality is notoriously difficult to observe and estimate. Only a few methods, such as mark-recapture studies, provide direct estimates of <span class="math inline">\(M\)</span>. However, these methods are not applicable to all species and are often costly. As an alternative, life-history theory is commonly used to derive values for <span class="math inline">\(M\)</span> that are consistent with individual growth and reproduction.</p>
<p>There is an extensive body of literature on natural mortality. Works by <span class="citation">Pauly (<a href="#ref-pauly1980">1980</a>)</span>, <span class="citation">Gislason et al. (<a href="#ref-gislason2010">2010</a>)</span>, <span class="citation">Charnov (<a href="#ref-charnov1993">1993</a>)</span>, <span class="citation">Mark N. Maunder et al. (<a href="#ref-maunder2023mrev">2023</a>)</span> and <span class="citation">Quinn and Deriso (<a href="#ref-quinn1999">1999</a>)</span>, as well as a dedicated special issue in Fisheries Research <span class="citation">(<a href="#ref-MCAPAM2023">Hamel et al. 2023</a>)</span>, offer valuable insights and serve as excellent starting points. Given the parameter’s importance and the difficulty of obtaining direct observations, natural mortality is widely regarded as one of the most significant sources of uncertainty in stock assessments.</p>
<p>Within the <code>a4a</code> framework, natural mortality is treated as an externally fixed parameter in the stock assessment model. Our aim is to develop a system that enables analysts to explore alternative models for <span class="math inline">\(M\)</span> and compare the resulting assessment outcomes. This approach provides a more comprehensive information base to support informed decision-making throughout the stock assessment process.</p>
<p>Within the <code>a4a</code> framework, the general method for adding natural mortality in the stock assessment model is to:</p>
<ol style="list-style-type: decimal">
<li>Create an object of class <code>a4aM</code> which holds the natural mortality model and parameters.</li>
<li>Add uncertainty to the parameters in the <code>a4aM</code> object.</li>
<li>Apply the <code>m()</code> method to the <code>a4aM</code> object to create an age or length based <code>FLQuant</code> object of the required dimensions.</li>
</ol>
<p>The resulting <code>FLQuant</code> object can then be directly inserted into a <code>FLStock</code> object to be used in the assessment.</p>
<p>In this section we go through each of the steps in detail using a variety of different models.</p>
<div id="a4am---the-m-class" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> <code>a4aM</code> - The M class<a href="modelling-natural-mortality.html#a4am---the-m-class" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Natural mortality is implemented in a class named <code>a4aM</code>. This class is made up of three objects of the class <code>FLModelSim</code>. Each object is a model that represents one effect: an age or length effect, a scaling (level) effect and a time trend, named <code>shape</code>, <code>level</code> and <code>trend</code>, respectively. The impact of the models is multiplicative, i.e. the overal natural mortality is given by <code>shape</code> x <code>level</code> x <code>trend</code>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="modelling-natural-mortality.html#cb44-1" tabindex="-1"></a><span class="fu">showClass</span>(<span class="st">&quot;a4aM&quot;</span>)</span></code></pre></div>
<pre><code>## Class &quot;a4aM&quot; [package &quot;FLa4a&quot;]
## 
## Slots:
##                                                                         
## Name:       shape      level      trend       name       desc      range
## Class: FLModelSim FLModelSim FLModelSim  character  character    numeric
## 
## Extends: &quot;FLComp&quot;</code></pre>
<p>The <code>a4aM</code> constructor requires that the models and parameters are provided. The default method will build each of these models as a constant value of 1.</p>
<p>As a simple example, the usual “0.2” guess-estimate could be set up by setting the <code>level</code> model to have a single parameter with a fixed value, while the other two models, <code>shape</code> and <code>trend</code>, have a default value of 1 (meaning that they have no effect).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="modelling-natural-mortality.html#cb46-1" tabindex="-1"></a>mod02 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span>a, <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">a=</span><span class="fl">0.2</span>))</span>
<span id="cb46-2"><a href="modelling-natural-mortality.html#cb46-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">a4aM</span>(<span class="at">level=</span>mod02)</span>
<span id="cb46-3"><a href="modelling-natural-mortality.html#cb46-3" tabindex="-1"></a>m1</span></code></pre></div>
<pre><code>## a4aM object:
##   shape: ~1
##   level: ~a
##   trend: ~1</code></pre>
<p>More interesting natural mortality shapes can be set up using biological knowledge. The following example uses an exponential decay over ages (implying that the resulting <code>FLQuant</code>} generated by the <code>m()</code> method will be age based). We also use Jensen’s second estimator <span class="citation">(<a href="#ref-Kenchington2014">Kenchington 2014</a>)</span> as a scaling <code>level</code> model, which is based on the von Bertalanffy <span class="math inline">\(K\)</span> parameter, <span class="math inline">\(M=1.5K\)</span>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="modelling-natural-mortality.html#cb48-1" tabindex="-1"></a>shape2 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span><span class="fu">exp</span>(<span class="sc">-</span>age<span class="fl">-0.5</span>))</span>
<span id="cb48-2"><a href="modelling-natural-mortality.html#cb48-2" tabindex="-1"></a>level2 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span><span class="fl">1.5</span><span class="sc">*</span>k, <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">k=</span><span class="fl">0.4</span>))</span>
<span id="cb48-3"><a href="modelling-natural-mortality.html#cb48-3" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">a4aM</span>(<span class="at">shape=</span>shape2, <span class="at">level=</span>level2)</span>
<span id="cb48-4"><a href="modelling-natural-mortality.html#cb48-4" tabindex="-1"></a>m2</span></code></pre></div>
<pre><code>## a4aM object:
##   shape: ~exp(-age - 0.5)
##   level: ~1.5 * k
##   trend: ~1</code></pre>
<p>Note that the <code>shape</code> model has <code>age</code> as a parameter of the model but is not set using the <code>params</code> argument.</p>
<p>The <code>shape</code> model does not have to be age-based. For example, here we set up a <code>shape</code> model using Gislason’s second estimator <span class="citation">(<a href="#ref-Kenchington2014">Kenchington 2014</a>)</span>: <span class="math inline">\(M_l=K(\frac{L_{\inf}}{l})^{1.5}\)</span>. We use the default <code>level</code> and <code>trend</code> models.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="modelling-natural-mortality.html#cb50-1" tabindex="-1"></a>shape_len <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span>K<span class="sc">*</span>(linf<span class="sc">/</span>len)<span class="sc">^</span><span class="fl">1.5</span>, <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">linf=</span><span class="dv">60</span>, <span class="at">K=</span><span class="fl">0.4</span>))</span>
<span id="cb50-2"><a href="modelling-natural-mortality.html#cb50-2" tabindex="-1"></a>m_len <span class="ot">&lt;-</span> <span class="fu">a4aM</span>(<span class="at">shape=</span>shape_len)</span></code></pre></div>
<p>Another option is to model how an external factor may impact natural mortality. This can be added through the <code>trend</code> model. Suppose natural mortality can be modelled with a dependency on the NAO index, due to some mechanism that results in having lower mortality when NAO is negative and higher when it’s positive. In this example, the impact is represented by the NAO value on the quarter before spawning, which occurs in the second quarter.</p>
<p>We use this to make a complex natural mortality model with an age based shape model, a level model based on <span class="math inline">\(K\)</span> and a trend model driven by NAO, where mortality increases by 50% if NAO is positive on the first quarter.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="modelling-natural-mortality.html#cb51-1" tabindex="-1"></a><span class="co"># Get NAO</span></span>
<span id="cb51-2"><a href="modelling-natural-mortality.html#cb51-2" tabindex="-1"></a>nao <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;https://www.cpc.ncep.noaa.gov/products/precip/CWlink/pna/norm.nao.monthly.b5001.current.ascii.table&quot;</span>, <span class="at">skip=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="cn">TRUE</span>, <span class="at">na.strings=</span><span class="st">&quot;-99.90&quot;</span>)</span>
<span id="cb51-3"><a href="modelling-natural-mortality.html#cb51-3" tabindex="-1"></a>dnms <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">quant=</span><span class="st">&quot;nao&quot;</span>, <span class="at">year=</span><span class="dv">1950</span><span class="sc">:</span><span class="dv">2024</span>, <span class="at">unit=</span><span class="st">&quot;unique&quot;</span>, <span class="at">season=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">area=</span><span class="st">&quot;unique&quot;</span>)</span>
<span id="cb51-4"><a href="modelling-natural-mortality.html#cb51-4" tabindex="-1"></a><span class="co"># Build an FLQuant from the NAO data</span></span>
<span id="cb51-5"><a href="modelling-natural-mortality.html#cb51-5" tabindex="-1"></a>nao.flq <span class="ot">&lt;-</span> <span class="fu">FLQuant</span>(<span class="fu">unlist</span>(nao[,<span class="sc">-</span><span class="dv">1</span>]), <span class="at">dimnames=</span>dnms, <span class="at">units=</span><span class="st">&quot;nao&quot;</span>)</span>
<span id="cb51-6"><a href="modelling-natural-mortality.html#cb51-6" tabindex="-1"></a><span class="co"># Build covar by calculating mean over the first 3 months</span></span>
<span id="cb51-7"><a href="modelling-natural-mortality.html#cb51-7" tabindex="-1"></a>nao <span class="ot">&lt;-</span> <span class="fu">seasonMeans</span>(<span class="fu">trim</span>(nao.flq, <span class="at">year=</span><span class="fu">dimnames</span>(<span class="fu">stock.n</span>(ple4))<span class="sc">$</span>year))</span>
<span id="cb51-8"><a href="modelling-natural-mortality.html#cb51-8" tabindex="-1"></a><span class="co"># Turn into Boolean</span></span>
<span id="cb51-9"><a href="modelling-natural-mortality.html#cb51-9" tabindex="-1"></a>nao <span class="ot">&lt;-</span> (nao<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb51-10"><a href="modelling-natural-mortality.html#cb51-10" tabindex="-1"></a><span class="co"># Constructor</span></span>
<span id="cb51-11"><a href="modelling-natural-mortality.html#cb51-11" tabindex="-1"></a>trend3 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">+</span>b<span class="sc">*</span>nao, <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">b=</span><span class="fl">0.5</span>))</span>
<span id="cb51-12"><a href="modelling-natural-mortality.html#cb51-12" tabindex="-1"></a>shape3 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span><span class="fu">exp</span>(<span class="sc">-</span>age<span class="fl">-0.5</span>))</span>
<span id="cb51-13"><a href="modelling-natural-mortality.html#cb51-13" tabindex="-1"></a>level3 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span><span class="fl">1.5</span><span class="sc">*</span>k, <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">k=</span><span class="fl">0.4</span>))</span>
<span id="cb51-14"><a href="modelling-natural-mortality.html#cb51-14" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">a4aM</span>(<span class="at">shape=</span>shape3, <span class="at">level=</span>level3, <span class="at">trend=</span>trend3)</span>
<span id="cb51-15"><a href="modelling-natural-mortality.html#cb51-15" tabindex="-1"></a>m3</span></code></pre></div>
<pre><code>## a4aM object:
##   shape: ~exp(-age - 0.5)
##   level: ~1.5 * k
##   trend: ~1 + b * nao</code></pre>
</div>
<div id="adding-uncertainty-to-natural-mortality-parameters-with-a-multivariate-normal-distribution" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Adding uncertainty to natural mortality parameters with a multivariate normal distribution<a href="modelling-natural-mortality.html#adding-uncertainty-to-natural-mortality-parameters-with-a-multivariate-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uncertainty on natural mortality is added through uncertainty on the parameters.</p>
<p>In this section we’ll’ show how to add multivariate normal uncertainty. We make use of the class <code>FLModelSim</code> method <code>mvrnorm()</code>, which is a wrapper for the method <code>mvrnorm()</code> distributed by the package <code>MASS</code> <span class="citation">(<a href="#ref-mass">Venables and Ripley 2002</a>)</span>.</p>
<p>We’ll create an <code>a4aM</code> object with an exponential shape, a <code>level</code> model based on <span class="math inline">\(k\)</span> and temperature, Jensen’s third estimator <span class="citation">(<a href="#ref-Kenchington2014">Kenchington 2014</a>)</span>, and a <code>trend</code> model driven by the NAO (as above). Afterwards a variance-covariance matrix for the <code>level</code> and <code>trend</code> models will be included. Finally, create an object with 100 iterations using the <code>mvrnorm()</code> method.</p>
<p>Create the object:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="modelling-natural-mortality.html#cb53-1" tabindex="-1"></a>shape4 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span><span class="fu">exp</span>(<span class="sc">-</span>age<span class="fl">-0.5</span>))</span>
<span id="cb53-2"><a href="modelling-natural-mortality.html#cb53-2" tabindex="-1"></a>level4 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span>k<span class="sc">^</span><span class="fl">0.66</span><span class="sc">*</span>t<span class="sc">^</span><span class="fl">0.57</span>,</span>
<span id="cb53-3"><a href="modelling-natural-mortality.html#cb53-3" tabindex="-1"></a>    <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">k=</span><span class="fl">0.4</span>, <span class="at">t=</span><span class="dv">10</span>),</span>
<span id="cb53-4"><a href="modelling-natural-mortality.html#cb53-4" tabindex="-1"></a>    <span class="at">vcov=</span><span class="fu">array</span>(<span class="fu">c</span>(<span class="fl">0.002</span>, <span class="fl">0.01</span>,<span class="fl">0.01</span>, <span class="dv">1</span>), <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb53-5"><a href="modelling-natural-mortality.html#cb53-5" tabindex="-1"></a>trend4 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">+</span>b<span class="sc">*</span>nao,</span>
<span id="cb53-6"><a href="modelling-natural-mortality.html#cb53-6" tabindex="-1"></a>    <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">b=</span><span class="fl">0.5</span>),</span>
<span id="cb53-7"><a href="modelling-natural-mortality.html#cb53-7" tabindex="-1"></a>    <span class="at">vcov=</span><span class="fu">matrix</span>(<span class="fl">0.02</span>))</span>
<span id="cb53-8"><a href="modelling-natural-mortality.html#cb53-8" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">a4aM</span>(<span class="at">shape=</span>shape4, <span class="at">level=</span>level4, <span class="at">trend=</span>trend4)</span>
<span id="cb53-9"><a href="modelling-natural-mortality.html#cb53-9" tabindex="-1"></a><span class="co"># Call mvrnorm()</span></span>
<span id="cb53-10"><a href="modelling-natural-mortality.html#cb53-10" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="dv">100</span>, m4)</span>
<span id="cb53-11"><a href="modelling-natural-mortality.html#cb53-11" tabindex="-1"></a>m4</span></code></pre></div>
<pre><code>## a4aM object:
##   shape: ~exp(-age - 0.5)
##   level: ~k^0.66 * t^0.57
##   trend: ~1 + b * nao</code></pre>
<p>Inspect the level model (for example):</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="modelling-natural-mortality.html#cb55-1" tabindex="-1"></a><span class="fu">level</span>(m4)</span></code></pre></div>
<pre><code>## An object of class &quot;FLModelSim&quot;
## Slot &quot;model&quot;:
## ~k^0.66 * t^0.57
## 
## Slot &quot;params&quot;:
## An object of class &quot;FLPar&quot;
## iters:  100 
## 
## params
##               k               t 
## 0.39552(0.0519) 9.88366(0.9946) 
## units:  NA 
## 
## Slot &quot;vcov&quot;:
##       [,1] [,2]
## [1,] 0.002 0.01
## [2,] 0.010 1.00
## 
## Slot &quot;distr&quot;:
## [1] &quot;norm&quot;</code></pre>
<p>Note the variance in the parameters:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="modelling-natural-mortality.html#cb57-1" tabindex="-1"></a><span class="fu">params</span>(<span class="fu">trend</span>(m4))</span></code></pre></div>
<pre><code>## An object of class &quot;FLPar&quot;
## iters:  100 
## 
## params
##              b 
## 0.50569(0.137) 
## units:  NA</code></pre>
<p>Note the shape model has no parameters and no uncertainty:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="modelling-natural-mortality.html#cb59-1" tabindex="-1"></a><span class="fu">params</span>(<span class="fu">shape</span>(m4))</span></code></pre></div>
<pre><code>## An object of class &quot;FLPar&quot;
## params
##    
## NA 
## units:  NA</code></pre>
<p>In this particular case, the <code>shape</code> model will not be randomized because it doesn’t have a variance-covariance matrix. Also note that because there is only one parameter in the <code>trend</code> model, the randomization will use a univariate normal distribution. The same model could be achieved by using <code>mnrnorm()</code> on each model component:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="modelling-natural-mortality.html#cb61-1" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">a4aM</span>(<span class="at">shape=</span>shape4,</span>
<span id="cb61-2"><a href="modelling-natural-mortality.html#cb61-2" tabindex="-1"></a>    <span class="at">level=</span><span class="fu">mvrnorm</span>(<span class="dv">100</span>, level4),</span>
<span id="cb61-3"><a href="modelling-natural-mortality.html#cb61-3" tabindex="-1"></a>    <span class="at">trend=</span><span class="fu">mvrnorm</span>(<span class="dv">100</span>, trend4))</span></code></pre></div>
<p>an exact match would require to control the random seed so that the draws would be exactly the same.</p>
</div>
<div id="adding-uncertainty-to-natural-mortality-parameters-with-statistical-copulas" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Adding uncertainty to natural mortality parameters with statistical copulas<a href="modelling-natural-mortality.html#adding-uncertainty-to-natural-mortality-parameters-with-statistical-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can also use copulas to add parameter uncertainty to the natural mortality model, similar to the way we use them for the growth model in Section <a href="growth.html#growth">3</a>. As stated above these processes make use of the methods implemented for the <code>FLModelSim</code> class.</p>
<p>In the following example we’ll use again Gislason’s second estimator, <span class="math inline">\(M_l=K(\frac{L_{\inf}}{l})^{1.5}\)</span> and a triangle copula to model parameter uncertainty. The method <code>mvrtriangle()</code> is used to create 1000 iterations.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="modelling-natural-mortality.html#cb62-1" tabindex="-1"></a>linf <span class="ot">&lt;-</span> <span class="dv">60</span></span>
<span id="cb62-2"><a href="modelling-natural-mortality.html#cb62-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb62-3"><a href="modelling-natural-mortality.html#cb62-3" tabindex="-1"></a><span class="co"># vcov matrix (make up some values)</span></span>
<span id="cb62-4"><a href="modelling-natural-mortality.html#cb62-4" tabindex="-1"></a>mm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb62-5"><a href="modelling-natural-mortality.html#cb62-5" tabindex="-1"></a><span class="co"># 10% cv</span></span>
<span id="cb62-6"><a href="modelling-natural-mortality.html#cb62-6" tabindex="-1"></a><span class="fu">diag</span>(mm) <span class="ot">&lt;-</span> <span class="fu">c</span>((linf<span class="sc">*</span><span class="fl">0.1</span>)<span class="sc">^</span><span class="dv">2</span>, (k<span class="sc">*</span><span class="fl">0.1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb62-7"><a href="modelling-natural-mortality.html#cb62-7" tabindex="-1"></a><span class="co"># 0.2 correlation</span></span>
<span id="cb62-8"><a href="modelling-natural-mortality.html#cb62-8" tabindex="-1"></a>mm[<span class="fu">upper.tri</span>(mm)] <span class="ot">&lt;-</span> mm[<span class="fu">lower.tri</span>(mm)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>)</span>
<span id="cb62-9"><a href="modelling-natural-mortality.html#cb62-9" tabindex="-1"></a><span class="co"># a good way to check is using cov2cor</span></span>
<span id="cb62-10"><a href="modelling-natural-mortality.html#cb62-10" tabindex="-1"></a><span class="fu">cov2cor</span>(mm)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 1.0000000 0.2083333
## [2,] 0.2083333 1.0000000</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="modelling-natural-mortality.html#cb64-1" tabindex="-1"></a><span class="co"># create object</span></span>
<span id="cb64-2"><a href="modelling-natural-mortality.html#cb64-2" tabindex="-1"></a>mgis2 <span class="ot">&lt;-</span> <span class="fu">FLModelSim</span>(<span class="at">model=</span><span class="sc">~</span>k<span class="sc">*</span>(linf<span class="sc">/</span>len)<span class="sc">^</span><span class="fl">1.5</span>, <span class="at">params=</span><span class="fu">FLPar</span>(<span class="at">linf=</span>linf, <span class="at">k=</span>k), <span class="at">vcov=</span>mm)</span>
<span id="cb64-3"><a href="modelling-natural-mortality.html#cb64-3" tabindex="-1"></a><span class="co"># set the lower, upper and centre of the parameters</span></span>
<span id="cb64-4"><a href="modelling-natural-mortality.html#cb64-4" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">a=</span><span class="dv">55</span>,<span class="at">b=</span><span class="dv">65</span>), <span class="fu">list</span>(<span class="at">a=</span><span class="fl">0.3</span>, <span class="at">b=</span><span class="fl">0.6</span>, <span class="at">c=</span><span class="fl">0.35</span>))</span>
<span id="cb64-5"><a href="modelling-natural-mortality.html#cb64-5" tabindex="-1"></a>mgis2 <span class="ot">&lt;-</span> <span class="fu">mvrtriangle</span>(<span class="dv">1000</span>, mgis2, <span class="at">paramMargins=</span>pars)</span>
<span id="cb64-6"><a href="modelling-natural-mortality.html#cb64-6" tabindex="-1"></a>mgis2</span></code></pre></div>
<pre><code>## An object of class &quot;FLModelSim&quot;
## Slot &quot;model&quot;:
## ~k * (linf/len)^1.5
## 
## Slot &quot;params&quot;:
## An object of class &quot;FLPar&quot;
## iters:  1000 
## 
## params
##             linf                k 
## 59.96565(2.2693)  0.40873(0.0759) 
## units:  NA 
## 
## Slot &quot;vcov&quot;:
##       [,1]   [,2]
## [1,] 36.00 0.0500
## [2,]  0.05 0.0016
## 
## Slot &quot;distr&quot;:
## [1] &quot;un &lt;deprecated slot&gt; triangle&quot;</code></pre>
<p>The resulting parameter estimates and marginal distributions can be seen in Figures <a href="modelling-natural-mortality.html#fig:plottrigism">4.1</a> and <a href="modelling-natural-mortality.html#fig:plottrigismhist">4.2</a>. By default the method uses an elliptical copula of t family (see <code>?ellipCopula</code> for more information).</p>
<div class="figure"><span style="display:block;" id="fig:plottrigism"></span>
<img src="_main_files/figure-html/plottrigism-1.png" alt="Pairwise depiction of Gislason's second natural mortality model estimates using a 't' family elliptic copula and triangle distribution margins." width="672" />
<p class="caption">
Figure 4.1: Pairwise depiction of Gislason’s second natural mortality model estimates using a ‘t’ family elliptic copula and triangle distribution margins.
</p>
</div>
<div class="figure"><span style="display:block;" id="fig:plottrigismhist"></span>
<img src="_main_files/figure-html/plottrigismhist-1.png" alt="Marginal distributions of the parameters for Gislason's second natural mortality model using triangle distributions." width="672" />
<p class="caption">
Figure 4.2: Marginal distributions of the parameters for Gislason’s second natural mortality model using triangle distributions.
</p>
</div>
<p>We now have a new model that can be used for the <code>shape</code> model. You can use the constructor or the set method to add the new model. Note that we have a quite complex method now for M. A length based <code>shape</code> model from Gislason’s work, Jensen’s third model based on temperature <code>level</code> and a time <code>trend</code> depending on NAO. All of the component models have uncertainty in their parameters.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="modelling-natural-mortality.html#cb66-1" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> <span class="fu">a4aM</span>(<span class="at">shape=</span>mgis2, <span class="at">level=</span>level4, <span class="at">trend=</span>trend4)</span>
<span id="cb66-2"><a href="modelling-natural-mortality.html#cb66-2" tabindex="-1"></a><span class="co"># or</span></span>
<span id="cb66-3"><a href="modelling-natural-mortality.html#cb66-3" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> m4</span>
<span id="cb66-4"><a href="modelling-natural-mortality.html#cb66-4" tabindex="-1"></a><span class="fu">shape</span>(m5) <span class="ot">&lt;-</span> mgis2</span></code></pre></div>
</div>
<div id="computing-natural-mortality-time-series---the-m-method" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Computing natural mortality time series - the “m” method<a href="modelling-natural-mortality.html#computing-natural-mortality-time-series---the-m-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have set up the natural mortality <code>a4aM</code> model and added parameter uncertainty to each component, we are ready to generate the <code>FLQuant</code> of natural mortality with <code>m()</code>. The <code>m()</code> method is the workhorse method for computing natural mortality. The method returns a <code>FLQuant</code> that can be inserted in an <code>FLStock</code> to be used in the assessment method.</p>
<p>The size of the <code>FLQuant</code> object is determined by the <code>min</code>, <code>max</code>, <code>minyear</code> and <code>maxyear</code> elements of the <code>range</code> slot of the <code>a4aM</code> object. By default the values of these elements are set to 0, which generates a <code>FLQuant</code> with length 1 in the <code>quant</code> and <code>year</code> dimension. The <code>range</code> slot can be set by hand, or by using the <code>rngquant()</code> and <code>rngyear()</code> methods.</p>
<p>The name of the first dimension of the output <code>FLQuant</code> (e.g. ‘age’ or ‘len’) is determined by the parameters of the <code>shape</code> model. If it is not clear what the name should be then the name is set to ‘quant’.</p>
<p>Here we demonstrate <code>m()</code> using the simple <code>a4aM</code> object we created above that has constant natural mortality.</p>
<p>Start with the simplest model:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="modelling-natural-mortality.html#cb67-1" tabindex="-1"></a>m1</span></code></pre></div>
<pre><code>## a4aM object:
##   shape: ~1
##   level: ~a
##   trend: ~1</code></pre>
<p>Check the range:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="modelling-natural-mortality.html#cb69-1" tabindex="-1"></a><span class="fu">range</span>(m1)</span></code></pre></div>
<pre><code>##       min       max plusgroup   minyear   maxyear   minmbar   maxmbar 
##         0         0         0         0         0         0         0</code></pre>
<p>The <span class="math inline">\(M\)</span> <code>FLQuant</code> won’t have ages or years:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="modelling-natural-mortality.html#cb71-1" tabindex="-1"></a><span class="fu">m</span>(m1)</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##      year
## quant 0  
##     0 0.2
## 
## units:  NA</code></pre>
<p>To have a more useful matrix of values that cover the ages and years in the <code>FLStock</code> object, the analyst needs to set the quant and year ranges.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="modelling-natural-mortality.html#cb73-1" tabindex="-1"></a><span class="co"># set the quant range</span></span>
<span id="cb73-2"><a href="modelling-natural-mortality.html#cb73-2" tabindex="-1"></a><span class="fu">range</span>(m1, <span class="fu">c</span>(<span class="st">&quot;min&quot;</span>,<span class="st">&quot;max&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>)</span>
<span id="cb73-3"><a href="modelling-natural-mortality.html#cb73-3" tabindex="-1"></a><span class="co"># set the year range</span></span>
<span id="cb73-4"><a href="modelling-natural-mortality.html#cb73-4" tabindex="-1"></a><span class="fu">range</span>(m1, <span class="fu">c</span>(<span class="st">&quot;minyear&quot;</span>,<span class="st">&quot;maxyear&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2010</span>)</span>
<span id="cb73-5"><a href="modelling-natural-mortality.html#cb73-5" tabindex="-1"></a><span class="fu">range</span>(m1)</span></code></pre></div>
<pre><code>##       min       max plusgroup   minyear   maxyear   minmbar   maxmbar 
##         0         7         0      2000      2010         0         0</code></pre>
<p>Create the object with the M estimates by age and year, note the name of the first dimension is ‘quant’.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="modelling-natural-mortality.html#cb75-1" tabindex="-1"></a><span class="fu">m</span>(m1)</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##      year
## quant 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009 2010
##     0 0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2 
##     1 0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2 
##     2 0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2 
##     3 0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2 
##     4 0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2 
##     5 0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2 
##     6 0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2 
##     7 0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2  0.2 
## 
## units:  NA</code></pre>
<p>The next example has an age-based shape (model “m2” from above). As the <code>shape</code> model has ‘age’ as a variable which is not included in the <code>FLPar</code> slot it is used as the name of the first dimension of the resulting <code>FLQuant</code>.</p>
<p>An important feature of the <code>m()</code> method is the use of the <code>level</code> model. The outcome of the <code>level</code> model will be applied to a range of ages or lengths, set by the <code>mbar</code> information in the range slot. In this example the level model is <span class="math inline">\(1.5*K\)</span> and since <span class="math inline">\(K=0.4\)</span>, the level predicted by the model will be <span class="math inline">\(0.6\)</span>. The <code>m()</code> model will use the information in the range, <code>minmbar</code> and <code>maxmbar</code> to compute the mean level. This mean level will match the value given by the <code>level</code> model. The <code>mbar</code> range can be changed with the <code>rngmbar()</code> method. We illustrate this by making an <code>FLQuant</code> with age varying natural mortality.</p>
<p>Check the model and set the ranges:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="modelling-natural-mortality.html#cb77-1" tabindex="-1"></a>m2</span></code></pre></div>
<pre><code>## a4aM object:
##   shape: ~exp(-age - 0.5)
##   level: ~1.5 * k
##   trend: ~1</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="modelling-natural-mortality.html#cb79-1" tabindex="-1"></a><span class="co"># set the quant range</span></span>
<span id="cb79-2"><a href="modelling-natural-mortality.html#cb79-2" tabindex="-1"></a><span class="fu">range</span>(m2, <span class="fu">c</span>(<span class="st">&quot;min&quot;</span>,<span class="st">&quot;max&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>)</span>
<span id="cb79-3"><a href="modelling-natural-mortality.html#cb79-3" tabindex="-1"></a><span class="co"># set the year range</span></span>
<span id="cb79-4"><a href="modelling-natural-mortality.html#cb79-4" tabindex="-1"></a><span class="fu">range</span>(m2, <span class="fu">c</span>(<span class="st">&quot;minyear&quot;</span>,<span class="st">&quot;maxyear&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2003</span>)</span>
<span id="cb79-5"><a href="modelling-natural-mortality.html#cb79-5" tabindex="-1"></a><span class="fu">range</span>(m2)</span></code></pre></div>
<pre><code>##       min       max plusgroup   minyear   maxyear   minmbar   maxmbar 
##         0         7         0      2000      2003         0         0</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="modelling-natural-mortality.html#cb81-1" tabindex="-1"></a><span class="fu">m</span>(m2)</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##    year
## age 2000     2001     2002     2003    
##   0 0.600000 0.600000 0.600000 0.600000
##   1 0.220728 0.220728 0.220728 0.220728
##   2 0.081201 0.081201 0.081201 0.081201
##   3 0.029872 0.029872 0.029872 0.029872
##   4 0.010989 0.010989 0.010989 0.010989
##   5 0.004043 0.004043 0.004043 0.004043
##   6 0.001487 0.001487 0.001487 0.001487
##   7 0.000547 0.000547 0.000547 0.000547
## 
## units:  NA</code></pre>
<p>Note that the level value is:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="modelling-natural-mortality.html#cb83-1" tabindex="-1"></a><span class="fu">predict</span>(<span class="fu">level</span>(m2))</span></code></pre></div>
<pre><code>##    iter
##       1
##   1 0.6</code></pre>
<p>Which is the same as:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="modelling-natural-mortality.html#cb85-1" tabindex="-1"></a><span class="fu">m</span>(m2)[<span class="st">&quot;0&quot;</span>]</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##    year
## age 2000 2001 2002 2003
##   0 0.6  0.6  0.6  0.6 
## 
## units:  NA</code></pre>
<p>This is because the <code>mbar</code> range is currently set to “0” and “0” (see above) and the mean natural mortality value over this range is given by the level model.</p>
<p>We can change the <code>mbar</code> range:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="modelling-natural-mortality.html#cb87-1" tabindex="-1"></a><span class="fu">range</span>(m2, <span class="fu">c</span>(<span class="st">&quot;minmbar&quot;</span>,<span class="st">&quot;maxmbar&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb87-2"><a href="modelling-natural-mortality.html#cb87-2" tabindex="-1"></a><span class="fu">range</span>(m2)</span></code></pre></div>
<pre><code>##       min       max plusgroup   minyear   maxyear   minmbar   maxmbar 
##         0         7         0      2000      2003         0         5</code></pre>
<p>Which rescales the the natural mortality at age:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="modelling-natural-mortality.html#cb89-1" tabindex="-1"></a><span class="fu">m</span>(m2)</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##    year
## age 2000    2001    2002    2003   
##   0 2.28129 2.28129 2.28129 2.28129
##   1 0.83924 0.83924 0.83924 0.83924
##   2 0.30874 0.30874 0.30874 0.30874
##   3 0.11358 0.11358 0.11358 0.11358
##   4 0.04178 0.04178 0.04178 0.04178
##   5 0.01537 0.01537 0.01537 0.01537
##   6 0.00565 0.00565 0.00565 0.00565
##   7 0.00208 0.00208 0.00208 0.00208
## 
## units:  NA</code></pre>
<p>Check that the mortality over the mean range is the same as the level model:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="modelling-natural-mortality.html#cb91-1" tabindex="-1"></a><span class="fu">quantMeans</span>(<span class="fu">m</span>(m2)[<span class="fu">ac</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)])</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##      year
## age   2000 2001 2002 2003
##   all 0.6  0.6  0.6  0.6 
## 
## units:  NA</code></pre>
<p>The next example uses a time trend for the <code>trend</code> model. We use the <code>m3</code> model we made earlier. The <code>trend</code> model for this model has a covariate, ‘nao’. This needs to be passed to the <code>m()</code> method. The year range of the ‘nao’ covariate should match that of the <code>range</code> slot.</p>
<p>Simple, pass in a single nao value (only one year):</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="modelling-natural-mortality.html#cb93-1" tabindex="-1"></a><span class="fu">m</span>(m3, <span class="at">nao=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##    year
## age 0  
##   0 0.9
## 
## units:  NA</code></pre>
<p>Set ages:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="modelling-natural-mortality.html#cb95-1" tabindex="-1"></a><span class="fu">range</span>(m3, <span class="fu">c</span>(<span class="st">&quot;min&quot;</span>,<span class="st">&quot;max&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>)</span>
<span id="cb95-2"><a href="modelling-natural-mortality.html#cb95-2" tabindex="-1"></a><span class="fu">m</span>(m3, <span class="at">nao=</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##    year
## age 0       
##   0 0.600000
##   1 0.220728
##   2 0.081201
##   3 0.029872
##   4 0.010989
##   5 0.004043
##   6 0.001487
##   7 0.000547
## 
## units:  NA</code></pre>
<p>With ages and years - passing in the NAO data as numeric (1,0,1,0)</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="modelling-natural-mortality.html#cb97-1" tabindex="-1"></a><span class="fu">range</span>(m3, <span class="fu">c</span>(<span class="st">&quot;minyear&quot;</span>,<span class="st">&quot;maxyear&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2003</span>)</span>
<span id="cb97-2"><a href="modelling-natural-mortality.html#cb97-2" tabindex="-1"></a><span class="fu">m</span>(m3, <span class="at">nao=</span><span class="fu">as.numeric</span>(nao[,<span class="fu">as.character</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2003</span>)]))</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## , , unit = unique, season = all, area = unique
## 
##    year
## age 2000     2001     2002     2003    
##   0 0.600000 0.900000 0.600000 0.900000
##   1 0.220728 0.331091 0.220728 0.331091
##   2 0.081201 0.121802 0.081201 0.121802
##   3 0.029872 0.044808 0.029872 0.044808
##   4 0.010989 0.016484 0.010989 0.016484
##   5 0.004043 0.006064 0.004043 0.006064
##   6 0.001487 0.002231 0.001487 0.002231
##   7 0.000547 0.000821 0.000547 0.000821
## 
## units:  NA</code></pre>
<p>The final example show how <code>m()</code> can be used to make an <code>FLQuant</code> with uncertainty (see Figure <a href="modelling-natural-mortality.html#fig:uncertainm">4.3</a>). We use the <code>m4</code> object from earlier with uncertainty on the <code>level</code> and <code>trend</code> parameters.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="modelling-natural-mortality.html#cb99-1" tabindex="-1"></a><span class="fu">range</span>(m4, <span class="fu">c</span>(<span class="st">&quot;min&quot;</span>,<span class="st">&quot;max&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">7</span>)</span>
<span id="cb99-2"><a href="modelling-natural-mortality.html#cb99-2" tabindex="-1"></a><span class="fu">range</span>(m4, <span class="fu">c</span>(<span class="st">&quot;minyear&quot;</span>,<span class="st">&quot;maxyear&quot;</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2003</span>)</span>
<span id="cb99-3"><a href="modelling-natural-mortality.html#cb99-3" tabindex="-1"></a>flq <span class="ot">&lt;-</span> <span class="fu">m</span>(m4, <span class="at">nao=</span><span class="fu">c</span>(nao[,<span class="fu">ac</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2003</span>)]))</span>
<span id="cb99-4"><a href="modelling-natural-mortality.html#cb99-4" tabindex="-1"></a>flq</span></code></pre></div>
<pre><code>## An object of class &quot;FLQuant&quot;
## iters:  100 
## 
## , , unit = unique, season = all, area = unique
## 
##    year
## age 2000              2001              2002              2003             
##   0 2.00388(0.226900) 3.00967(0.351395) 2.00388(0.226900) 3.00967(0.351395)
##   1 0.73718(0.083472) 1.10720(0.129271) 0.73718(0.083472) 1.10720(0.129271)
##   2 0.27120(0.030708) 0.40732(0.047556) 0.27120(0.030708) 0.40732(0.047556)
##   3 0.09977(0.011297) 0.14984(0.017495) 0.09977(0.011297) 0.14984(0.017495)
##   4 0.03670(0.004156) 0.05512(0.006436) 0.03670(0.004156) 0.05512(0.006436)
##   5 0.01350(0.001529) 0.02028(0.002368) 0.01350(0.001529) 0.02028(0.002368)
##   6 0.00497(0.000562) 0.00746(0.000871) 0.00497(0.000562) 0.00746(0.000871)
##   7 0.00183(0.000207) 0.00274(0.000320) 0.00183(0.000207) 0.00274(0.000320)
## 
## units:  NA</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="modelling-natural-mortality.html#cb101-1" tabindex="-1"></a><span class="fu">dim</span>(flq)</span></code></pre></div>
<pre><code>## [1]   8   4   1   1   1 100</code></pre>
<div class="figure"><span style="display:block;" id="fig:uncertainm"></span>
<img src="_main_files/figure-html/uncertainm-1.png" alt="Natural mortality with age and year trend." width="672" />
<p class="caption">
Figure 4.3: Natural mortality with age and year trend.
</p>
</div>
<p>Notably, the last example created a M model that varies with time, based on an environmental variable, and adds estimation uncertainty, showing the huge flexibility this method can deal with.</p>

</div>
</div>
<h3> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-charnov1993" class="csl-entry">
Charnov, Eric L. 1993. <em>Life History Invariants: Some Explorations of Symmetry in Evolutionary Ecology</em>. Oxford University Press.
</div>
<div id="ref-gislason2010" class="csl-entry">
Gislason, Henrik, Niels Daan, Jake C Rice, and John G Pope. 2010. <span>“Size, Growth, Temperature and the Natural Mortality of Marine Fish.”</span> <em>Fish and Fisheries</em> 11 (2): 149–58. <a href="https://doi.org/10.1111/j.1467-2979.2009.00350.x">https://doi.org/10.1111/j.1467-2979.2009.00350.x</a>.
</div>
<div id="ref-MCAPAM2023" class="csl-entry">
Hamel, Owen S., James N. Ianelli, Mark N. Maunder, and André E. Punt. 2023. <span>“Natural Mortality: Theory, Estimation and Application in Fishery Stock Assessment Models.”</span> <em>Fisheries Research</em> 261: 106638. <a href="https://doi.org/10.1016/j.fishres.2023.106638">https://doi.org/10.1016/j.fishres.2023.106638</a>.
</div>
<div id="ref-Kenchington2014" class="csl-entry">
Kenchington, Trevor J. 2014. <span>“Natural Mortality Estimators for Information-Limited Fisheries.”</span> <em>Fish and Fisheries</em> 15 (4): 533–62. <a href="https://doi.org/10.1111/faf.12027">https://doi.org/10.1111/faf.12027</a>.
</div>
<div id="ref-maunder2023mrev" class="csl-entry">
Maunder, Mark N, Owen S Hamel, Hee-Haeng Lee, Kevin R Piner, Jason M Cope, André E Punt, James N Ianelli, Cristian Castillo-Jordan, and Manasa S Kapur. 2023. <span>“A Review of Estimation Methods for Natural Mortality and Their Performance in the Context of Fishery Stock Assessment.”</span> <em>Fisheries Research</em> 257: 106489. <a href="https://doi.org/10.1016/j.fishres.2022.106489">https://doi.org/10.1016/j.fishres.2022.106489</a>.
</div>
<div id="ref-pauly1980" class="csl-entry">
Pauly, Daniel. 1980. <span>“On the Interrelationships Between Natural Mortality, Growth Parameters, and Mean Environmental Temperature in 175 Fish Stocks.”</span> <em>ICES Journal of Marine Science</em> 39 (2): 175–92. <a href="https://doi.org/10.1093/icesjms/39.2.175">https://doi.org/10.1093/icesjms/39.2.175</a>.
</div>
<div id="ref-quinn1999" class="csl-entry">
Quinn, Terrance J, and Richard B Deriso. 1999. <em>Quantitative Fish Dynamics</em>. Oxford University Press.
</div>
<div id="ref-mass" class="csl-entry">
Venables, W. N., and B. D. Ripley. 2002. <em>Modern Applied Statistics with s</em>. Fourth. New York: Springer. <a href="https://www.stats.ox.ac.uk/pub/MASS4/">https://www.stats.ox.ac.uk/pub/MASS4/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="growth.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stock-assessment-framework.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-m.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["_main.pdf", "_main.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
